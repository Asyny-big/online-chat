{"ast":null,"code":"import _objectSpread from\"C:/Users/larak/AppData/Local/npm-cache/_npx/cd53aabf71f3f793/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef}from\"react\";import axios from\"axios\";import*as chatStyles from\"./styles/chatStyles\";import io from\"socket.io-client\";import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";const API_URL=\"http://localhost:5000/api\";function parseToken(token){if(!token)return\"\";try{const t=token.split(\".\")[1].replace(/-/g,\"+\").replace(/_/g,\"/\");const n=decodeURIComponent(atob(t).split(\"\").map(c=>\"%\"+(\"00\"+c.charCodeAt(0).toString(16)).slice(-2)).join(\"\"));return JSON.parse(n).username||\"\";}catch(_unused){return\"\";}}function App(){var _userProfile$age,_userProfile$city,_userProfile$status;const[token,setToken]=useState(localStorage.getItem(\"token\"));const[channels,setChannels]=useState([]);const[selectedChannel,setSelectedChannel]=useState(null);const[messages,setMessages]=useState([]);const[input,setInput]=useState(\"\");const[typing,setTyping]=useState(\"\");const typingTimeoutRef=useRef(null);const[showCreate,setShowCreate]=useState(false);const[newChannel,setNewChannel]=useState(\"\");const[authMode,setAuthMode]=useState(\"login\");const[login,setLogin]=useState(\"\");const[password,setPassword]=useState(\"\");const[error,setError]=useState(\"\");const[username,setUsername]=useState(\"\");const[showProfile,setShowProfile]=useState(false);const[userProfile,setUserProfile]=useState(null);const[editMode,setEditMode]=useState(false);const[editData,setEditData]=useState({username:\"\",password:\"\",city:\"\",status:\"\",age:\"\"});const[showProfileModal,setShowProfileModal]=useState(false);const[profileModalData,setProfileModalData]=useState({city:\"\",status:\"\",age:\"\"});const[registering,setRegistering]=useState(false);const socketRef=useRef(null);const messagesEndRef=useRef(null);// Новые состояния для регистрации\nconst[regUsername,setRegUsername]=useState(\"\");const[regPassword,setRegPassword]=useState(\"\");const[regCity,setRegCity]=useState(\"\");const[regAge,setRegAge]=useState(\"\");const[regStatus,setRegStatus]=useState(\"\");useEffect(()=>{setUsername(parseToken(token));},[token]);useEffect(()=>{if(!token)return;const fetchProfile=async()=>{try{const res=await axios.get(\"\".concat(API_URL,\"/profile\"),{headers:{Authorization:\"Bearer \".concat(token)}});setUserProfile(res.data);}catch(_unused2){setUserProfile(null);}};fetchProfile();},[token]);useEffect(()=>{if(!token)return;axios.get(\"\".concat(API_URL,\"/channels\"),{headers:{Authorization:\"Bearer \".concat(token)}}).then(res=>setChannels(res.data)).catch(()=>setChannels([]));socketRef.current=io(\"http://localhost:5000\",{auth:{token}});socketRef.current.on(\"message\",msg=>{setMessages(prev=>msg.channel===selectedChannel?[...prev,msg]:prev);});socketRef.current.on(\"typing\",e=>{setTyping(\"\".concat(e.user,\" \\u043F\\u0435\\u0447\\u0430\\u0442\\u0430\\u0435\\u0442...\"));if(typingTimeoutRef.current)clearTimeout(typingTimeoutRef.current);typingTimeoutRef.current=setTimeout(()=>setTyping(\"\"),2000);});const handleNewChannel=()=>window.location.reload();socketRef.current.on(\"new-channel\",handleNewChannel);return()=>{socketRef.current&&socketRef.current.disconnect();socketRef.current&&socketRef.current.off(\"new-channel\",handleNewChannel);if(typingTimeoutRef.current)clearTimeout(typingTimeoutRef.current);};// eslint-disable-next-line\n},[token]);useEffect(()=>{if(token&&selectedChannel){axios.get(\"\".concat(API_URL,\"/messages/\").concat(selectedChannel),{headers:{Authorization:\"Bearer \".concat(token)}}).then(res=>setMessages(res.data));socketRef.current&&socketRef.current.emit(\"join\",selectedChannel);}},[token,selectedChannel]);useEffect(()=>{messagesEndRef.current&&messagesEndRef.current.scrollIntoView({behavior:\"smooth\"});},[messages]);useEffect(()=>{if(!socketRef.current)return;const handler=msg=>{if(msg.channel===selectedChannel)setMessages(prev=>[...prev,msg]);};socketRef.current.on(\"message\",handler);return()=>socketRef.current.off(\"message\",handler);},[selectedChannel]);const handleCreateChannel=async()=>{if(!newChannel.trim())return;try{const t=parseToken(token);const res=await axios.post(\"\".concat(API_URL,\"/channels\"),{name:newChannel,members:[t]},{headers:{Authorization:\"Bearer \".concat(token)}});setShowCreate(false);setNewChannel(\"\");const chs=await axios.get(\"\".concat(API_URL,\"/channels\"),{headers:{Authorization:\"Bearer \".concat(token)}});setChannels(chs.data);setSelectedChannel(res.data._id);socketRef.current&&socketRef.current.emit(\"join\",res.data._id);socketRef.current&&socketRef.current.emit(\"new-channel\");}catch(_unused3){alert(\"Ошибка создания канала\");}};const handleSend=()=>{if(!input.trim()||!selectedChannel)return;const t=parseToken(token);const msg={text:input,sender:t,channel:selectedChannel};socketRef.current&&socketRef.current.emit(\"join\",selectedChannel);socketRef.current.emit(\"message\",msg);setInput(\"\");};const handleAuth=async()=>{setError(\"\");try{if(authMode===\"register\"){await axios.post(\"\".concat(API_URL,\"/register\"),{username:login,password});}const res=await axios.post(\"\".concat(API_URL,\"/login\"),{username:login,password});localStorage.setItem(\"token\",res.data.token);setToken(res.data.token);}catch(err){setError(err.response&&err.response.data&&err.response.data.error?err.response.data.error:\"Неверный логин или пароль, либо пользователь не зарегистрирован\");}};// Функция для отправки изменений профиля\nconst handleProfileSave=async()=>{try{const payload={username:editData.username,password:editData.password,city:editData.city,status:editData.status,age:editData.age};Object.keys(payload).forEach(k=>{if(payload[k]===\"\"||payload[k]===null)delete payload[k];});const res=await axios.patch(\"\".concat(API_URL,\"/profile\"),payload,{headers:{Authorization:\"Bearer \".concat(token)}});setUserProfile(res.data);setEditMode(false);if(payload.username&&payload.username!==userProfile.username&&res.data.token){localStorage.setItem(\"token\",res.data.token);setToken(res.data.token);}}catch(e){var _e$response,_e$response$data;alert((e===null||e===void 0?void 0:(_e$response=e.response)===null||_e$response===void 0?void 0:(_e$response$data=_e$response.data)===null||_e$response$data===void 0?void 0:_e$response$data.error)||(e===null||e===void 0?void 0:e.message)||\"Ошибка обновления профиля\");}};// После регистрации показываем модальное окно\nconst handleRegister=async()=>{setError(\"\");try{setRegistering(true);// Передаем дополнительные поля при регистрации\nawait axios.post(\"\".concat(API_URL,\"/register\"),{username:regUsername,password:regPassword,city:regCity,age:regAge,status:regStatus});setRegistering(false);// После успешной регистрации сразу логинимся\nconst res=await axios.post(\"\".concat(API_URL,\"/login\"),{username:regUsername,password:regPassword});localStorage.setItem(\"token\",res.data.token);setToken(res.data.token);setShowProfileModal(true);setProfileModalData({city:\"\",status:\"\",age:\"\"});}catch(e){var _e$response2,_e$response2$data;setRegistering(false);setError((e===null||e===void 0?void 0:(_e$response2=e.response)===null||_e$response2===void 0?void 0:(_e$response2$data=_e$response2.data)===null||_e$response2$data===void 0?void 0:_e$response2$data.error)||\"Неверный логин или пароль, либо пользователь не зарегистрирован\");}};// Сохранение данных профиля из модального окна\nconst handleSaveProfileModal=async()=>{try{const payload={city:profileModalData.city,status:profileModalData.status,age:profileModalData.age};await axios.patch(\"\".concat(API_URL,\"/profile\"),payload,{headers:{Authorization:\"Bearer \".concat(token)}});setShowProfileModal(false);}catch(e){var _e$response3,_e$response3$data;alert((e===null||e===void 0?void 0:(_e$response3=e.response)===null||_e$response3===void 0?void 0:(_e$response3$data=_e$response3.data)===null||_e$response3$data===void 0?void 0:_e$response3$data.error)||(e===null||e===void 0?void 0:e.message)||\"Ошибка сохранения данных профиля\");}};if(!token){return/*#__PURE__*/_jsx(\"div\",{style:chatStyles.page,children:/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.authContainer,children:[/*#__PURE__*/_jsx(\"div\",{style:chatStyles.authTitle,children:authMode===\"register\"?\"Регистрация\":\"Вход\"}),error&&/*#__PURE__*/_jsx(\"div\",{style:chatStyles.error,children:error}),/*#__PURE__*/_jsx(\"input\",{style:chatStyles.authInput,placeholder:\"\\u0418\\u043C\\u044F\",value:login,onChange:e=>setLogin(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{style:chatStyles.authInput,placeholder:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\",type:\"password\",value:password,onChange:e=>setPassword(e.target.value)}),authMode===\"register\"&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{style:chatStyles.authInput,placeholder:\"\\u0413\\u043E\\u0440\\u043E\\u0434\",value:regCity,onChange:e=>setRegCity(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{style:chatStyles.authInput,placeholder:\"\\u0412\\u043E\\u0437\\u0440\\u0430\\u0441\\u0442\",type:\"number\",min:0,value:regAge,onChange:e=>setRegAge(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{style:chatStyles.authInput,placeholder:\"\\u0421\\u0435\\u043C\\u0435\\u0439\\u043D\\u044B\\u0439 \\u0441\\u0442\\u0430\\u0442\\u0443\\u0441\",value:regStatus,onChange:e=>setRegStatus(e.target.value)})]}),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.authBtn,onClick:handleAuth,children:authMode===\"register\"?\"Зарегистрироваться\":\"Войти\"}),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.switchBtn,onClick:()=>setAuthMode(authMode===\"register\"?\"login\":\"register\"),children:authMode===\"register\"?\"Войти\":\"Регистрация\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.page,children:[/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.sidebar,children:[/*#__PURE__*/_jsx(\"div\",{style:chatStyles.sidebarTitle,children:\"Sechat.ru\"}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.channelList,children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:600,color:\"#fff\",marginBottom:10},children:\"\\u041A\\u0430\\u043D\\u0430\\u043B\\u044B\"}),channels.length===0?/*#__PURE__*/_jsx(\"div\",{style:{color:\"#b2bec3\",marginBottom:8},children:\"\\u041D\\u0435\\u0442 \\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u044B\\u0445 \\u043A\\u0430\\u043D\\u0430\\u043B\\u043E\\u0432\"}):/*#__PURE__*/_jsx(_Fragment,{children:channels.map(ch=>/*#__PURE__*/_jsx(\"div\",{style:chatStyles.channelItem(selectedChannel===ch._id),onClick:()=>setSelectedChannel(ch._id),children:ch.name},ch._id))}),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.createBtn,onClick:()=>setShowCreate(v=>!v),children:showCreate?\"Скрыть создание\":\"Создать канал\"}),showCreate&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:10},children:[/*#__PURE__*/_jsx(\"input\",{style:chatStyles.input,placeholder:\"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u043A\\u0430\\u043D\\u0430\\u043B\\u0430\",value:newChannel,onChange:e=>setNewChannel(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.createBtn,onClick:handleCreateChannel,children:\"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C\"})]})]}),/*#__PURE__*/_jsx(\"div\",{style:{flex:1}}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileBtnBox,children:[/*#__PURE__*/_jsx(\"button\",{style:chatStyles.profileBtn,onClick:()=>{setShowProfile(v=>!v);setEditMode(false);},title:\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\",children:/*#__PURE__*/_jsxs(\"svg\",{width:\"26\",height:\"26\",viewBox:\"0 0 26 26\",fill:\"none\",children:[/*#__PURE__*/_jsx(\"circle\",{cx:\"13\",cy:\"13\",r:\"13\",fill:\"#00c3ff\"}),/*#__PURE__*/_jsx(\"circle\",{cx:\"13\",cy:\"10\",r:\"4\",fill:\"#fff\"}),/*#__PURE__*/_jsx(\"ellipse\",{cx:\"13\",cy:\"19\",rx:\"7\",ry:\"4\",fill:\"#fff\"})]})}),/*#__PURE__*/_jsxs(\"div\",{style:_objectSpread(_objectSpread({},chatStyles.profilePopup),{},{transform:showProfile?\"translateY(0)\":\"translateY(120%)\",opacity:showProfile?1:0,pointerEvents:showProfile?\"auto\":\"none\",transition:\"transform 0.32s cubic-bezier(.4,1.4,.6,1), opacity 0.22s\"}),children:[userProfile&&!editMode&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{style:chatStyles.profileTitle,children:\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\"}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u041D\\u0438\\u043A:\"}),\" \",userProfile.username]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u0412\\u043E\\u0437\\u0440\\u0430\\u0441\\u0442:\"}),\" \",(_userProfile$age=userProfile.age)!==null&&_userProfile$age!==void 0?_userProfile$age:\"—\"]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u0413\\u043E\\u0440\\u043E\\u0434:\"}),\" \",(_userProfile$city=userProfile.city)!==null&&_userProfile$city!==void 0?_userProfile$city:\"—\"]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u0421\\u0435\\u043C\\u0435\\u0439\\u043D\\u044B\\u0439 \\u0441\\u0442\\u0430\\u0442\\u0443\\u0441:\"}),\" \",(_userProfile$status=userProfile.status)!==null&&_userProfile$status!==void 0?_userProfile$status:\"—\"]}),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.profileEditBtn,onClick:()=>{setEditData({username:userProfile.username||\"\",password:\"\",city:userProfile.city||\"\",status:userProfile.status||\"\",age:userProfile.age||\"\"});setEditMode(true);},children:\"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435\"})]}),userProfile&&editMode&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{style:chatStyles.profileTitle,children:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435 \\u043F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044F\"}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u041D\\u0438\\u043A:\"}),/*#__PURE__*/_jsx(\"input\",{style:chatStyles.profileInput,value:editData.username,onChange:e=>setEditData(d=>_objectSpread(_objectSpread({},d),{},{username:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C:\"}),/*#__PURE__*/_jsx(\"input\",{style:chatStyles.profileInput,type:\"password\",value:editData.password,placeholder:\"\\u041D\\u043E\\u0432\\u044B\\u0439 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\",onChange:e=>setEditData(d=>_objectSpread(_objectSpread({},d),{},{password:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u0412\\u043E\\u0437\\u0440\\u0430\\u0441\\u0442:\"}),/*#__PURE__*/_jsx(\"input\",{style:chatStyles.profileInput,type:\"number\",min:0,value:editData.age,onChange:e=>setEditData(d=>_objectSpread(_objectSpread({},d),{},{age:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u0413\\u043E\\u0440\\u043E\\u0434:\"}),/*#__PURE__*/_jsx(\"input\",{style:chatStyles.profileInput,value:editData.city,onChange:e=>setEditData(d=>_objectSpread(_objectSpread({},d),{},{city:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u0421\\u0435\\u043C\\u0435\\u0439\\u043D\\u044B\\u0439 \\u0441\\u0442\\u0430\\u0442\\u0443\\u0441:\"}),/*#__PURE__*/_jsx(\"input\",{style:chatStyles.profileInput,value:editData.status,onChange:e=>setEditData(d=>_objectSpread(_objectSpread({},d),{},{status:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:8,marginTop:10,justifyContent:\"flex-end\"},children:[/*#__PURE__*/_jsx(\"button\",{style:chatStyles.profileEditBtn,onClick:handleProfileSave,children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.profileCloseBtn,onClick:()=>setEditMode(false),children:\"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\"})]})]}),!userProfile&&/*#__PURE__*/_jsx(\"div\",{style:{color:\"#b2bec3\",marginBottom:8},children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"})]})]}),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.logoutBtn,onClick:()=>{localStorage.removeItem(\"token\");window.location.reload();},children:\"\\u0412\\u044B\\u0439\\u0442\\u0438\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.chatContainer,children:[/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",alignItems:\"center\",justifyContent:\"center\",width:\"100%\",marginBottom:10,minHeight:32},children:/*#__PURE__*/_jsx(\"div\",{style:chatStyles.chatTitle,children:\"\\u0427\\u0430\\u0442\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-box\",style:chatStyles.chatBox,children:[messages.map(msg=>{const isMine=msg.sender===username;// Формат времени\nconst time=msg.createdAt?new Date(msg.createdAt).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'}):'';return/*#__PURE__*/_jsx(\"div\",{style:chatStyles.messageRow(isMine),children:/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.message(isMine),children:[!isMine&&/*#__PURE__*/_jsxs(\"span\",{style:chatStyles.messageSender,children:[msg.sender,\":\"]}),msg.text,msg.fileUrl&&/*#__PURE__*/_jsx(\"a\",{href:msg.fileUrl,target:\"_blank\",rel:\"noopener noreferrer\",style:{color:\"#00c3ff\",marginLeft:8,textDecoration:\"underline\",fontWeight:500},children:\"[\\u0444\\u0430\\u0439\\u043B]\"}),/*#__PURE__*/_jsx(\"div\",{style:{color:\"#b2bec3\",fontSize:11,marginTop:4,textAlign:isMine?\"right\":\"left\"},children:time})]})},msg._id);}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsx(\"div\",{style:{minHeight:22,display:\"flex\",alignItems:\"flex-end\",marginBottom:2},children:typing&&/*#__PURE__*/_jsx(\"div\",{style:_objectSpread(_objectSpread({},chatStyles.typing),{},{margin:0,paddingLeft:8,paddingRight:8,background:\"none\",borderRadius:0,position:\"relative\",zIndex:2,width:\"fit-content\",maxWidth:\"80%\",alignSelf:\"flex-start\",boxShadow:\"none\"}),children:typing})}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.inputRow,children:[/*#__PURE__*/_jsx(\"input\",{style:chatStyles.input,value:input,onChange:e=>setInput(e.target.value),onKeyDown:e=>{if(selectedChannel){socketRef.current.emit(\"typing\",{channel:selectedChannel});if(e.key===\"Enter\")handleSend();}},disabled:!selectedChannel,placeholder:selectedChannel?\"Введите сообщение...\":\"Выберите канал\"}),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.sendBtn,onClick:handleSend,disabled:!selectedChannel||!input.trim(),children:\"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\"})]})]}),showProfileModal&&/*#__PURE__*/_jsx(\"div\",{style:{position:\"fixed\",top:0,left:0,width:\"100vw\",height:\"100vh\",background:\"rgba(30,32,34,0.88)\",zIndex:9999,display:\"flex\",alignItems:\"center\",justifyContent:\"center\"},children:/*#__PURE__*/_jsxs(\"div\",{style:{background:\"#232526\",borderRadius:16,boxShadow:\"0 2px 16px #00c3ff33\",padding:36,minWidth:320,maxWidth:400,display:\"flex\",flexDirection:\"column\",alignItems:\"center\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,fontSize:22,color:\"#00c3ff\",marginBottom:18},children:\"\\u0417\\u0430\\u043F\\u043E\\u043B\\u043D\\u0438\\u0442\\u0435 \\u043F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\"}),/*#__PURE__*/_jsxs(\"div\",{style:{width:\"100%\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:12},children:[/*#__PURE__*/_jsx(\"label\",{style:{color:\"#00c3ff\",fontWeight:600},children:\"\\u0413\\u043E\\u0440\\u043E\\u0434:\"}),/*#__PURE__*/_jsx(\"input\",{style:chatStyles.profileInput,value:profileModalData.city,onChange:e=>setProfileModalData(d=>_objectSpread(_objectSpread({},d),{},{city:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:12},children:[/*#__PURE__*/_jsx(\"label\",{style:{color:\"#00c3ff\",fontWeight:600},children:\"\\u0412\\u043E\\u0437\\u0440\\u0430\\u0441\\u0442:\"}),/*#__PURE__*/_jsx(\"input\",{style:chatStyles.profileInput,type:\"number\",min:0,value:profileModalData.age,onChange:e=>setProfileModalData(d=>_objectSpread(_objectSpread({},d),{},{age:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:12},children:[/*#__PURE__*/_jsx(\"label\",{style:{color:\"#00c3ff\",fontWeight:600},children:\"\\u0421\\u0435\\u043C\\u0435\\u0439\\u043D\\u044B\\u0439 \\u0441\\u0442\\u0430\\u0442\\u0443\\u0441:\"}),/*#__PURE__*/_jsx(\"input\",{style:chatStyles.profileInput,value:profileModalData.status,onChange:e=>setProfileModalData(d=>_objectSpread(_objectSpread({},d),{},{status:e.target.value}))})]}),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.profileEditBtn,onClick:handleSaveProfileModal,children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"})]})]})})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","useRef","axios","chatStyles","io","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","API_URL","parseToken","token","t","split","replace","n","decodeURIComponent","atob","map","c","charCodeAt","toString","slice","join","JSON","parse","username","_unused","App","_userProfile$age","_userProfile$city","_userProfile$status","setToken","localStorage","getItem","channels","setChannels","selectedChannel","setSelectedChannel","messages","setMessages","input","setInput","typing","setTyping","typingTimeoutRef","showCreate","setShowCreate","newChannel","setNewChannel","authMode","setAuthMode","login","setLogin","password","setPassword","error","setError","setUsername","showProfile","setShowProfile","userProfile","setUserProfile","editMode","setEditMode","editData","setEditData","city","status","age","showProfileModal","setShowProfileModal","profileModalData","setProfileModalData","registering","setRegistering","socketRef","messagesEndRef","regUsername","setRegUsername","regPassword","setRegPassword","regCity","setRegCity","regAge","setRegAge","regStatus","setRegStatus","fetchProfile","res","get","concat","headers","Authorization","data","_unused2","then","catch","current","auth","on","msg","prev","channel","e","user","clearTimeout","setTimeout","handleNewChannel","window","location","reload","disconnect","off","emit","scrollIntoView","behavior","handler","handleCreateChannel","trim","post","name","members","chs","_id","_unused3","alert","handleSend","text","sender","handleAuth","setItem","err","response","handleProfileSave","payload","Object","keys","forEach","k","patch","_e$response","_e$response$data","message","handleRegister","_e$response2","_e$response2$data","handleSaveProfileModal","_e$response3","_e$response3$data","style","page","children","authContainer","authTitle","authInput","placeholder","value","onChange","target","type","min","authBtn","onClick","switchBtn","sidebar","sidebarTitle","channelList","fontWeight","color","marginBottom","length","ch","channelItem","createBtn","v","marginTop","flex","profileBtnBox","profileBtn","title","width","height","viewBox","fill","cx","cy","r","rx","ry","_objectSpread","profilePopup","transform","opacity","pointerEvents","transition","profileTitle","profileField","profileLabel","profileEditBtn","profileInput","d","display","gap","justifyContent","profileCloseBtn","logoutBtn","removeItem","chatContainer","alignItems","minHeight","chatTitle","className","chatBox","isMine","time","createdAt","Date","toLocaleTimeString","hour","minute","messageRow","messageSender","fileUrl","href","rel","marginLeft","textDecoration","fontSize","textAlign","ref","margin","paddingLeft","paddingRight","background","borderRadius","position","zIndex","maxWidth","alignSelf","boxShadow","inputRow","onKeyDown","key","disabled","sendBtn","top","left","padding","minWidth","flexDirection"],"sources":["D:/prr/prr/semak4/driver/frontend/src/App.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\nimport axios from \"axios\";\r\nimport * as chatStyles from \"./styles/chatStyles\";\r\nimport io from \"socket.io-client\";\r\n\r\nconst API_URL = \"http://localhost:5000/api\";\r\n\r\nfunction parseToken(token) {\r\n  if (!token) return \"\";\r\n  try {\r\n    const t = token.split(\".\")[1].replace(/-/g, \"+\").replace(/_/g, \"/\");\r\n    const n = decodeURIComponent(\r\n      atob(t)\r\n        .split(\"\")\r\n        .map((c) => \"%\" + (\"00\" + c.charCodeAt(0).toString(16)).slice(-2))\r\n        .join(\"\")\r\n    );\r\n    return JSON.parse(n).username || \"\";\r\n  } catch {\r\n    return \"\";\r\n  }\r\n}\r\n\r\nfunction App() {\r\n  const [token, setToken] = useState(localStorage.getItem(\"token\"));\r\n  const [channels, setChannels] = useState([]);\r\n  const [selectedChannel, setSelectedChannel] = useState(null);\r\n  const [messages, setMessages] = useState([]);\r\n  const [input, setInput] = useState(\"\");\r\n  const [typing, setTyping] = useState(\"\");\r\n  const typingTimeoutRef = useRef(null);\r\n  const [showCreate, setShowCreate] = useState(false);\r\n  const [newChannel, setNewChannel] = useState(\"\");\r\n  const [authMode, setAuthMode] = useState(\"login\");\r\n  const [login, setLogin] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [error, setError] = useState(\"\");\r\n  const [username, setUsername] = useState(\"\");\r\n  const [showProfile, setShowProfile] = useState(false);\r\n  const [userProfile, setUserProfile] = useState(null);\r\n  const [editMode, setEditMode] = useState(false);\r\n  const [editData, setEditData] = useState({\r\n    username: \"\",\r\n    password: \"\",\r\n    city: \"\",\r\n    status: \"\",\r\n    age: \"\",\r\n  });\r\n  const [showProfileModal, setShowProfileModal] = useState(false);\r\n  const [profileModalData, setProfileModalData] = useState({\r\n    city: \"\",\r\n    status: \"\",\r\n    age: \"\",\r\n  });\r\n  const [registering, setRegistering] = useState(false);\r\n  const socketRef = useRef(null);\r\n  const messagesEndRef = useRef(null);\r\n\r\n  // Новые состояния для регистрации\r\n  const [regUsername, setRegUsername] = useState(\"\");\r\n  const [regPassword, setRegPassword] = useState(\"\");\r\n  const [regCity, setRegCity] = useState(\"\");\r\n  const [regAge, setRegAge] = useState(\"\");\r\n  const [regStatus, setRegStatus] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    setUsername(parseToken(token));\r\n  }, [token]);\r\n\r\n  useEffect(() => {\r\n    if (!token) return;\r\n    const fetchProfile = async () => {\r\n      try {\r\n        const res = await axios.get(`${API_URL}/profile`, {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        });\r\n        setUserProfile(res.data);\r\n      } catch {\r\n        setUserProfile(null);\r\n      }\r\n    };\r\n    fetchProfile();\r\n  }, [token]);\r\n\r\n  useEffect(() => {\r\n    if (!token) return;\r\n    axios\r\n      .get(`${API_URL}/channels`, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      })\r\n      .then((res) => setChannels(res.data))\r\n      .catch(() => setChannels([]));\r\n\r\n    socketRef.current = io(\"http://localhost:5000\", {\r\n      auth: { token },\r\n    });\r\n\r\n    socketRef.current.on(\"message\", (msg) => {\r\n      setMessages((prev) =>\r\n        msg.channel === selectedChannel ? [...prev, msg] : prev\r\n      );\r\n    });\r\n\r\n    socketRef.current.on(\"typing\", (e) => {\r\n      setTyping(`${e.user} печатает...`);\r\n      if (typingTimeoutRef.current) clearTimeout(typingTimeoutRef.current);\r\n      typingTimeoutRef.current = setTimeout(() => setTyping(\"\"), 2000);\r\n    });\r\n\r\n    const handleNewChannel = () => window.location.reload();\r\n    socketRef.current.on(\"new-channel\", handleNewChannel);\r\n\r\n    return () => {\r\n      socketRef.current && socketRef.current.disconnect();\r\n      socketRef.current && socketRef.current.off(\"new-channel\", handleNewChannel);\r\n      if (typingTimeoutRef.current) clearTimeout(typingTimeoutRef.current);\r\n    };\r\n    // eslint-disable-next-line\r\n  }, [token]);\r\n\r\n  useEffect(() => {\r\n    if (token && selectedChannel) {\r\n      axios\r\n        .get(`${API_URL}/messages/${selectedChannel}`, {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        })\r\n        .then((res) => setMessages(res.data));\r\n      socketRef.current && socketRef.current.emit(\"join\", selectedChannel);\r\n    }\r\n  }, [token, selectedChannel]);\r\n\r\n  useEffect(() => {\r\n    messagesEndRef.current && messagesEndRef.current.scrollIntoView({ behavior: \"smooth\" });\r\n  }, [messages]);\r\n\r\n  useEffect(() => {\r\n    if (!socketRef.current) return;\r\n    const handler = (msg) => {\r\n      if (msg.channel === selectedChannel) setMessages((prev) => [...prev, msg]);\r\n    };\r\n    socketRef.current.on(\"message\", handler);\r\n    return () => socketRef.current.off(\"message\", handler);\r\n  }, [selectedChannel]);\r\n\r\n  const handleCreateChannel = async () => {\r\n    if (!newChannel.trim()) return;\r\n    try {\r\n      const t = parseToken(token);\r\n      const res = await axios.post(\r\n        `${API_URL}/channels`,\r\n        { name: newChannel, members: [t] },\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n      setShowCreate(false);\r\n      setNewChannel(\"\");\r\n      const chs = await axios.get(`${API_URL}/channels`, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      setChannels(chs.data);\r\n      setSelectedChannel(res.data._id);\r\n      socketRef.current && socketRef.current.emit(\"join\", res.data._id);\r\n      socketRef.current && socketRef.current.emit(\"new-channel\");\r\n    } catch {\r\n      alert(\"Ошибка создания канала\");\r\n    }\r\n  };\r\n\r\n  const handleSend = () => {\r\n    if (!input.trim() || !selectedChannel) return;\r\n    const t = parseToken(token);\r\n    const msg = { text: input, sender: t, channel: selectedChannel };\r\n    socketRef.current && socketRef.current.emit(\"join\", selectedChannel);\r\n    socketRef.current.emit(\"message\", msg);\r\n    setInput(\"\");\r\n  };\r\n\r\n  const handleAuth = async () => {\r\n    setError(\"\");\r\n    try {\r\n      if (authMode === \"register\") {\r\n        await axios.post(`${API_URL}/register`, { username: login, password });\r\n      }\r\n      const res = await axios.post(`${API_URL}/login`, { username: login, password });\r\n      localStorage.setItem(\"token\", res.data.token);\r\n      setToken(res.data.token);\r\n    } catch (err) {\r\n      setError(\r\n        err.response && err.response.data && err.response.data.error\r\n          ? err.response.data.error\r\n          : \"Неверный логин или пароль, либо пользователь не зарегистрирован\"\r\n      );\r\n    }\r\n  };\r\n\r\n  // Функция для отправки изменений профиля\r\n  const handleProfileSave = async () => {\r\n    try {\r\n      const payload = {\r\n        username: editData.username,\r\n        password: editData.password,\r\n        city: editData.city,\r\n        status: editData.status,\r\n        age: editData.age,\r\n      };\r\n      Object.keys(payload).forEach(k => {\r\n        if (payload[k] === \"\" || payload[k] === null) delete payload[k];\r\n      });\r\n      const res = await axios.patch(`${API_URL}/profile`, payload, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      setUserProfile(res.data);\r\n      setEditMode(false);\r\n      if (payload.username && payload.username !== userProfile.username && res.data.token) {\r\n        localStorage.setItem(\"token\", res.data.token);\r\n        setToken(res.data.token);\r\n      }\r\n    } catch (e) {\r\n      alert(e?.response?.data?.error || e?.message || \"Ошибка обновления профиля\");\r\n    }\r\n  };\r\n\r\n  // После регистрации показываем модальное окно\r\n  const handleRegister = async () => {\r\n    setError(\"\");\r\n    try {\r\n      setRegistering(true);\r\n      // Передаем дополнительные поля при регистрации\r\n      await axios.post(`${API_URL}/register`, {\r\n        username: regUsername,\r\n        password: regPassword,\r\n        city: regCity,\r\n        age: regAge,\r\n        status: regStatus,\r\n      });\r\n      setRegistering(false);\r\n      // После успешной регистрации сразу логинимся\r\n      const res = await axios.post(`${API_URL}/login`, {\r\n        username: regUsername,\r\n        password: regPassword,\r\n      });\r\n      localStorage.setItem(\"token\", res.data.token);\r\n      setToken(res.data.token);\r\n      setShowProfileModal(true);\r\n      setProfileModalData({ city: \"\", status: \"\", age: \"\" });\r\n    } catch (e) {\r\n      setRegistering(false);\r\n      setError(\r\n        e?.response?.data?.error ||\r\n          \"Неверный логин или пароль, либо пользователь не зарегистрирован\"\r\n      );\r\n    }\r\n  };\r\n\r\n  // Сохранение данных профиля из модального окна\r\n  const handleSaveProfileModal = async () => {\r\n    try {\r\n      const payload = {\r\n        city: profileModalData.city,\r\n        status: profileModalData.status,\r\n        age: profileModalData.age,\r\n      };\r\n      await axios.patch(`${API_URL}/profile`, payload, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      setShowProfileModal(false);\r\n    } catch (e) {\r\n      alert(\r\n        e?.response?.data?.error ||\r\n          e?.message ||\r\n          \"Ошибка сохранения данных профиля\"\r\n      );\r\n    }\r\n  };\r\n\r\n  if (!token) {\r\n    return (\r\n      <div style={chatStyles.page}>\r\n        <div style={chatStyles.authContainer}>\r\n          <div style={chatStyles.authTitle}>\r\n            {authMode === \"register\" ? \"Регистрация\" : \"Вход\"}\r\n          </div>\r\n          {error && <div style={chatStyles.error}>{error}</div>}\r\n          <input\r\n            style={chatStyles.authInput}\r\n            placeholder=\"Имя\"\r\n            value={login}\r\n            onChange={e => setLogin(e.target.value)}\r\n          />\r\n          <input\r\n            style={chatStyles.authInput}\r\n            placeholder=\"Пароль\"\r\n            type=\"password\"\r\n            value={password}\r\n            onChange={e => setPassword(e.target.value)}\r\n          />\r\n          {/* Новые поля для регистрации */}\r\n          {authMode === \"register\" && (\r\n            <>\r\n              <input\r\n                style={chatStyles.authInput}\r\n                placeholder=\"Город\"\r\n                value={regCity}\r\n                onChange={e => setRegCity(e.target.value)}\r\n              />\r\n              <input\r\n                style={chatStyles.authInput}\r\n                placeholder=\"Возраст\"\r\n                type=\"number\"\r\n                min={0}\r\n                value={regAge}\r\n                onChange={e => setRegAge(e.target.value)}\r\n              />\r\n              <input\r\n                style={chatStyles.authInput}\r\n                placeholder=\"Семейный статус\"\r\n                value={regStatus}\r\n                onChange={e => setRegStatus(e.target.value)}\r\n              />\r\n            </>\r\n          )}\r\n          <button\r\n            style={chatStyles.authBtn}\r\n            onClick={handleAuth}\r\n          >\r\n            {authMode === \"register\" ? \"Зарегистрироваться\" : \"Войти\"}\r\n          </button>\r\n          <button\r\n            style={chatStyles.switchBtn}\r\n            onClick={() => setAuthMode(authMode === \"register\" ? \"login\" : \"register\")}\r\n          >\r\n            {authMode === \"register\" ? \"Войти\" : \"Регистрация\"}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div style={chatStyles.page}>\r\n      <div style={chatStyles.sidebar}>\r\n        <div style={chatStyles.sidebarTitle}>Sechat.ru</div>\r\n        <div style={chatStyles.channelList}>\r\n          <div style={{ fontWeight: 600, color: \"#fff\", marginBottom: 10 }}>Каналы</div>\r\n          {channels.length === 0 ? (\r\n            <div style={{ color: \"#b2bec3\", marginBottom: 8 }}>\r\n              Нет доступных каналов\r\n            </div>\r\n          ) : (\r\n            <>\r\n              {channels.map((ch) => (\r\n                <div\r\n                  key={ch._id}\r\n                  style={chatStyles.channelItem(selectedChannel === ch._id)}\r\n                  onClick={() => setSelectedChannel(ch._id)}\r\n                >\r\n                  {ch.name}\r\n                </div>\r\n              ))}\r\n            </>\r\n          )}\r\n          <button\r\n            style={chatStyles.createBtn}\r\n            onClick={() => setShowCreate((v) => !v)}\r\n          >\r\n            {showCreate ? \"Скрыть создание\" : \"Создать канал\"}\r\n          </button>\r\n          {showCreate && (\r\n            <div style={{ marginTop: 10 }}>\r\n              <input\r\n                style={chatStyles.input}\r\n                placeholder=\"Название канала\"\r\n                value={newChannel}\r\n                onChange={e => setNewChannel(e.target.value)}\r\n              />\r\n              <button style={chatStyles.createBtn} onClick={handleCreateChannel}>\r\n                Создать\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n        <div style={{ flex: 1 }} />\r\n        <div style={chatStyles.profileBtnBox}>\r\n          <button\r\n            style={chatStyles.profileBtn}\r\n            onClick={() => {\r\n              setShowProfile(v => !v);\r\n              setEditMode(false);\r\n            }}\r\n            title=\"Профиль\"\r\n          >\r\n            <svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" fill=\"none\">\r\n              <circle cx=\"13\" cy=\"13\" r=\"13\" fill=\"#00c3ff\" />\r\n              <circle cx=\"13\" cy=\"10\" r=\"4\" fill=\"#fff\" />\r\n              <ellipse cx=\"13\" cy=\"19\" rx=\"7\" ry=\"4\" fill=\"#fff\" />\r\n            </svg>\r\n          </button>\r\n          <div\r\n            style={{\r\n              ...chatStyles.profilePopup,\r\n              transform: showProfile ? \"translateY(0)\" : \"translateY(120%)\",\r\n              opacity: showProfile ? 1 : 0,\r\n              pointerEvents: showProfile ? \"auto\" : \"none\",\r\n              transition: \"transform 0.32s cubic-bezier(.4,1.4,.6,1), opacity 0.22s\",\r\n            }}\r\n          >\r\n            {userProfile && !editMode && (\r\n              <>\r\n                <div style={chatStyles.profileTitle}>Профиль</div>\r\n                <div style={chatStyles.profileField}>\r\n                  <span style={chatStyles.profileLabel}>Ник:</span> {userProfile.username}\r\n                </div>\r\n                <div style={chatStyles.profileField}>\r\n                  <span style={chatStyles.profileLabel}>Возраст:</span> {userProfile.age ?? \"—\"}\r\n                </div>\r\n                <div style={chatStyles.profileField}>\r\n                  <span style={chatStyles.profileLabel}>Город:</span> {userProfile.city ?? \"—\"}\r\n                </div>\r\n                <div style={chatStyles.profileField}>\r\n                  <span style={chatStyles.profileLabel}>Семейный статус:</span> {userProfile.status ?? \"—\"}\r\n                </div>\r\n                <button\r\n                  style={chatStyles.profileEditBtn}\r\n                  onClick={() => {\r\n                    setEditData({\r\n                      username: userProfile.username || \"\",\r\n                      password: \"\",\r\n                      city: userProfile.city || \"\",\r\n                      status: userProfile.status || \"\",\r\n                      age: userProfile.age || \"\",\r\n                    });\r\n                    setEditMode(true);\r\n                  }}\r\n                >\r\n                  Изменить данные\r\n                </button>\r\n              </>\r\n            )}\r\n            {userProfile && editMode && (\r\n              <>\r\n                <div style={chatStyles.profileTitle}>Редактирование профиля</div>\r\n                <div style={chatStyles.profileField}>\r\n                  <span style={chatStyles.profileLabel}>Ник:</span>\r\n                  <input\r\n                    style={chatStyles.profileInput}\r\n                    value={editData.username}\r\n                    onChange={e => setEditData(d => ({ ...d, username: e.target.value }))}\r\n                  />\r\n                </div>\r\n                <div style={chatStyles.profileField}>\r\n                  <span style={chatStyles.profileLabel}>Пароль:</span>\r\n                  <input\r\n                    style={chatStyles.profileInput}\r\n                    type=\"password\"\r\n                    value={editData.password}\r\n                    placeholder=\"Новый пароль\"\r\n                    onChange={e => setEditData(d => ({ ...d, password: e.target.value }))}\r\n                  />\r\n                </div>\r\n                <div style={chatStyles.profileField}>\r\n                  <span style={chatStyles.profileLabel}>Возраст:</span>\r\n                  <input\r\n                    style={chatStyles.profileInput}\r\n                    type=\"number\"\r\n                    min={0}\r\n                    value={editData.age}\r\n                    onChange={e => setEditData(d => ({ ...d, age: e.target.value }))}\r\n                  />\r\n                </div>\r\n                <div style={chatStyles.profileField}>\r\n                  <span style={chatStyles.profileLabel}>Город:</span>\r\n                  <input\r\n                    style={chatStyles.profileInput}\r\n                    value={editData.city}\r\n                    onChange={e => setEditData(d => ({ ...d, city: e.target.value }))}\r\n                  />\r\n                </div>\r\n                <div style={chatStyles.profileField}>\r\n                  <span style={chatStyles.profileLabel}>Семейный статус:</span>\r\n                  <input\r\n                    style={chatStyles.profileInput}\r\n                    value={editData.status}\r\n                    onChange={e => setEditData(d => ({ ...d, status: e.target.value }))}\r\n                  />\r\n                </div>\r\n                <div style={{ display: \"flex\", gap: 8, marginTop: 10, justifyContent: \"flex-end\" }}>\r\n                  <button\r\n                    style={chatStyles.profileEditBtn}\r\n                    onClick={handleProfileSave}\r\n                  >\r\n                    Сохранить\r\n                  </button>\r\n                  <button\r\n                    style={chatStyles.profileCloseBtn}\r\n                    onClick={() => setEditMode(false)}\r\n                  >\r\n                    Отмена\r\n                  </button>\r\n                </div>\r\n              </>\r\n            )}\r\n            {!userProfile && (\r\n              <div style={{ color: \"#b2bec3\", marginBottom: 8 }}>Загрузка...</div>\r\n            )}\r\n          </div>\r\n        </div>\r\n        <button\r\n          style={chatStyles.logoutBtn}\r\n          onClick={() => {\r\n            localStorage.removeItem(\"token\");\r\n            window.location.reload();\r\n          }}\r\n        >\r\n          Выйти\r\n        </button>\r\n      </div>\r\n      <div style={chatStyles.chatContainer}>\r\n        <div style={{\r\n          display: \"flex\",\r\n          alignItems: \"center\",\r\n          justifyContent: \"center\",\r\n          width: \"100%\",\r\n          marginBottom: 10,\r\n          minHeight: 32\r\n        }}>\r\n          <div style={chatStyles.chatTitle}>Чат</div>\r\n        </div>\r\n        <div\r\n          className=\"chat-box\"\r\n          style={chatStyles.chatBox}\r\n        >\r\n          {messages.map((msg) => {\r\n            const isMine = msg.sender === username;\r\n            // Формат времени\r\n            const time = msg.createdAt ? new Date(msg.createdAt).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) : '';\r\n            return (\r\n              <div key={msg._id} style={chatStyles.messageRow(isMine)}>\r\n                <div style={chatStyles.message(isMine)}>\r\n                  {/* Только для чужих сообщений показываем имя */}\r\n                  {!isMine && (\r\n                    <span style={chatStyles.messageSender}>\r\n                      {msg.sender}:\r\n                    </span>\r\n                  )}\r\n                  {msg.text}\r\n                  {msg.fileUrl && (\r\n                    <a\r\n                      href={msg.fileUrl}\r\n                      target=\"_blank\"\r\n                      rel=\"noopener noreferrer\"\r\n                      style={{\r\n                        color: \"#00c3ff\",\r\n                        marginLeft: 8,\r\n                        textDecoration: \"underline\",\r\n                        fontWeight: 500,\r\n                      }}\r\n                    >\r\n                      [файл]\r\n                    </a>\r\n                  )}\r\n                  {/* Время сообщения под текстом, меньшим шрифтом */}\r\n                  <div style={{ color: \"#b2bec3\", fontSize: 11, marginTop: 4, textAlign: isMine ? \"right\" : \"left\" }}>\r\n                    {time}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n          <div ref={messagesEndRef} />\r\n        </div>\r\n        {/* typing вынесен в отдельный flex-контейнер над inputRow */}\r\n        <div style={{ minHeight: 22, display: \"flex\", alignItems: \"flex-end\", marginBottom: 2 }}>\r\n          {typing && (\r\n            <div style={{\r\n              ...chatStyles.typing,\r\n              margin: 0,\r\n              paddingLeft: 8,\r\n              paddingRight: 8,\r\n              background: \"none\",\r\n              borderRadius: 0,\r\n              position: \"relative\",\r\n              zIndex: 2,\r\n              width: \"fit-content\",\r\n              maxWidth: \"80%\",\r\n              alignSelf: \"flex-start\",\r\n              boxShadow: \"none\"\r\n            }}>\r\n              {typing}\r\n            </div>\r\n          )}\r\n        </div>\r\n        <div style={chatStyles.inputRow}>\r\n          <input\r\n            style={chatStyles.input}\r\n            value={input}\r\n            onChange={e => setInput(e.target.value)}\r\n            onKeyDown={e => {\r\n              if (selectedChannel) {\r\n                socketRef.current.emit(\"typing\", { channel: selectedChannel });\r\n                if (e.key === \"Enter\") handleSend();\r\n              }\r\n            }}\r\n            disabled={!selectedChannel}\r\n            placeholder={\r\n              selectedChannel\r\n                ? \"Введите сообщение...\"\r\n                : \"Выберите канал\"\r\n            }\r\n          />\r\n          <button\r\n            style={chatStyles.sendBtn}\r\n            onClick={handleSend}\r\n            disabled={!selectedChannel || !input.trim()}\r\n          >\r\n            Отправить\r\n          </button>\r\n        </div>\r\n      </div>\r\n      {/* Модальное окно для ввода профиля после регистрации */}\r\n      {showProfileModal && (\r\n        <div\r\n          style={{\r\n            position: \"fixed\",\r\n            top: 0,\r\n            left: 0,\r\n            width: \"100vw\",\r\n            height: \"100vh\",\r\n            background: \"rgba(30,32,34,0.88)\",\r\n            zIndex: 9999,\r\n            display: \"flex\",\r\n            alignItems: \"center\",\r\n            justifyContent: \"center\",\r\n          }}\r\n        >\r\n          <div\r\n            style={{\r\n              background: \"#232526\",\r\n              borderRadius: 16,\r\n              boxShadow: \"0 2px 16px #00c3ff33\",\r\n              padding: 36,\r\n              minWidth: 320,\r\n              maxWidth: 400,\r\n              display: \"flex\",\r\n              flexDirection: \"column\",\r\n              alignItems: \"center\",\r\n            }}\r\n          >\r\n            <div style={{ fontWeight: 700, fontSize: 22, color: \"#00c3ff\", marginBottom: 18 }}>\r\n              Заполните профиль\r\n            </div>\r\n            <div style={{ width: \"100%\" }}>\r\n              <div style={{ marginBottom: 12 }}>\r\n                <label style={{ color: \"#00c3ff\", fontWeight: 600 }}>Город:</label>\r\n                <input\r\n                  style={chatStyles.profileInput}\r\n                  value={profileModalData.city}\r\n                  onChange={e =>\r\n                    setProfileModalData(d => ({ ...d, city: e.target.value }))\r\n                  }\r\n                />\r\n              </div>\r\n              <div style={{ marginBottom: 12 }}>\r\n                <label style={{ color: \"#00c3ff\", fontWeight: 600 }}>Возраст:</label>\r\n                <input\r\n                  style={chatStyles.profileInput}\r\n                  type=\"number\"\r\n                  min={0}\r\n                  value={profileModalData.age}\r\n                  onChange={e =>\r\n                    setProfileModalData(d => ({ ...d, age: e.target.value }))\r\n                  }\r\n                />\r\n              </div>\r\n              <div style={{ marginBottom: 12 }}>\r\n                <label style={{ color: \"#00c3ff\", fontWeight: 600 }}>Семейный статус:</label>\r\n                <input\r\n                  style={chatStyles.profileInput}\r\n                  value={profileModalData.status}\r\n                  onChange={e =>\r\n                    setProfileModalData(d => ({ ...d, status: e.target.value }))\r\n                  }\r\n                />\r\n              </div>\r\n              <button\r\n                style={chatStyles.profileEditBtn}\r\n                onClick={handleSaveProfileModal}\r\n              >\r\n                Сохранить\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}