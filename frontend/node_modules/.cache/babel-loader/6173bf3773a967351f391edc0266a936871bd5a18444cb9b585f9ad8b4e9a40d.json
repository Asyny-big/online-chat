{"ast":null,"code":"import _objectSpread from\"C:/Users/larak/AppData/Local/npm-cache/_npx/cd53aabf71f3f793/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef}from\"react\";import axios from\"axios\";import*as chatStyles from\"./styles/chatStyles\";import io from\"socket.io-client\";// --- Добавим список тем ---\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const THEMES=[{key:\"default\",name:\"Стандартная\",gradient:\"linear-gradient(120deg, #232526 0%, #414345 100%)\"},{key:\"dark\",name:\"Тёмная\",gradient:\"linear-gradient(120deg, #18191a 0%, #232526 100%)\"},{key:\"pink\",name:\"Розовая\",gradient:\"linear-gradient(120deg, #ff6a88 0%, #ff99ac 100%)\"},{key:\"green\",name:\"Зелёная\",gradient:\"linear-gradient(120deg, #11998e 0%, #38ef7d 100%)\"}];const API_URL=\"http://localhost:5000/api\";function parseToken(token){if(!token)return\"\";try{const t=token.split(\".\")[1].replace(/-/g,\"+\").replace(/_/g,\"/\");const n=decodeURIComponent(atob(t).split(\"\").map(c=>\"%\"+(\"00\"+c.charCodeAt(0).toString(16)).slice(-2)).join(\"\"));return JSON.parse(n).username||\"\";}catch(_unused){return\"\";}}function App(){var _THEMES$find2;const[token,setToken]=useState(localStorage.getItem(\"token\"));const[channels,setChannels]=useState([]);const[selectedChannel,setSelectedChannel]=useState(null);const[messages,setMessages]=useState([]);const[input,setInput]=useState(\"\");const[typing,setTyping]=useState(\"\");const typingTimeoutRef=useRef(null);const[showCreate,setShowCreate]=useState(false);const[newChannel,setNewChannel]=useState(\"\");const[authMode,setAuthMode]=useState(\"login\");const[username,setUsername]=useState(\"\");const[password,setPassword]=useState(\"\");const[error,setError]=useState(\"\");const[userProfile,setUserProfile]=useState(null);const[editMode,setEditMode]=useState(false);const[editData,setEditData]=useState({username:\"\",password:\"\",city:\"\",status:\"\",age:\"\"});const[showProfile,setShowProfile]=useState(false);const[showProfileModal,setShowProfileModal]=useState(false);const[profileModalData,setProfileModalData]=useState({city:\"\",status:\"\",age:\"\"});const[registering,setRegistering]=useState(false);const[theme,setTheme]=useState(\"default\");const[showThemeModal,setShowThemeModal]=useState(false);const socketRef=useRef(null);const messagesEndRef=useRef(null);const fileInputRefChat=React.useRef(null);// для вложений в чат\nconst fileInputRefAvatar=React.useRef(null);// для аватара профиля\nconst[avatarVersion,setAvatarVersion]=useState(Date.now());const[fileToSend,setFileToSend]=useState(null);const[filePreviewUrl,setFilePreviewUrl]=useState(null);const[modalMedia,setModalMedia]=useState(null);// {type, url, name}\nconst[attachBtnHover,setAttachBtnHover]=useState(false);// Состояние для ховера кнопки вложений\nuseEffect(()=>{setUsername(parseToken(token));},[token]);// --- Подгружаем тему из профиля ---\nuseEffect(()=>{if(!token)return;const fetchProfile=async()=>{try{const res=await axios.get(\"\".concat(API_URL,\"/profile\"),{headers:{Authorization:\"Bearer \".concat(token)}});setUserProfile(res.data);setTheme(res.data.theme||\"default\");}catch(_unused2){setUserProfile(null);setTheme(\"default\");}};fetchProfile();},[token]);// --- Применяем тему к странице ---\nuseEffect(()=>{var _THEMES$find;// Меняем фон страницы\ndocument.body.style.background=((_THEMES$find=THEMES.find(t=>t.key===theme))===null||_THEMES$find===void 0?void 0:_THEMES$find.gradient)||THEMES[0].gradient;},[theme]);// --- Функция смены темы ---\nconst handleThemeChange=async newTheme=>{setTheme(newTheme);setShowThemeModal(false);try{await axios.patch(\"\".concat(API_URL,\"/profile\"),{theme:newTheme},{headers:{Authorization:\"Bearer \".concat(token)}});setUserProfile(prev=>prev?_objectSpread(_objectSpread({},prev),{},{theme:newTheme}):prev);}catch(_unused3){// ignore\n}};useEffect(()=>{if(!token)return;axios.get(\"\".concat(API_URL,\"/channels\"),{headers:{Authorization:\"Bearer \".concat(token)}}).then(res=>setChannels(res.data)).catch(()=>setChannels([]));socketRef.current=io(\"http://localhost:5000\",{auth:{token}});socketRef.current.on(\"message\",msg=>{setMessages(prev=>msg.channel===selectedChannel?[...prev,msg]:prev);});socketRef.current.on(\"typing\",e=>{setTyping(\"\".concat(e.user,\" \\u043F\\u0435\\u0447\\u0430\\u0442\\u0430\\u0435\\u0442...\"));if(typingTimeoutRef.current)clearTimeout(typingTimeoutRef.current);typingTimeoutRef.current=setTimeout(()=>setTyping(\"\"),2000);});// Новый обработчик: обновлять список каналов при появлении нового\nconst handleNewChannel=()=>{axios.get(\"\".concat(API_URL,\"/channels\"),{headers:{Authorization:\"Bearer \".concat(token)}}).then(res=>setChannels(res.data)).catch(()=>setChannels([]));};socketRef.current.on(\"new-channel\",handleNewChannel);return()=>{socketRef.current&&socketRef.current.disconnect();socketRef.current&&socketRef.current.off(\"new-channel\",handleNewChannel);if(typingTimeoutRef.current)clearTimeout(typingTimeoutRef.current);};// eslint-disable-next-line\n},[token]);useEffect(()=>{if(token&&selectedChannel){axios.get(\"\".concat(API_URL,\"/messages/\").concat(selectedChannel),{headers:{Authorization:\"Bearer \".concat(token)}}).then(res=>setMessages(res.data));socketRef.current&&socketRef.current.emit(\"join\",selectedChannel);}},[token,selectedChannel]);useEffect(()=>{messagesEndRef.current&&messagesEndRef.current.scrollIntoView({behavior:\"smooth\"});},[messages]);useEffect(()=>{if(!socketRef.current)return;const handler=msg=>{if(msg.channel===selectedChannel)setMessages(prev=>[...prev,msg]);};socketRef.current.on(\"message\",handler);return()=>socketRef.current.off(\"message\",handler);},[selectedChannel]);const handleCreateChannel=async()=>{if(!newChannel.trim())return;try{const t=parseToken(token);const res=await axios.post(\"\".concat(API_URL,\"/channels\"),{name:newChannel,members:[t]},{headers:{Authorization:\"Bearer \".concat(token)}});setShowCreate(false);setNewChannel(\"\");const chs=await axios.get(\"\".concat(API_URL,\"/channels\"),{headers:{Authorization:\"Bearer \".concat(token)}});setChannels(chs.data);setSelectedChannel(res.data._id);socketRef.current&&socketRef.current.emit(\"join\",res.data._id);// socketRef.current && socketRef.current.emit(\"new-channel\"); // УДАЛЕНО, теперь сервер сам эмитит\n}catch(_unused4){alert(\"Ошибка создания канала\");}};const handleSend=async()=>{if(!input.trim()&&!fileToSend||!selectedChannel)return;const t=parseToken(token);let msg={text:input,sender:t,channel:selectedChannel};if(fileToSend){const formData=new FormData();formData.append(\"file\",fileToSend);const uploadRes=await axios.post(\"\".concat(API_URL,\"/upload\"),formData,{headers:{Authorization:\"Bearer \".concat(token)}});msg.fileUrl=uploadRes.data.url.startsWith(\"http\")?uploadRes.data.url:\"\".concat(window.location.protocol,\"//\").concat(window.location.hostname,\":5000\").concat(uploadRes.data.url);msg.fileType=uploadRes.data.fileType;msg.originalName=uploadRes.data.originalName;}socketRef.current&&socketRef.current.emit(\"join\",selectedChannel);socketRef.current.emit(\"message\",msg);setInput(\"\");setFileToSend(null);setFilePreviewUrl(null);if(fileInputRefChat.current)fileInputRefChat.current.value=\"\";};// Обработчик регистрации\nconst handleRegister=async e=>{e.preventDefault();setError(\"\");setRegistering(true);try{await axios.post(\"\".concat(API_URL,\"/register\"),{username,password});// После успешной регистрации сразу логиним\nconst res=await axios.post(\"\".concat(API_URL,\"/login\"),{username,password});localStorage.setItem(\"token\",res.data.token);setToken(res.data.token);}catch(e){var _e$response,_e$response$data;setError((e===null||e===void 0?void 0:(_e$response=e.response)===null||_e$response===void 0?void 0:(_e$response$data=_e$response.data)===null||_e$response$data===void 0?void 0:_e$response$data.error)||\"Ошибка регистрации или логина\");}setRegistering(false);};// Обработчик входа\nconst handleLogin=async e=>{e.preventDefault();setError(\"\");setRegistering(true);try{const res=await axios.post(\"\".concat(API_URL,\"/login\"),{username,password});localStorage.setItem(\"token\",res.data.token);setToken(res.data.token);}catch(e){var _e$response2,_e$response2$data;setError((e===null||e===void 0?void 0:(_e$response2=e.response)===null||_e$response2===void 0?void 0:(_e$response2$data=_e$response2.data)===null||_e$response2$data===void 0?void 0:_e$response2$data.error)||\"Неверный логин или пароль\");}setRegistering(false);};// Функция для отправки изменений профиля\nconst handleProfileSave=async()=>{try{const payload={username:editData.username,password:editData.password,city:editData.city,status:editData.status,age:editData.age};Object.keys(payload).forEach(k=>{if(payload[k]===\"\"||payload[k]===null)delete payload[k];});const res=await axios.patch(\"\".concat(API_URL,\"/profile\"),payload,{headers:{Authorization:\"Bearer \".concat(token)}});setUserProfile(res.data);setEditMode(false);if(payload.username&&payload.username!==userProfile.username&&res.data.token){localStorage.setItem(\"token\",res.data.token);setToken(res.data.token);}}catch(e){var _e$response3,_e$response3$data;alert((e===null||e===void 0?void 0:(_e$response3=e.response)===null||_e$response3===void 0?void 0:(_e$response3$data=_e$response3.data)===null||_e$response3$data===void 0?void 0:_e$response3$data.error)||(e===null||e===void 0?void 0:e.message)||\"Ошибка обновления профиля\");}};const handleProfilePopupBgClick=e=>{// Если клик по фону (а не по самому popup), закрываем\nsetShowProfile(false);};useEffect(()=>{if(userProfile){setEditData(d=>_objectSpread({},d));}},[userProfile]);useEffect(()=>{document.title=\"ГоВЧат 2.1 Beta\";// Добавляем/заменяем favicon\nconst faviconId=\"govchat-favicon\";let link=document.querySelector(\"link[rel=\\\"icon\\\"]#\".concat(faviconId));if(!link){link=document.createElement(\"link\");link.rel=\"icon\";link.id=faviconId;document.head.appendChild(link);}// SVG-эмодзи-иконка (например, 🦆)\nlink.type=\"image/svg+xml\";link.href='data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 64 64\"><text y=\"52\" font-size=\"52\">🦆</text></svg>';return()=>{// Не удаляем favicon при размонтировании\n};},[]);// Показывать превью выбранного файла\nuseEffect(()=>{if(fileToSend){if(fileToSend.type.startsWith(\"image/\")||fileToSend.type.startsWith(\"video/\")){const url=URL.createObjectURL(fileToSend);setFilePreviewUrl(url);return()=>URL.revokeObjectURL(url);}else{setFilePreviewUrl(null);}}else{setFilePreviewUrl(null);}},[fileToSend]);if(!token){return/*#__PURE__*/_jsx(\"div\",{style:chatStyles.page,children:/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.authContainer,children:[/*#__PURE__*/_jsx(\"div\",{style:chatStyles.authTitle,children:authMode===\"register\"?\"Регистрация\":\"Вход\"}),error&&/*#__PURE__*/_jsx(\"div\",{style:chatStyles.error,children:error}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:authMode===\"register\"?handleRegister:handleLogin,style:{width:\"100%\"},children:[/*#__PURE__*/_jsx(\"input\",{style:chatStyles.authInput,placeholder:\"\\u0418\\u043C\\u044F\",value:username,onChange:e=>setUsername(e.target.value),required:true,autoComplete:\"username\"}),/*#__PURE__*/_jsx(\"input\",{style:chatStyles.authInput,placeholder:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\",type:\"password\",value:password,onChange:e=>setPassword(e.target.value),required:true,autoComplete:\"current-password\"}),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.authBtn,type:\"submit\",disabled:registering,children:authMode===\"register\"?\"Зарегистрироваться\":\"Войти\"})]}),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.switchBtn,type:\"button\",onClick:()=>{setAuthMode(authMode===\"register\"?\"login\":\"register\");setError(\"\");},children:authMode===\"register\"?\"Войти\":\"Регистрация\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{style:_objectSpread(_objectSpread({},chatStyles.page),{},{background:((_THEMES$find2=THEMES.find(t=>t.key===theme))===null||_THEMES$find2===void 0?void 0:_THEMES$find2.gradient)||THEMES[0].gradient}),children:[/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.sidebar,children:[/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",flexDirection:\"column\",alignItems:\"flex-start\",gap:8,marginBottom:0,marginTop:12// было 0, стало 12 — опустить ниже\n},children:/*#__PURE__*/_jsx(\"button\",{style:{background:\"#fff\",border:\"none\",borderRadius:\"50%\",width:44,height:44,display:\"flex\",alignItems:\"center\",justifyContent:\"center\",fontSize:22,boxShadow:\"0 2px 8px #00c3ff33\",cursor:\"pointer\",marginLeft:0,marginBottom:0,marginTop:0,transition:\"background 0.2s\"},title:\"\\u041A\\u0430\\u0441\\u0442\\u043E\\u043C\\u0438\\u0437\\u0430\\u0446\\u0438\\u044F \\u043E\\u0444\\u043E\\u0440\\u043C\\u043B\\u0435\\u043D\\u0438\\u044F\",onClick:()=>setShowThemeModal(true),children:/*#__PURE__*/_jsx(\"span\",{role:\"img\",\"aria-label\":\"\\u041A\\u0430\\u0441\\u0442\\u043E\\u043C\\u0438\\u0437\\u0430\\u0446\\u0438\\u044F\",children:\"\\uD83C\\uDFA8\"})})}),/*#__PURE__*/_jsx(\"div\",{style:chatStyles.sidebarTitle,children:\"\\u0413\\u043E\\u0412\\u0427\\u0430\\u0442 2.1 Beta\"}),/*#__PURE__*/_jsx(\"div\",{style:chatStyles.channelList})]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.chatContainer,children:[/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",alignItems:\"center\",justifyContent:\"center\",width:\"100%\",marginBottom:10,minHeight:32},children:/*#__PURE__*/_jsx(\"div\",{style:chatStyles.chatTitle,children:\"\\u0427\\u0430\\u0442\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-box\",style:chatStyles.chatBox,children:[messages.map(msg=>{const isMine=msg.sender===username;// Формат времени\nconst time=msg.createdAt?new Date(msg.createdAt).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'}):'';return/*#__PURE__*/_jsx(\"div\",{style:chatStyles.messageRow(isMine),children:/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.message(isMine),children:[!isMine&&/*#__PURE__*/_jsxs(\"span\",{style:chatStyles.messageSender,children:[msg.sender,\":\"]}),msg.text,msg.fileUrl&&msg.fileType&&/*#__PURE__*/_jsx(\"span\",{style:{display:\"block\",marginTop:8},children:msg.fileType.startsWith(\"image/\")?/*#__PURE__*/_jsx(\"img\",{src:msg.fileUrl,alt:msg.originalName||\"image\",style:{maxWidth:120,maxHeight:120,borderRadius:8,cursor:\"pointer\",boxShadow:\"0 2px 8px #00c3ff33\"},onClick:()=>setModalMedia({type:\"image\",url:msg.fileUrl,name:msg.originalName})}):msg.fileType.startsWith(\"video/\")?/*#__PURE__*/_jsx(\"video\",{src:msg.fileUrl,controls:false,style:{maxWidth:120,maxHeight:120,borderRadius:8,cursor:\"pointer\",boxShadow:\"0 2px 8px #00c3ff33\"},onClick:()=>setModalMedia({type:\"video\",url:msg.fileUrl,name:msg.originalName}),children:\"\\u0412\\u0430\\u0448 \\u0431\\u0440\\u0430\\u0443\\u0437\\u0435\\u0440 \\u043D\\u0435 \\u043F\\u043E\\u0434\\u0434\\u0435\\u0440\\u0436\\u0438\\u0432\\u0430\\u0435\\u0442 \\u0432\\u0438\\u0434\\u0435\\u043E.\"}):/*#__PURE__*/// Превью для документов\n_jsxs(\"span\",{style:{display:\"flex\",alignItems:\"center\",gap:8,cursor:\"pointer\",background:\"#232526\",borderRadius:8,padding:\"8px 12px\",boxShadow:\"0 2px 8px #00c3ff22\",maxWidth:220,minWidth:0,color:\"#fff\"},onClick:()=>{// Определяем тип документа для предпросмотра\nconst ext=(msg.originalName||\"\").split('.').pop().toLowerCase();if(msg.fileType===\"application/pdf\"){setModalMedia({type:\"pdf\",url:msg.fileUrl,name:msg.originalName});}else{setModalMedia({type:\"doc\",url:msg.fileUrl,name:msg.originalName,ext});}},title:msg.originalName,children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:28},children:(()=>{const ext=(msg.originalName||\"\").split('.').pop().toLowerCase();if(ext===\"pdf\")return\"📄\";if([\"doc\",\"docx\"].includes(ext))return\"📝\";if([\"xls\",\"xlsx\"].includes(ext))return\"📊\";if([\"ppt\",\"pptx\"].includes(ext))return\"📈\";if([\"txt\",\"rtf\"].includes(ext))return\"📃\";return\"📁\";})()}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:14,color:\"#fff\",wordBreak:\"break-all\",flex:1,minWidth:0},children:msg.originalName})]})}),/*#__PURE__*/_jsx(\"div\",{style:{color:\"#b2bec3\",fontSize:11,marginTop:4,textAlign:isMine?\"right\":\"left\"},children:time})]})},msg._id);}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsx(\"div\",{style:{minHeight:22,display:\"flex\",alignItems:\"flex-end\",marginBottom:2},children:typing&&/*#__PURE__*/_jsx(\"div\",{style:_objectSpread(_objectSpread({},chatStyles.typing),{},{margin:0,paddingLeft:8,paddingRight:8,background:\"none\",borderRadius:0,position:\"relative\",zIndex:2,width:\"fit-content\",maxWidth:\"80%\",alignSelf:\"flex-start\",boxShadow:\"none\"}),children:typing})}),fileToSend&&/*#__PURE__*/_jsxs(\"div\",{style:{margin:\"0 0 8px 0\",padding:\"6px 10px\",background:\"#35363a\",borderRadius:8,display:\"flex\",alignItems:\"center\",gap:10,maxWidth:320},children:[fileToSend.type.startsWith(\"image/\")&&filePreviewUrl&&/*#__PURE__*/_jsx(\"img\",{src:filePreviewUrl,alt:\"preview\",style:{maxWidth:48,maxHeight:48,borderRadius:6}}),fileToSend.type.startsWith(\"video/\")&&filePreviewUrl&&/*#__PURE__*/_jsx(\"video\",{src:filePreviewUrl,style:{maxWidth:48,maxHeight:48,borderRadius:6},controls:true}),!fileToSend.type.startsWith(\"image/\")&&!fileToSend.type.startsWith(\"video/\")&&/*#__PURE__*/_jsx(\"span\",{role:\"img\",\"aria-label\":\"file\",children:\"\\uD83D\\uDCCE\"}),/*#__PURE__*/_jsx(\"span\",{style:{color:\"#fff\",fontSize:14,wordBreak:\"break-all\"},children:fileToSend.name}),/*#__PURE__*/_jsx(\"button\",{style:{marginLeft:\"auto\",background:\"none\",border:\"none\",color:\"#ff7675\",fontWeight:700,fontSize:16,cursor:\"pointer\"},title:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u0444\\u0430\\u0439\\u043B\",onClick:()=>{setFileToSend(null);setFilePreviewUrl(null);if(fileInputRefChat.current)fileInputRefChat.current.value=\"\";},children:\"\\u2715\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.inputRow,children:[/*#__PURE__*/_jsx(\"button\",{style:_objectSpread({},attachBtnHover?_objectSpread(_objectSpread({},chatStyles.attachBtn),chatStyles.attachBtnHover):chatStyles.attachBtn),type:\"button\",onClick:()=>fileInputRefChat.current&&fileInputRefChat.current.click(),title:\"\\u041F\\u0440\\u0438\\u043A\\u0440\\u0435\\u043F\\u0438\\u0442\\u044C \\u0444\\u0430\\u0439\\u043B\",tabIndex:-1,onMouseEnter:()=>setAttachBtnHover(true),onMouseLeave:()=>setAttachBtnHover(false),disabled:false,children:/*#__PURE__*/_jsx(\"span\",{style:{color:\"#222\",fontSize:22,display:\"flex\",alignItems:\"center\"},children:\"\\uD83D\\uDCCE\"})}),/*#__PURE__*/_jsx(\"input\",{ref:fileInputRefChat,type:\"file\",style:{display:\"none\"},onChange:e=>{var _e$target$files;if((_e$target$files=e.target.files)!==null&&_e$target$files!==void 0&&_e$target$files[0])setFileToSend(e.target.files[0]);}}),/*#__PURE__*/_jsx(\"input\",{style:chatStyles.input,value:input,onChange:e=>setInput(e.target.value),onKeyDown:e=>{if(selectedChannel){socketRef.current.emit(\"typing\",{channel:selectedChannel});if(e.key===\"Enter\")handleSend();}},disabled:!selectedChannel,placeholder:selectedChannel?\"Введите сообщение...\":\"Выберите канал\"}),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.sendBtn,onClick:handleSend,disabled:!selectedChannel||!input.trim()&&!fileToSend,children:\"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\"})]}),modalMedia&&/*#__PURE__*/_jsx(\"div\",{style:{position:\"fixed\",left:0,top:0,width:\"100vw\",height:\"100vh\",background:\"rgba(0,0,0,0.7)\",zIndex:9999,display:\"flex\",alignItems:\"center\",justifyContent:\"center\"},onClick:()=>setModalMedia(null),children:/*#__PURE__*/_jsxs(\"div\",{style:{background:\"#232526\",borderRadius:12,padding:24,maxWidth:\"90vw\",maxHeight:\"90vh\",boxShadow:\"0 4px 32px #000a\",display:\"flex\",flexDirection:\"column\",alignItems:\"center\",position:\"relative\"},onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"button\",{style:{position:\"absolute\",top:8,right:12,background:\"none\",border:\"none\",color:\"#fff\",fontSize:28,fontWeight:700,cursor:\"pointer\",zIndex:2},onClick:()=>setModalMedia(null),title:\"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\",children:\"\\u2715\"}),modalMedia.type===\"image\"?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"img\",{src:modalMedia.url,alt:modalMedia.name,style:{maxWidth:\"70vw\",maxHeight:\"70vh\",borderRadius:10,marginBottom:16}}),modalMedia.name&&/*#__PURE__*/_jsx(\"div\",{style:{color:\"#fff\",fontSize:16,marginBottom:16,wordBreak:\"break-all\",textAlign:\"center\",maxWidth:\"60vw\"},children:modalMedia.name})]}):modalMedia.type===\"video\"?/*#__PURE__*/_jsx(\"video\",{src:modalMedia.url,controls:true,autoPlay:true,style:{maxWidth:\"70vw\",maxHeight:\"70vh\",borderRadius:10,marginBottom:16,background:\"#000\"}}):modalMedia.type===\"pdf\"?/*#__PURE__*/_jsx(\"iframe\",{src:modalMedia.url,title:modalMedia.name,style:{width:\"70vw\",height:\"70vh\",border:\"none\",borderRadius:10,background:\"#fff\",marginBottom:16}}):modalMedia.type===\"doc\"?/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",flexDirection:\"column\",alignItems:\"center\",justifyContent:\"center\",minHeight:200,minWidth:200,marginBottom:16},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:64,marginBottom:16},children:(()=>{const ext=(modalMedia.ext||\"\").toLowerCase();if(ext===\"pdf\")return\"📄\";if([\"doc\",\"docx\"].includes(ext))return\"📝\";if([\"xls\",\"xlsx\"].includes(ext))return\"📊\";if([\"ppt\",\"pptx\"].includes(ext))return\"📈\";if([\"txt\",\"rtf\"].includes(ext))return\"📃\";return\"📁\";})()}),/*#__PURE__*/_jsx(\"div\",{style:{color:\"#fff\",fontSize:18,marginBottom:8,wordBreak:\"break-all\",textAlign:\"center\"},children:modalMedia.name}),/*#__PURE__*/_jsx(\"div\",{style:{color:\"#b2bec3\",fontSize:15,marginBottom:18},children:\"\\u041F\\u0440\\u0435\\u0434\\u043F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440 \\u043D\\u0435\\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u0435\\u043D \\u0434\\u043B\\u044F \\u044D\\u0442\\u043E\\u0433\\u043E \\u0442\\u0438\\u043F\\u0430 \\u0444\\u0430\\u0439\\u043B\\u0430\"})]}):null,/*#__PURE__*/_jsx(\"button\",{style:{background:\"linear-gradient(90deg,#00c3ff,#3a7bd5)\",color:\"#fff\",border:\"none\",borderRadius:8,padding:\"10px 22px\",fontWeight:600,fontSize:15,cursor:\"pointer\",boxShadow:\"0 2px 8px #00c3ff33\",textDecoration:\"none\"},onClick:async e=>{e.stopPropagation();try{const response=await fetch(modalMedia.url,{credentials:\"same-origin\"});const blob=await response.blob();const url=window.URL.createObjectURL(blob);const a=document.createElement(\"a\");a.href=url;a.download=modalMedia.name||\"file\";document.body.appendChild(a);a.click();setTimeout(()=>{window.URL.revokeObjectURL(url);a.remove();},200);}catch(err){alert(\"Ошибка скачивания файла\");}},children:\"\\u0421\\u043A\\u0430\\u0447\\u0430\\u0442\\u044C\"})]})})]})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","useRef","axios","chatStyles","io","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","THEMES","key","name","gradient","API_URL","parseToken","token","t","split","replace","n","decodeURIComponent","atob","map","c","charCodeAt","toString","slice","join","JSON","parse","username","_unused","App","_THEMES$find2","setToken","localStorage","getItem","channels","setChannels","selectedChannel","setSelectedChannel","messages","setMessages","input","setInput","typing","setTyping","typingTimeoutRef","showCreate","setShowCreate","newChannel","setNewChannel","authMode","setAuthMode","setUsername","password","setPassword","error","setError","userProfile","setUserProfile","editMode","setEditMode","editData","setEditData","city","status","age","showProfile","setShowProfile","showProfileModal","setShowProfileModal","profileModalData","setProfileModalData","registering","setRegistering","theme","setTheme","showThemeModal","setShowThemeModal","socketRef","messagesEndRef","fileInputRefChat","fileInputRefAvatar","avatarVersion","setAvatarVersion","Date","now","fileToSend","setFileToSend","filePreviewUrl","setFilePreviewUrl","modalMedia","setModalMedia","attachBtnHover","setAttachBtnHover","fetchProfile","res","get","concat","headers","Authorization","data","_unused2","_THEMES$find","document","body","style","background","find","handleThemeChange","newTheme","patch","prev","_objectSpread","_unused3","then","catch","current","auth","on","msg","channel","e","user","clearTimeout","setTimeout","handleNewChannel","disconnect","off","emit","scrollIntoView","behavior","handler","handleCreateChannel","trim","post","members","chs","_id","_unused4","alert","handleSend","text","sender","formData","FormData","append","uploadRes","fileUrl","url","startsWith","window","location","protocol","hostname","fileType","originalName","value","handleRegister","preventDefault","setItem","_e$response","_e$response$data","response","handleLogin","_e$response2","_e$response2$data","handleProfileSave","payload","Object","keys","forEach","k","_e$response3","_e$response3$data","message","handleProfilePopupBgClick","d","title","faviconId","link","querySelector","createElement","rel","id","head","appendChild","type","href","URL","createObjectURL","revokeObjectURL","page","children","authContainer","authTitle","onSubmit","width","authInput","placeholder","onChange","target","required","autoComplete","authBtn","disabled","switchBtn","onClick","sidebar","display","flexDirection","alignItems","gap","marginBottom","marginTop","border","borderRadius","height","justifyContent","fontSize","boxShadow","cursor","marginLeft","transition","role","sidebarTitle","channelList","chatContainer","minHeight","chatTitle","className","chatBox","isMine","time","createdAt","toLocaleTimeString","hour","minute","messageRow","messageSender","src","alt","maxWidth","maxHeight","controls","padding","minWidth","color","ext","pop","toLowerCase","includes","wordBreak","flex","textAlign","ref","margin","paddingLeft","paddingRight","position","zIndex","alignSelf","fontWeight","inputRow","attachBtn","click","tabIndex","onMouseEnter","onMouseLeave","_e$target$files","files","onKeyDown","sendBtn","left","top","stopPropagation","right","autoPlay","textDecoration","fetch","credentials","blob","a","download","remove","err"],"sources":["D:/prr/prr/semak4/driver/frontend/src/App.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\nimport axios from \"axios\";\r\nimport * as chatStyles from \"./styles/chatStyles\";\r\nimport io from \"socket.io-client\";\r\n\r\n// --- Добавим список тем ---\r\nconst THEMES = [\r\n  { key: \"default\", name: \"Стандартная\", gradient: \"linear-gradient(120deg, #232526 0%, #414345 100%)\" },\r\n  { key: \"dark\", name: \"Тёмная\", gradient: \"linear-gradient(120deg, #18191a 0%, #232526 100%)\" },\r\n  { key: \"pink\", name: \"Розовая\", gradient: \"linear-gradient(120deg, #ff6a88 0%, #ff99ac 100%)\" },\r\n  { key: \"green\", name: \"Зелёная\", gradient: \"linear-gradient(120deg, #11998e 0%, #38ef7d 100%)\" },\r\n];\r\n\r\nconst API_URL = \"http://localhost:5000/api\";\r\n\r\nfunction parseToken(token) {\r\n  if (!token) return \"\";\r\n  try {\r\n    const t = token.split(\".\")[1].replace(/-/g, \"+\").replace(/_/g, \"/\");\r\n    const n = decodeURIComponent(\r\n      atob(t)\r\n        .split(\"\")\r\n        .map((c) => \"%\" + (\"00\" + c.charCodeAt(0).toString(16)).slice(-2))\r\n        .join(\"\")\r\n    );\r\n    return JSON.parse(n).username || \"\";\r\n  } catch {\r\n    return \"\";\r\n  }\r\n}\r\n\r\nfunction App() {\r\n  const [token, setToken] = useState(localStorage.getItem(\"token\"));\r\n  const [channels, setChannels] = useState([]);\r\n  const [selectedChannel, setSelectedChannel] = useState(null);\r\n  const [messages, setMessages] = useState([]);\r\n  const [input, setInput] = useState(\"\");\r\n  const [typing, setTyping] = useState(\"\");\r\n  const typingTimeoutRef = useRef(null);\r\n  const [showCreate, setShowCreate] = useState(false);\r\n  const [newChannel, setNewChannel] = useState(\"\");\r\n  const [authMode, setAuthMode] = useState(\"login\");\r\n  const [username, setUsername] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [error, setError] = useState(\"\");\r\n  const [userProfile, setUserProfile] = useState(null);\r\n  const [editMode, setEditMode] = useState(false);\r\n  const [editData, setEditData] = useState({\r\n    username: \"\",\r\n    password: \"\",\r\n    city: \"\",\r\n    status: \"\",\r\n    age: \"\",\r\n  });\r\n  const [showProfile, setShowProfile] = useState(false);\r\n  const [showProfileModal, setShowProfileModal] = useState(false);\r\n  const [profileModalData, setProfileModalData] = useState({\r\n    city: \"\",\r\n    status: \"\",\r\n    age: \"\",\r\n  });\r\n  const [registering, setRegistering] = useState(false);\r\n  const [theme, setTheme] = useState(\"default\");\r\n  const [showThemeModal, setShowThemeModal] = useState(false);\r\n  const socketRef = useRef(null);\r\n  const messagesEndRef = useRef(null);\r\n  const fileInputRefChat = React.useRef(null); // для вложений в чат\r\n  const fileInputRefAvatar = React.useRef(null); // для аватара профиля\r\n  const [avatarVersion, setAvatarVersion] = useState(Date.now());\r\n  const [fileToSend, setFileToSend] = useState(null);\r\n  const [filePreviewUrl, setFilePreviewUrl] = useState(null);\r\n  const [modalMedia, setModalMedia] = useState(null); // {type, url, name}\r\n  const [attachBtnHover, setAttachBtnHover] = useState(false); // Состояние для ховера кнопки вложений\r\n\r\n  useEffect(() => {\r\n    setUsername(parseToken(token));\r\n  }, [token]);\r\n\r\n  // --- Подгружаем тему из профиля ---\r\n  useEffect(() => {\r\n    if (!token) return;\r\n    const fetchProfile = async () => {\r\n      try {\r\n        const res = await axios.get(`${API_URL}/profile`, {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        });\r\n        setUserProfile(res.data);\r\n        setTheme(res.data.theme || \"default\");\r\n      } catch {\r\n        setUserProfile(null);\r\n        setTheme(\"default\");\r\n      }\r\n    };\r\n    fetchProfile();\r\n  }, [token]);\r\n\r\n  // --- Применяем тему к странице ---\r\n  useEffect(() => {\r\n    // Меняем фон страницы\r\n    document.body.style.background = THEMES.find(t => t.key === theme)?.gradient || THEMES[0].gradient;\r\n  }, [theme]);\r\n\r\n  // --- Функция смены темы ---\r\n  const handleThemeChange = async (newTheme) => {\r\n    setTheme(newTheme);\r\n    setShowThemeModal(false);\r\n    try {\r\n      await axios.patch(`${API_URL}/profile`, { theme: newTheme }, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      setUserProfile((prev) => prev ? { ...prev, theme: newTheme } : prev);\r\n    } catch {\r\n      // ignore\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!token) return;\r\n    axios\r\n      .get(`${API_URL}/channels`, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      })\r\n      .then((res) => setChannels(res.data))\r\n      .catch(() => setChannels([]));\r\n\r\n    socketRef.current = io(\"http://localhost:5000\", {\r\n      auth: { token },\r\n    });\r\n\r\n    socketRef.current.on(\"message\", (msg) => {\r\n      setMessages((prev) =>\r\n        msg.channel === selectedChannel ? [...prev, msg] : prev\r\n      );\r\n    });\r\n\r\n    socketRef.current.on(\"typing\", (e) => {\r\n      setTyping(`${e.user} печатает...`);\r\n      if (typingTimeoutRef.current) clearTimeout(typingTimeoutRef.current);\r\n      typingTimeoutRef.current = setTimeout(() => setTyping(\"\"), 2000);\r\n    });\r\n\r\n    // Новый обработчик: обновлять список каналов при появлении нового\r\n    const handleNewChannel = () => {\r\n      axios\r\n        .get(`${API_URL}/channels`, {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        })\r\n        .then((res) => setChannels(res.data))\r\n        .catch(() => setChannels([]));\r\n    };\r\n    socketRef.current.on(\"new-channel\", handleNewChannel);\r\n\r\n    return () => {\r\n      socketRef.current && socketRef.current.disconnect();\r\n      socketRef.current && socketRef.current.off(\"new-channel\", handleNewChannel);\r\n      if (typingTimeoutRef.current) clearTimeout(typingTimeoutRef.current);\r\n    };\r\n    // eslint-disable-next-line\r\n  }, [token]);\r\n\r\n  useEffect(() => {\r\n    if (token && selectedChannel) {\r\n      axios\r\n        .get(`${API_URL}/messages/${selectedChannel}`, {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        })\r\n        .then((res) => setMessages(res.data));\r\n      socketRef.current && socketRef.current.emit(\"join\", selectedChannel);\r\n    }\r\n  }, [token, selectedChannel]);\r\n\r\n  useEffect(() => {\r\n    messagesEndRef.current && messagesEndRef.current.scrollIntoView({ behavior: \"smooth\" });\r\n  }, [messages]);\r\n\r\n  useEffect(() => {\r\n    if (!socketRef.current) return;\r\n    const handler = (msg) => {\r\n      if (msg.channel === selectedChannel) setMessages((prev) => [...prev, msg]);\r\n    };\r\n    socketRef.current.on(\"message\", handler);\r\n    return () => socketRef.current.off(\"message\", handler);\r\n  }, [selectedChannel]);\r\n\r\n  const handleCreateChannel = async () => {\r\n    if (!newChannel.trim()) return;\r\n    try {\r\n      const t = parseToken(token);\r\n      const res = await axios.post(\r\n        `${API_URL}/channels`,\r\n        { name: newChannel, members: [t] },\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n      setShowCreate(false);\r\n      setNewChannel(\"\");\r\n      const chs = await axios.get(`${API_URL}/channels`, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      setChannels(chs.data);\r\n      setSelectedChannel(res.data._id);\r\n      socketRef.current && socketRef.current.emit(\"join\", res.data._id);\r\n      // socketRef.current && socketRef.current.emit(\"new-channel\"); // УДАЛЕНО, теперь сервер сам эмитит\r\n    } catch {\r\n      alert(\"Ошибка создания канала\");\r\n    }\r\n  };\r\n\r\n  const handleSend = async () => {\r\n    if ((!input.trim() && !fileToSend) || !selectedChannel) return;\r\n    const t = parseToken(token);\r\n    let msg = { text: input, sender: t, channel: selectedChannel };\r\n    if (fileToSend) {\r\n      const formData = new FormData();\r\n      formData.append(\"file\", fileToSend);\r\n      const uploadRes = await axios.post(\r\n        `${API_URL}/upload`,\r\n        formData,\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n      msg.fileUrl = uploadRes.data.url.startsWith(\"http\")\r\n        ? uploadRes.data.url\r\n        : `${window.location.protocol}//${window.location.hostname}:5000${uploadRes.data.url}`;\r\n      msg.fileType = uploadRes.data.fileType;\r\n      msg.originalName = uploadRes.data.originalName;\r\n    }\r\n    socketRef.current && socketRef.current.emit(\"join\", selectedChannel);\r\n    socketRef.current.emit(\"message\", msg);\r\n    setInput(\"\");\r\n    setFileToSend(null);\r\n    setFilePreviewUrl(null);\r\n    if (fileInputRefChat.current) fileInputRefChat.current.value = \"\";\r\n  };\r\n\r\n  // Обработчик регистрации\r\n  const handleRegister = async (e) => {\r\n    e.preventDefault();\r\n    setError(\"\");\r\n    setRegistering(true);\r\n    try {\r\n      await axios.post(`${API_URL}/register`, {\r\n        username,\r\n        password,\r\n      });\r\n      // После успешной регистрации сразу логиним\r\n      const res = await axios.post(`${API_URL}/login`, {\r\n        username,\r\n        password,\r\n      });\r\n      localStorage.setItem(\"token\", res.data.token);\r\n      setToken(res.data.token);\r\n    } catch (e) {\r\n      setError(\r\n        e?.response?.data?.error ||\r\n          \"Ошибка регистрации или логина\"\r\n      );\r\n    }\r\n    setRegistering(false);\r\n  };\r\n\r\n  // Обработчик входа\r\n  const handleLogin = async (e) => {\r\n    e.preventDefault();\r\n    setError(\"\");\r\n    setRegistering(true);\r\n    try {\r\n      const res = await axios.post(`${API_URL}/login`, {\r\n        username,\r\n        password,\r\n      });\r\n      localStorage.setItem(\"token\", res.data.token);\r\n      setToken(res.data.token);\r\n    } catch (e) {\r\n      setError(\r\n        e?.response?.data?.error ||\r\n          \"Неверный логин или пароль\"\r\n      );\r\n    }\r\n    setRegistering(false);\r\n  };\r\n\r\n  // Функция для отправки изменений профиля\r\n  const handleProfileSave = async () => {\r\n    try {\r\n      const payload = {\r\n        username: editData.username,\r\n        password: editData.password,\r\n        city: editData.city,\r\n        status: editData.status,\r\n        age: editData.age,\r\n      };\r\n      Object.keys(payload).forEach(k => {\r\n        if (payload[k] === \"\" || payload[k] === null) delete payload[k];\r\n      });\r\n      const res = await axios.patch(`${API_URL}/profile`, payload, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      setUserProfile(res.data);\r\n      setEditMode(false);\r\n      if (payload.username && payload.username !== userProfile.username && res.data.token) {\r\n        localStorage.setItem(\"token\", res.data.token);\r\n        setToken(res.data.token);\r\n      }\r\n    } catch (e) {\r\n      alert(e?.response?.data?.error || e?.message || \"Ошибка обновления профиля\");\r\n    }\r\n  };\r\n\r\n  const handleProfilePopupBgClick = (e) => {\r\n    // Если клик по фону (а не по самому popup), закрываем\r\n    setShowProfile(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (userProfile) {\r\n      setEditData(d => ({\r\n        ...d,\r\n      }));\r\n    }\r\n  }, [userProfile]);\r\n\r\n  useEffect(() => {\r\n    document.title = \"ГоВЧат 2.1 Beta\";\r\n    // Добавляем/заменяем favicon\r\n    const faviconId = \"govchat-favicon\";\r\n    let link = document.querySelector(`link[rel=\"icon\"]#${faviconId}`);\r\n    if (!link) {\r\n      link = document.createElement(\"link\");\r\n      link.rel = \"icon\";\r\n      link.id = faviconId;\r\n      document.head.appendChild(link);\r\n    }\r\n    // SVG-эмодзи-иконка (например, 🦆)\r\n    link.type = \"image/svg+xml\";\r\n    link.href =\r\n      'data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 64 64\"><text y=\"52\" font-size=\"52\">🦆</text></svg>';\r\n    return () => {\r\n      // Не удаляем favicon при размонтировании\r\n    };\r\n  }, []);\r\n\r\n  // Показывать превью выбранного файла\r\n  useEffect(() => {\r\n    if (fileToSend) {\r\n      if (fileToSend.type.startsWith(\"image/\") || fileToSend.type.startsWith(\"video/\")) {\r\n        const url = URL.createObjectURL(fileToSend);\r\n        setFilePreviewUrl(url);\r\n        return () => URL.revokeObjectURL(url);\r\n      } else {\r\n        setFilePreviewUrl(null);\r\n      }\r\n    } else {\r\n      setFilePreviewUrl(null);\r\n    }\r\n  }, [fileToSend]);\r\n\r\n  if (!token) {\r\n    return (\r\n      <div style={chatStyles.page}>\r\n        <div style={chatStyles.authContainer}>\r\n          <div style={chatStyles.authTitle}>\r\n            {authMode === \"register\" ? \"Регистрация\" : \"Вход\"}\r\n          </div>\r\n          {error && <div style={chatStyles.error}>{error}</div>}\r\n          <form\r\n            onSubmit={authMode === \"register\" ? handleRegister : handleLogin}\r\n            style={{ width: \"100%\" }}\r\n          >\r\n            <input\r\n              style={chatStyles.authInput}\r\n              placeholder=\"Имя\"\r\n              value={username}\r\n              onChange={e => setUsername(e.target.value)}\r\n              required\r\n              autoComplete=\"username\"\r\n            />\r\n            <input\r\n              style={chatStyles.authInput}\r\n              placeholder=\"Пароль\"\r\n              type=\"password\"\r\n              value={password}\r\n              onChange={e => setPassword(e.target.value)}\r\n              required\r\n              autoComplete=\"current-password\"\r\n            />\r\n            <button\r\n              style={chatStyles.authBtn}\r\n              type=\"submit\"\r\n              disabled={registering}\r\n            >\r\n              {authMode === \"register\" ? \"Зарегистрироваться\" : \"Войти\"}\r\n            </button>\r\n          </form>\r\n          <button\r\n            style={chatStyles.switchBtn}\r\n            type=\"button\"\r\n            onClick={() => {\r\n              setAuthMode(authMode === \"register\" ? \"login\" : \"register\");\r\n              setError(\"\");\r\n            }}\r\n          >\r\n            {authMode === \"register\" ? \"Войти\" : \"Регистрация\"}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div style={{ ...chatStyles.page, background: THEMES.find(t => t.key === theme)?.gradient || THEMES[0].gradient }}>\r\n      <div style={chatStyles.sidebar}>\r\n        {/* --- Кнопка кастомизации --- */}\r\n        <div style={{\r\n          display: \"flex\",\r\n          flexDirection: \"column\",\r\n          alignItems: \"flex-start\",\r\n          gap: 8,\r\n          marginBottom: 0,\r\n          marginTop: 12, // было 0, стало 12 — опустить ниже\r\n        }}>\r\n          <button\r\n            style={{\r\n              background: \"#fff\",\r\n              border: \"none\",\r\n              borderRadius: \"50%\",\r\n              width: 44,\r\n              height: 44,\r\n              display: \"flex\",\r\n              alignItems: \"center\",\r\n              justifyContent: \"center\",\r\n              fontSize: 22,\r\n              boxShadow: \"0 2px 8px #00c3ff33\",\r\n              cursor: \"pointer\",\r\n              marginLeft: 0,\r\n              marginBottom: 0,\r\n              marginTop: 0,\r\n              transition: \"background 0.2s\",\r\n            }}\r\n            title=\"Кастомизация оформления\"\r\n            onClick={() => setShowThemeModal(true)}\r\n          >\r\n            <span role=\"img\" aria-label=\"Кастомизация\">🎨</span>\r\n          </button>\r\n        </div>\r\n        {/* --- Название программы и каналы --- */}\r\n        <div style={chatStyles.sidebarTitle}>ГоВЧат 2.1 Beta</div>\r\n        <div style={chatStyles.channelList}>\r\n          {/* ...existing code... */}\r\n        </div>\r\n        {/* ...existing code... */}\r\n      </div>\r\n      <div style={chatStyles.chatContainer}>\r\n        <div style={{\r\n          display: \"flex\",\r\n          alignItems: \"center\",\r\n          justifyContent: \"center\",\r\n          width: \"100%\",\r\n          marginBottom: 10,\r\n          minHeight: 32\r\n        }}>\r\n          <div style={chatStyles.chatTitle}>Чат</div>\r\n        </div>\r\n        <div\r\n          className=\"chat-box\"\r\n          style={chatStyles.chatBox}\r\n        >\r\n          {messages.map((msg) => {\r\n            const isMine = msg.sender === username;\r\n            // Формат времени\r\n            const time = msg.createdAt ? new Date(msg.createdAt).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) : '';\r\n            return (\r\n              <div key={msg._id} style={chatStyles.messageRow(isMine)}>\r\n                <div style={chatStyles.message(isMine)}>\r\n                  {/* Только для чужих сообщений показываем имя */}\r\n                  {!isMine && (\r\n                    <span style={chatStyles.messageSender}>\r\n                      {msg.sender}:\r\n                    </span>\r\n                  )}\r\n                  {msg.text}\r\n                  {/* Превью файлов */}\r\n                  {msg.fileUrl && msg.fileType && (\r\n                    <span style={{ display: \"block\", marginTop: 8 }}>\r\n                      {msg.fileType.startsWith(\"image/\") ? (\r\n                        <img\r\n                          src={msg.fileUrl}\r\n                          alt={msg.originalName || \"image\"}\r\n                          style={{ maxWidth: 120, maxHeight: 120, borderRadius: 8, cursor: \"pointer\", boxShadow: \"0 2px 8px #00c3ff33\" }}\r\n                          onClick={() => setModalMedia({ type: \"image\", url: msg.fileUrl, name: msg.originalName })}\r\n                        />\r\n                      ) : msg.fileType.startsWith(\"video/\") ? (\r\n                        <video\r\n                          src={msg.fileUrl}\r\n                          controls={false}\r\n                          style={{ maxWidth: 120, maxHeight: 120, borderRadius: 8, cursor: \"pointer\", boxShadow: \"0 2px 8px #00c3ff33\" }}\r\n                          onClick={() => setModalMedia({ type: \"video\", url: msg.fileUrl, name: msg.originalName })}\r\n                        >\r\n                          Ваш браузер не поддерживает видео.\r\n                        </video>\r\n                      ) : (\r\n                        // Превью для документов\r\n                        <span\r\n                          style={{\r\n                            display: \"flex\",\r\n                            alignItems: \"center\",\r\n                            gap: 8,\r\n                            cursor: \"pointer\",\r\n                            background: \"#232526\",\r\n                            borderRadius: 8,\r\n                            padding: \"8px 12px\",\r\n                            boxShadow: \"0 2px 8px #00c3ff22\",\r\n                            maxWidth: 220,\r\n                            minWidth: 0,\r\n                            color: \"#fff\"\r\n                          }}\r\n                          onClick={() => {\r\n                            // Определяем тип документа для предпросмотра\r\n                            const ext = (msg.originalName || \"\").split('.').pop().toLowerCase();\r\n                            if (msg.fileType === \"application/pdf\") {\r\n                              setModalMedia({ type: \"pdf\", url: msg.fileUrl, name: msg.originalName });\r\n                            } else {\r\n                              setModalMedia({ type: \"doc\", url: msg.fileUrl, name: msg.originalName, ext });\r\n                            }\r\n                          }}\r\n                          title={msg.originalName}\r\n                        >\r\n                          {/* Иконка документа по расширению */}\r\n                          <span style={{ fontSize: 28 }}>\r\n                            {(() => {\r\n                              const ext = (msg.originalName || \"\").split('.').pop().toLowerCase();\r\n                              if (ext === \"pdf\") return \"📄\";\r\n                              if ([\"doc\", \"docx\"].includes(ext)) return \"📝\";\r\n                              if ([\"xls\", \"xlsx\"].includes(ext)) return \"📊\";\r\n                              if ([\"ppt\", \"pptx\"].includes(ext)) return \"📈\";\r\n                              if ([\"txt\", \"rtf\"].includes(ext)) return \"📃\";\r\n                              return \"📁\";\r\n                            })()}\r\n                          </span>\r\n                          <span style={{\r\n                            fontSize: 14,\r\n                            color: \"#fff\",\r\n                            wordBreak: \"break-all\",\r\n                            flex: 1,\r\n                            minWidth: 0,\r\n                          }}>\r\n                            {msg.originalName}\r\n                          </span>\r\n                        </span>\r\n                      )}\r\n                      {/* Кнопка скачать убрана отсюда */}\r\n                    </span>\r\n                  )}\r\n                  {/* Время сообщения под текстом, меньшим шрифтом */}\r\n                  <div style={{ color: \"#b2bec3\", fontSize: 11, marginTop: 4, textAlign: isMine ? \"right\" : \"left\" }}>\r\n                    {time}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n          <div ref={messagesEndRef} />\r\n        </div>\r\n        {/* typing вынесен в отдельный flex-контейнер над inputRow */}\r\n        <div style={{ minHeight: 22, display: \"flex\", alignItems: \"flex-end\", marginBottom: 2 }}>\r\n          {typing && (\r\n            <div style={{\r\n              ...chatStyles.typing,\r\n              margin: 0,\r\n              paddingLeft: 8,\r\n              paddingRight: 8,\r\n              background: \"none\",\r\n              borderRadius: 0,\r\n              position: \"relative\",\r\n              zIndex: 2,\r\n              width: \"fit-content\",\r\n              maxWidth: \"80%\",\r\n              alignSelf: \"flex-start\",\r\n              boxShadow: \"none\"\r\n            }}>\r\n              {typing}\r\n            </div>\r\n          )}\r\n        </div>\r\n        {/* Превью выбранного файла теперь над inputRow */}\r\n        {fileToSend && (\r\n          <div style={{\r\n            margin: \"0 0 8px 0\",\r\n            padding: \"6px 10px\",\r\n            background: \"#35363a\",\r\n            borderRadius: 8,\r\n            display: \"flex\",\r\n            alignItems: \"center\",\r\n            gap: 10,\r\n            maxWidth: 320\r\n          }}>\r\n            {fileToSend.type.startsWith(\"image/\") && filePreviewUrl && (\r\n              <img src={filePreviewUrl} alt=\"preview\" style={{ maxWidth: 48, maxHeight: 48, borderRadius: 6 }} />\r\n            )}\r\n            {fileToSend.type.startsWith(\"video/\") && filePreviewUrl && (\r\n              <video src={filePreviewUrl} style={{ maxWidth: 48, maxHeight: 48, borderRadius: 6 }} controls />\r\n            )}\r\n            {!fileToSend.type.startsWith(\"image/\") && !fileToSend.type.startsWith(\"video/\") && (\r\n              <span role=\"img\" aria-label=\"file\">📎</span>\r\n            )}\r\n            <span style={{ color: \"#fff\", fontSize: 14, wordBreak: \"break-all\" }}>{fileToSend.name}</span>\r\n            <button\r\n              style={{\r\n                marginLeft: \"auto\",\r\n                background: \"none\",\r\n                border: \"none\",\r\n                color: \"#ff7675\",\r\n                fontWeight: 700,\r\n                fontSize: 16,\r\n                cursor: \"pointer\"\r\n              }}\r\n              title=\"Удалить файл\"\r\n              onClick={() => {\r\n                setFileToSend(null);\r\n                setFilePreviewUrl(null);\r\n                if (fileInputRefChat.current) fileInputRefChat.current.value = \"\";\r\n              }}\r\n            >\r\n              ✕\r\n            </button>\r\n          </div>\r\n        )}\r\n\r\n        <div style={chatStyles.inputRow}>\r\n          {/* Кнопка выбора файла */}\r\n          <button\r\n            style={{\r\n              ...(attachBtnHover ? { ...chatStyles.attachBtn, ...chatStyles.attachBtnHover } : chatStyles.attachBtn),\r\n            }}\r\n            type=\"button\"\r\n            onClick={() => fileInputRefChat.current && fileInputRefChat.current.click()}\r\n            title=\"Прикрепить файл\"\r\n            tabIndex={-1}\r\n            onMouseEnter={() => setAttachBtnHover(true)}\r\n            onMouseLeave={() => setAttachBtnHover(false)}\r\n            disabled={false}\r\n          >\r\n            <span style={{ color: \"#222\", fontSize: 22, display: \"flex\", alignItems: \"center\" }}>📎</span>\r\n          </button>\r\n          <input\r\n            ref={fileInputRefChat}\r\n            type=\"file\"\r\n            style={{ display: \"none\" }}\r\n            onChange={e => {\r\n              if (e.target.files?.[0]) setFileToSend(e.target.files[0]);\r\n            }}\r\n          />\r\n          <input\r\n            style={chatStyles.input}\r\n            value={input}\r\n            onChange={e => setInput(e.target.value)}\r\n            onKeyDown={e => {\r\n              if (selectedChannel) {\r\n                socketRef.current.emit(\"typing\", { channel: selectedChannel });\r\n                if (e.key === \"Enter\") handleSend();\r\n              }\r\n            }}\r\n            disabled={!selectedChannel}\r\n            placeholder={\r\n              selectedChannel\r\n                ? \"Введите сообщение...\"\r\n                : \"Выберите канал\"\r\n            }\r\n          />\r\n          <button\r\n            style={chatStyles.sendBtn}\r\n            onClick={handleSend}\r\n            disabled={!selectedChannel || (!input.trim() && !fileToSend)}\r\n          >\r\n            Отправить\r\n          </button>\r\n        </div>\r\n        {/* Модальное окно для просмотра фото/видео */}\r\n        {modalMedia && (\r\n          <div\r\n            style={{\r\n              position: \"fixed\",\r\n              left: 0,\r\n              top: 0,\r\n              width: \"100vw\",\r\n              height: \"100vh\",\r\n              background: \"rgba(0,0,0,0.7)\",\r\n              zIndex: 9999,\r\n              display: \"flex\",\r\n              alignItems: \"center\",\r\n              justifyContent: \"center\"\r\n            }}\r\n            onClick={() => setModalMedia(null)}\r\n          >\r\n            <div\r\n              style={{\r\n                background: \"#232526\",\r\n                borderRadius: 12,\r\n                padding: 24,\r\n                maxWidth: \"90vw\",\r\n                maxHeight: \"90vh\",\r\n                boxShadow: \"0 4px 32px #000a\",\r\n                display: \"flex\",\r\n                flexDirection: \"column\",\r\n                alignItems: \"center\",\r\n                position: \"relative\"\r\n              }}\r\n              onClick={e => e.stopPropagation()}\r\n            >\r\n              <button\r\n                style={{\r\n                  position: \"absolute\",\r\n                  top: 8,\r\n                  right: 12,\r\n                  background: \"none\",\r\n                  border: \"none\",\r\n                  color: \"#fff\",\r\n                  fontSize: 28,\r\n                  fontWeight: 700,\r\n                  cursor: \"pointer\",\r\n                  zIndex: 2\r\n                }}\r\n                onClick={() => setModalMedia(null)}\r\n                title=\"Закрыть\"\r\n              >✕</button>\r\n              {modalMedia.type === \"image\" ? (\r\n                <>\r\n                  <img\r\n                    src={modalMedia.url}\r\n                    alt={modalMedia.name}\r\n                    style={{ maxWidth: \"70vw\", maxHeight: \"70vh\", borderRadius: 10, marginBottom: 16 }}\r\n                  />\r\n                  {/* Название изображения над кнопкой скачать */}\r\n                  {modalMedia.name && (\r\n                    <div style={{\r\n                      color: \"#fff\",\r\n                      fontSize: 16,\r\n                      marginBottom: 16,\r\n                      wordBreak: \"break-all\",\r\n                      textAlign: \"center\",\r\n                      maxWidth: \"60vw\"\r\n                    }}>\r\n                      {modalMedia.name}\r\n                    </div>\r\n                  )}\r\n                </>\r\n              ) : modalMedia.type === \"video\" ? (\r\n                <video\r\n                  src={modalMedia.url}\r\n                  controls\r\n                  autoPlay\r\n                  style={{ maxWidth: \"70vw\", maxHeight: \"70vh\", borderRadius: 10, marginBottom: 16, background: \"#000\" }}\r\n                />\r\n              ) : modalMedia.type === \"pdf\" ? (\r\n                <iframe\r\n                  src={modalMedia.url}\r\n                  title={modalMedia.name}\r\n                  style={{\r\n                    width: \"70vw\",\r\n                    height: \"70vh\",\r\n                    border: \"none\",\r\n                    borderRadius: 10,\r\n                    background: \"#fff\",\r\n                    marginBottom: 16\r\n                  }}\r\n                />\r\n              ) : modalMedia.type === \"doc\" ? (\r\n                <div style={{\r\n                  display: \"flex\",\r\n                  flexDirection: \"column\",\r\n                  alignItems: \"center\",\r\n                  justifyContent: \"center\",\r\n                  minHeight: 200,\r\n                  minWidth: 200,\r\n                  marginBottom: 16\r\n                }}>\r\n                  <span style={{ fontSize: 64, marginBottom: 16 }}>\r\n                    {(() => {\r\n                      const ext = (modalMedia.ext || \"\").toLowerCase();\r\n                      if (ext === \"pdf\") return \"📄\";\r\n                      if ([\"doc\", \"docx\"].includes(ext)) return \"📝\";\r\n                      if ([\"xls\", \"xlsx\"].includes(ext)) return \"📊\";\r\n                      if ([\"ppt\", \"pptx\"].includes(ext)) return \"📈\";\r\n                      if ([\"txt\", \"rtf\"].includes(ext)) return \"📃\";\r\n                      return \"📁\";\r\n                    })()}\r\n                  </span>\r\n                  <div style={{ color: \"#fff\", fontSize: 18, marginBottom: 8, wordBreak: \"break-all\", textAlign: \"center\" }}>\r\n                    {modalMedia.name}\r\n                  </div>\r\n                  <div style={{ color: \"#b2bec3\", fontSize: 15, marginBottom: 18 }}>\r\n                    Предпросмотр недоступен для этого типа файла\r\n                  </div>\r\n                </div>\r\n              ) : null}\r\n              <button\r\n                style={{\r\n                  background: \"linear-gradient(90deg,#00c3ff,#3a7bd5)\",\r\n                  color: \"#fff\",\r\n                  border: \"none\",\r\n                  borderRadius: 8,\r\n                  padding: \"10px 22px\",\r\n                  fontWeight: 600,\r\n                  fontSize: 15,\r\n                  cursor: \"pointer\",\r\n                  boxShadow: \"0 2px 8px #00c3ff33\",\r\n                  textDecoration: \"none\"\r\n                }}\r\n                onClick={async e => {\r\n                  e.stopPropagation();\r\n                  try {\r\n                    const response = await fetch(modalMedia.url, { credentials: \"same-origin\" });\r\n                    const blob = await response.blob();\r\n                    const url = window.URL.createObjectURL(blob);\r\n                    const a = document.createElement(\"a\");\r\n                    a.href = url;\r\n                    a.download = modalMedia.name || \"file\";\r\n                    document.body.appendChild(a);\r\n                    a.click();\r\n                    setTimeout(() => {\r\n                      window.URL.revokeObjectURL(url);\r\n                      a.remove();\r\n                    }, 200);\r\n                  } catch (err) {\r\n                    alert(\"Ошибка скачивания файла\");\r\n                  }\r\n                }}\r\n              >\r\n                Скачать\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}