{"ast":null,"code":"import _objectSpread from\"C:/Users/larak/AppData/Local/npm-cache/_npx/cd53aabf71f3f793/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef}from\"react\";import axios from\"axios\";import*as chatStyles from\"./styles/chatStyles\";import io from\"socket.io-client\";import ReCAPTCHA from\"react-google-recaptcha\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const API_URL=\"/api\";function parseToken(token){if(!token)return\"\";try{const t=token.split(\".\")[1].replace(/-/g,\"+\").replace(/_/g,\"/\");const n=decodeURIComponent(atob(t).split(\"\").map(c=>\"%\"+(\"00\"+c.charCodeAt(0).toString(16)).slice(-2)).join(\"\"));return JSON.parse(n).username||\"\";}catch(_unused){return\"\";}}function App(){var _userProfile$age,_userProfile$city,_userProfile$status;const[token,setToken]=useState(localStorage.getItem(\"token\"));const[channels,setChannels]=useState([]);const[selectedChannel,setSelectedChannel]=useState(null);const[messages,setMessages]=useState([]);const[input,setInput]=useState(\"\");const[typing,setTyping]=useState(\"\");const typingTimeoutRef=useRef(null);const[showCreate,setShowCreate]=useState(false);const[newChannel,setNewChannel]=useState(\"\");const[authMode,setAuthMode]=useState(\"login\");const[username,setUsername]=useState(\"\");const[password,setPassword]=useState(\"\");const[error,setError]=useState(\"\");const[userProfile,setUserProfile]=useState(null);const[editMode,setEditMode]=useState(false);const[editData,setEditData]=useState({username:\"\",password:\"\",city:\"\",status:\"\",age:\"\"});const[showProfile,setShowProfile]=useState(false);const[showProfileModal,setShowProfileModal]=useState(false);const[profileModalData,setProfileModalData]=useState({city:\"\",status:\"\",age:\"\"});const[registering,setRegistering]=useState(false);const socketRef=useRef(null);const messagesEndRef=useRef(null);const fileInputRefChat=React.useRef(null);// для вложений в чат\nconst fileInputRefAvatar=React.useRef(null);// для аватара профиля\nconst[avatarVersion,setAvatarVersion]=useState(Date.now());const[fileToSend,setFileToSend]=useState(null);const[filePreviewUrl,setFilePreviewUrl]=useState(null);const[modalMedia,setModalMedia]=useState(null);// {type, url, name}\nconst[attachBtnHover,setAttachBtnHover]=useState(false);// Состояние для ховера кнопки вложений\nconst[showCustomizer,setShowCustomizer]=useState(false);// новое состояние\nconst[theme,setTheme]=useState(chatStyles.themes[0]);// выбранная тема\nconst[recording,setRecording]=useState(false);const[recordTime,setRecordTime]=useState(0);const[mediaRecorder,setMediaRecorder]=useState(null);const[audioBlob,setAudioBlob]=useState(null);const[audioUrl,setAudioUrl]=useState(null);const recordTimerRef=useRef(null);const[mobileMenuOpen,setMobileMenuOpen]=useState(false);const[recaptchaToken,setRecaptchaToken]=useState(\"\");const recaptchaRef=useRef(null);// обычная капча\nconst recaptchaInvisibleRef=useRef(null);// невидимая капча для автологина\n// Добавляем состояния для видеозвонков\nconst[isVideoCallOpen,setIsVideoCallOpen]=useState(false);const[videoCallNotification,setVideoCallNotification]=useState(null);const[videoCallParticipants,setVideoCallParticipants]=useState([]);const[localStream,setLocalStream]=useState(null);const[remoteStreams,setRemoteStreams]=useState({});const[isMuted,setIsMuted]=useState(false);const[isVideoOff,setIsVideoOff]=useState(false);const localVideoRef=useRef(null);const remoteVideoRefs=useRef({});// --- WebRTC state ---\nconst peerConnections=useRef({});// Функция для старта записи аудио\nconst startRecording=async()=>{if(!navigator.mediaDevices||!window.MediaRecorder){alert(\"Ваш браузер не поддерживает запись аудио\");return;}try{const stream=await navigator.mediaDevices.getUserMedia({audio:true});const recorder=new window.MediaRecorder(stream);let chunks=[];recorder.ondataavailable=e=>{if(e.data.size>0)chunks.push(e.data);};recorder.onstop=()=>{const blob=new Blob(chunks,{type:\"audio/webm\"});setAudioBlob(blob);setAudioUrl(URL.createObjectURL(blob));setRecording(false);setRecordTime(0);stream.getTracks().forEach(track=>track.stop());};setMediaRecorder(recorder);setRecording(true);setRecordTime(0);recordTimerRef.current=setInterval(()=>{setRecordTime(rt=>rt+1);},1000);chunks=[];recorder.start();}catch(err){alert(\"Ошибка доступа к микрофону\");}};// Функция для остановки записи аудио\nconst stopRecording=()=>{if(mediaRecorder){mediaRecorder.stop();setMediaRecorder(null);}setRecording(false);if(recordTimerRef.current){clearInterval(recordTimerRef.current);recordTimerRef.current=null;}};// Функция для отправки аудиосообщения\nconst sendAudioMessage=async()=>{if(!audioBlob||!selectedChannel)return;const t=parseToken(token);const formData=new FormData();formData.append(\"file\",audioBlob,\"voice-message.webm\");const uploadRes=await axios.post(\"\".concat(API_URL,\"/upload\"),formData,{headers:{Authorization:\"Bearer \".concat(token)}});const msg={text:\"\",sender:t,channel:selectedChannel,fileUrl:uploadRes.data.url,fileType:uploadRes.data.fileType,originalName:uploadRes.data.originalName||\"voice-message.webm\"};socketRef.current&&socketRef.current.emit(\"join\",selectedChannel);socketRef.current.emit(\"message\",msg);setAudioBlob(null);setAudioUrl(null);};// Функции для работы с видеозвонками\nconst startLocalStream=async()=>{try{const stream=await navigator.mediaDevices.getUserMedia({video:true,audio:true});setLocalStream(stream);if(localVideoRef.current){localVideoRef.current.srcObject=stream;}}catch(error){console.error('Ошибка доступа к камере/микрофону:',error);alert('Ошибка доступа к камере/микрофону');}};const stopLocalStream=()=>{if(localStream){localStream.getTracks().forEach(track=>track.stop());setLocalStream(null);}setVideoCallParticipants([]);setRemoteStreams({});};const startVideoCall=()=>{if(!selectedChannel){alert('Выберите канал для видеозвонка');return;}socketRef.current.emit('start-video-call',{channel:selectedChannel,caller:username});setIsVideoCallOpen(true);startLocalStream();};const joinVideoCall=()=>{setIsVideoCallOpen(true);setVideoCallNotification(null);startLocalStream();if(selectedChannel){socketRef.current.emit('join-video-call',{channel:selectedChannel,username:username});}};const endVideoCall=()=>{stopLocalStream();if(selectedChannel){socketRef.current.emit('leave-video-call',{channel:selectedChannel});}setIsVideoCallOpen(false);};const dismissVideoNotification=()=>{setVideoCallNotification(null);};const toggleMute=()=>{if(localStream){localStream.getAudioTracks().forEach(track=>{track.enabled=isMuted;});setIsMuted(!isMuted);}};const toggleVideo=()=>{if(localStream){localStream.getVideoTracks().forEach(track=>{track.enabled=isVideoOff;});setIsVideoOff(!isVideoOff);}};// Функция для отправки сигналов WebRTC через Socket.IO\nconst sendSignal=(type,payload)=>{if(selectedChannel){socketRef.current.emit('video-signal',_objectSpread({channel:selectedChannel,type},payload));}};// --- WebRTC обработчики ---\nuseEffect(()=>{if(!isVideoCallOpen||!localStream||!selectedChannel)return;// При получении сигнала WebRTC\nconst handleSignal=async data=>{const{from,type,sdp,candidate}=data;if(from===socketRef.current.id)return;// не обрабатывать свои сигналы\n// Создаём PeerConnection если нет\nif(!peerConnections.current[from]){const pc=new RTCPeerConnection({iceServers:[{urls:'stun:stun.l.google.com:19302'}]});peerConnections.current[from]=pc;// Добавляем свои треки\nlocalStream.getTracks().forEach(track=>pc.addTrack(track,localStream));// ICE candidates\npc.onicecandidate=event=>{if(event.candidate){sendSignal('ice-candidate',{to:from,candidate:event.candidate});}};// Получение remote stream\npc.ontrack=event=>{setRemoteStreams(prev=>_objectSpread(_objectSpread({},prev),{},{[from]:event.streams[0]}));};}const pc=peerConnections.current[from];if(type==='offer'){await pc.setRemoteDescription(new RTCSessionDescription(sdp));const answer=await pc.createAnswer();await pc.setLocalDescription(answer);sendSignal('answer',{to:from,sdp:answer});}else if(type==='answer'){await pc.setRemoteDescription(new RTCSessionDescription(sdp));}else if(type==='ice-candidate'&&candidate){try{await pc.addIceCandidate(new RTCIceCandidate(candidate));}catch(_unused2){}}};socketRef.current.on('video-signal',handleSignal);// При появлении нового участника инициируем offer\nconst handleUserJoined=data=>{const{userId}=data;if(userId===socketRef.current.id)return;if(!peerConnections.current[userId]){const pc=new RTCPeerConnection({iceServers:[{urls:'stun:stun.l.google.com:19302'}]});peerConnections.current[userId]=pc;localStream.getTracks().forEach(track=>pc.addTrack(track,localStream));pc.onicecandidate=event=>{if(event.candidate){sendSignal('ice-candidate',{to:userId,candidate:event.candidate});}};pc.ontrack=event=>{setRemoteStreams(prev=>_objectSpread(_objectSpread({},prev),{},{[userId]:event.streams[0]}));};// Создаём offer\npc.createOffer().then(offer=>{pc.setLocalDescription(offer);sendSignal('offer',{to:userId,sdp:offer});});}};socketRef.current.on('user-joined-video-call',handleUserJoined);// Удаляем remote stream и peerConnection при выходе пользователя\nconst handleUserLeft=data=>{const{userId}=data;if(peerConnections.current[userId]){peerConnections.current[userId].close();delete peerConnections.current[userId];}setRemoteStreams(prev=>{const newStreams=_objectSpread({},prev);delete newStreams[userId];return newStreams;});};socketRef.current.on('user-left-video-call',handleUserLeft);return()=>{socketRef.current.off('video-signal',handleSignal);socketRef.current.off('user-joined-video-call',handleUserJoined);socketRef.current.off('user-left-video-call',handleUserLeft);};},[isVideoCallOpen,localStream,selectedChannel]);// Очищаем peerConnections при завершении звонка\nuseEffect(()=>{if(!isVideoCallOpen){Object.values(peerConnections.current).forEach(pc=>pc.close());peerConnections.current={};setRemoteStreams({});}},[isVideoCallOpen]);useEffect(()=>{setUsername(parseToken(token));},[token]);useEffect(()=>{if(!token)return;const fetchProfile=async()=>{try{const res=await axios.get(\"\".concat(API_URL,\"/profile\"),{headers:{Authorization:\"Bearer \".concat(token)}});setUserProfile(res.data);// Применяем тему из профиля\nif(res.data.theme&&(res.data.theme.pageBg||res.data.theme.chatBg)){const found=chatStyles.themes.find(t=>t.pageBg===res.data.theme.pageBg&&t.chatBg===res.data.theme.chatBg);setTheme(found||_objectSpread(_objectSpread({},chatStyles.themes[0]),res.data.theme));}else{setTheme(chatStyles.themes[0]);}}catch(_unused3){setUserProfile(null);setTheme(chatStyles.themes[0]);}};fetchProfile();},[token]);useEffect(()=>{if(!token)return;axios.get(\"\".concat(API_URL,\"/channels\"),{headers:{Authorization:\"Bearer \".concat(token)}}).then(res=>setChannels(res.data)).catch(()=>setChannels([]));socketRef.current=io(\"/\",{auth:{token}});socketRef.current.on(\"message\",msg=>{setMessages(prev=>msg.channel===selectedChannel?[...prev,msg]:prev);});socketRef.current.on(\"typing\",e=>{setTyping(\"\".concat(e.user,\" \\u043F\\u0435\\u0447\\u0430\\u0442\\u0430\\u0435\\u0442...\"));if(typingTimeoutRef.current)clearTimeout(typingTimeoutRef.current);typingTimeoutRef.current=setTimeout(()=>setTyping(\"\"),2000);});// Добавляем обработчики видеозвонков\nsocketRef.current.on('video-call-started',data=>{if(data.caller!==username){setVideoCallNotification({caller:data.caller,channel:data.channel});}});socketRef.current.on('video-call-ended',()=>{setIsVideoCallOpen(false);setVideoCallNotification(null);stopLocalStream();});socketRef.current.on('user-joined-video-call',data=>{setVideoCallParticipants(prev=>{if(!prev.find(p=>p.id===data.userId)){return[...prev,{id:data.userId,username:data.username||'Участник'}];}return prev;});});socketRef.current.on('user-left-video-call',data=>{console.log('User left video call:',data.userId);setVideoCallParticipants(prev=>prev.filter(p=>p.id!==data.userId));setRemoteStreams(prev=>{const newStreams=_objectSpread({},prev);delete newStreams[data.userId];return newStreams;});});// Новый обработчик: обновлять список каналов при появлении нового\nconst handleNewChannel=()=>{axios.get(\"\".concat(API_URL,\"/channels\"),{headers:{Authorization:\"Bearer \".concat(token)}}).then(res=>setChannels(res.data)).catch(()=>setChannels([]));};socketRef.current.on(\"new-channel\",handleNewChannel);return()=>{socketRef.current&&socketRef.current.disconnect();socketRef.current&&socketRef.current.off(\"new-channel\",handleNewChannel);socketRef.current&&socketRef.current.off('video-call-started');socketRef.current&&socketRef.current.off('video-call-ended');socketRef.current&&socketRef.current.off('user-joined-video-call');socketRef.current&&socketRef.current.off('user-left-video-call');if(typingTimeoutRef.current)clearTimeout(typingTimeoutRef.current);};// eslint-disable-next-line\n},[token,username]);useEffect(()=>{if(token&&selectedChannel){axios.get(\"\".concat(API_URL,\"/messages/\").concat(selectedChannel),{headers:{Authorization:\"Bearer \".concat(token)}}).then(res=>setMessages(res.data));socketRef.current&&socketRef.current.emit(\"join\",selectedChannel);}},[token,selectedChannel]);useEffect(()=>{messagesEndRef.current&&messagesEndRef.current.scrollIntoView({behavior:\"smooth\"});},[messages]);useEffect(()=>{if(!socketRef.current)return;const handler=msg=>{if(msg.channel===selectedChannel)setMessages(prev=>[...prev,msg]);};socketRef.current.on(\"message\",handler);return()=>socketRef.current.off(\"message\",handler);},[selectedChannel]);const handleCreateChannel=async()=>{if(!newChannel.trim())return;try{const t=parseToken(token);const res=await axios.post(\"\".concat(API_URL,\"/channels\"),{name:newChannel,members:[t]},{headers:{Authorization:\"Bearer \".concat(token)}});setShowCreate(false);setNewChannel(\"\");const chs=await axios.get(\"\".concat(API_URL,\"/channels\"),{headers:{Authorization:\"Bearer \".concat(token)}});setChannels(chs.data);setSelectedChannel(res.data._id);socketRef.current&&socketRef.current.emit(\"join\",res.data._id);// socketRef.current && socketRef.current.emit(\"new-channel\"); // УДАЛЕНО, теперь сервер сам эмитит\n}catch(_unused4){alert(\"Ошибка создания канала\");}};const handleSend=async()=>{if(!input.trim()&&!fileToSend||!selectedChannel)return;const t=parseToken(token);let msg={text:input,sender:t,channel:selectedChannel};if(fileToSend){const formData=new FormData();formData.append(\"file\",fileToSend);const uploadRes=await axios.post(\"\".concat(API_URL,\"/upload\"),formData,{headers:{Authorization:\"Bearer \".concat(token)}});msg.fileUrl=uploadRes.data.url;msg.fileType=uploadRes.data.fileType;msg.originalName=uploadRes.data.originalName;}socketRef.current&&socketRef.current.emit(\"join\",selectedChannel);socketRef.current.emit(\"message\",msg);setInput(\"\");setFileToSend(null);setFilePreviewUrl(null);if(fileInputRefChat.current)fileInputRefChat.current.value=\"\";};// Обработчик регистрации\nconst handleRegister=async e=>{e.preventDefault();setError(\"\");setRegistering(true);if(!recaptchaToken){setError(\"Пожалуйста, подтвердите, что вы не робот\");setRegistering(false);return;}try{await axios.post(\"\".concat(API_URL,\"/register\"),{username,password,recaptcha:recaptchaToken});// После успешной регистрации сразу логинимся (без капчи)\nconst res=await axios.post(\"\".concat(API_URL,\"/login\"),{username,password});localStorage.setItem(\"token\",res.data.token);setToken(res.data.token);}catch(e){var _e$response,_e$response$data;let msg=\"Ошибка регистрации или входа\";if(e!==null&&e!==void 0&&(_e$response=e.response)!==null&&_e$response!==void 0&&(_e$response$data=_e$response.data)!==null&&_e$response$data!==void 0&&_e$response$data.error)msg=e.response.data.error;else if(typeof(e===null||e===void 0?void 0:e.message)===\"string\"&&e.message)msg=e.message;setError(msg);}setRegistering(false);};// Обработчик входа\nconst handleLogin=async e=>{e.preventDefault();setError(\"\");setRegistering(true);// Капча не требуется для входа\ntry{const res=await axios.post(\"\".concat(API_URL,\"/login\"),{username,password});localStorage.setItem(\"token\",res.data.token);setToken(res.data.token);}catch(e){var _e$response2,_e$response2$data;let msg=\"Неверный логин или пароль\";if(e!==null&&e!==void 0&&(_e$response2=e.response)!==null&&_e$response2!==void 0&&(_e$response2$data=_e$response2.data)!==null&&_e$response2$data!==void 0&&_e$response2$data.error)msg=e.response.data.error;else if(typeof(e===null||e===void 0?void 0:e.message)===\"string\"&&e.message)msg=e.message;setError(msg);}setRegistering(false);};// Функция для отправки изменений профиля\nconst handleProfileSave=async()=>{try{const payload={username:editData.username,password:editData.password,city:editData.city,status:editData.status,age:editData.age};Object.keys(payload).forEach(k=>{if(payload[k]===\"\"||payload[k]===null)delete payload[k];});const res=await axios.patch(\"\".concat(API_URL,\"/profile\"),payload,{headers:{Authorization:\"Bearer \".concat(token)}});setUserProfile(res.data);setEditMode(false);if(payload.username&&payload.username!==userProfile.username&&res.data.token){localStorage.setItem(\"token\",res.data.token);setToken(res.data.token);}}catch(e){var _e$response3,_e$response3$data;alert((e===null||e===void 0?void 0:(_e$response3=e.response)===null||_e$response3===void 0?void 0:(_e$response3$data=_e$response3.data)===null||_e$response3$data===void 0?void 0:_e$response3$data.error)||(e===null||e===void 0?void 0:e.message)||\"Ошибка обновления профиля\");}};const handleProfilePopupBgClick=e=>{// Если клик по фону (а не по самому popup), закрываем\nsetShowProfile(false);};useEffect(()=>{if(userProfile){setEditData(d=>_objectSpread({},d));}},[userProfile]);useEffect(()=>{document.title=\"ГоВЧат 2.1 Beta\";// Добавляем/заменяем favicon\nconst faviconId=\"govchat-favicon\";let link=document.querySelector(\"link[rel=\\\"icon\\\"]#\".concat(faviconId));if(!link){link=document.createElement(\"link\");link.rel=\"icon\";link.id=faviconId;document.head.appendChild(link);}// SVG-эмодзи-иконка (например, 🦆)\nlink.type=\"image/svg+xml\";link.href='data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 64 64\"><text y=\"52\" font-size=\"52\">🦆</text></svg>';return()=>{// Не удаляем favicon при размонтировании\n};},[]);// Показывать превью выбранного файла\nuseEffect(()=>{if(fileToSend){if(fileToSend.type.startsWith(\"image/\")||fileToSend.type.startsWith(\"video/\")){const url=URL.createObjectURL(fileToSend);setFilePreviewUrl(url);return()=>URL.revokeObjectURL(url);}else{setFilePreviewUrl(null);}}else{setFilePreviewUrl(null);}},[fileToSend]);// Сохранение выбранной темы в профиль\nconst handleThemeSelect=async t=>{setTheme(t);setShowCustomizer(false);try{await axios.patch(\"\".concat(API_URL,\"/profile\"),{theme:{pageBg:t.pageBg,chatBg:t.chatBg}},{headers:{Authorization:\"Bearer \".concat(token)}});setUserProfile(u=>u?_objectSpread(_objectSpread({},u),{},{theme:{pageBg:t.pageBg,chatBg:t.chatBg}}):u);}catch(_unused5){// ignore\n}};// Применяем тему к стилям\nconst themedPageStyle=_objectSpread(_objectSpread({},chatStyles.page),{},{background:theme.pageBg});const themedChatBoxStyle=_objectSpread(_objectSpread({},chatStyles.chatBox),{},{background:theme.chatBg});// Вставляем адаптивные стили в <head>\nuseEffect(()=>{const styleId=\"govchat-responsive-style\";if(!document.getElementById(styleId)){const style=document.createElement(\"style\");style.id=styleId;style.innerHTML=chatStyles.responsive;document.head.appendChild(style);}},[]);// Для определения мобильного режима\nconst[isMobile,setIsMobile]=useState(window.innerWidth<=700);useEffect(()=>{const onResize=()=>{const mobile=window.innerWidth<=700;setIsMobile(mobile);// Закрываем мобильное меню при переходе на десктоп\nif(!mobile){setMobileMenuOpen(false);}};window.addEventListener(\"resize\",onResize);return()=>window.removeEventListener(\"resize\",onResize);},[]);// Закрытие мобильного меню при клике вне его области\nuseEffect(()=>{const handleClickOutside=e=>{if(mobileMenuOpen&&isMobile){// Проверяем, что клик не по кнопке открытия меню и не внутри самого меню\nconst menuButton=document.querySelector('.govchat-mobile-menu-btn');const menu=document.querySelector('.govchat-mobile-menu');if(menuButton&&!menuButton.contains(e.target)&&menu&&!menu.contains(e.target)){setMobileMenuOpen(false);}}};if(isMobile&&mobileMenuOpen){// Небольшая задержка перед добавлением обработчиков, чтобы не конфликтовать с кликом кнопки\nconst timer=setTimeout(()=>{document.addEventListener('touchstart',handleClickOutside);document.addEventListener('click',handleClickOutside);},100);return()=>{clearTimeout(timer);document.removeEventListener('touchstart',handleClickOutside);document.removeEventListener('click',handleClickOutside);};}},[mobileMenuOpen,isMobile]);// --- Мобильный header ---\nconst mobileHeader=/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.mobileHeader,className:\"govchat-mobile-header\",children:[/*#__PURE__*/_jsx(\"button\",{style:chatStyles.mobileMenuBtn,className:\"govchat-mobile-menu-btn\",onClick:e=>{e.stopPropagation();setMobileMenuOpen(true);},\"aria-label\":\"\\u041C\\u0435\\u043D\\u044E\",children:/*#__PURE__*/_jsx(\"span\",{style:{fontSize:28},children:\"\\u2630\"})}),/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,fontSize:20,color:\"#00c3ff\",letterSpacing:1,textShadow:\"0 2px 8px #0002\",margin:\"0 auto\"},children:\"\\u0413\\u043E\\u0412\\u0427\\u0430\\u0442 2.1 Beta\"})]});// --- Мобильное меню ---\nconst mobileMenu=mobileMenuOpen&&/*#__PURE__*/_jsx(\"div\",{style:chatStyles.mobileMenuOverlay,className:\"govchat-mobile-menu-overlay\",onClick:()=>setMobileMenuOpen(false),children:/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.mobileMenu,className:\"govchat-mobile-menu\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"button\",{style:chatStyles.mobileMenuCloseBtn,onClick:()=>setMobileMenuOpen(false),\"aria-label\":\"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\",children:\"\\u2715\"}),/*#__PURE__*/_jsx(\"div\",{style:chatStyles.mobileMenuTitle,children:\"\\u041A\\u0430\\u043D\\u0430\\u043B\\u044B\"}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.mobileMenuChannels,children:[channels.length===0?/*#__PURE__*/_jsx(\"div\",{style:{color:\"#b2bec3\",marginBottom:8},children:\"\\u041D\\u0435\\u0442 \\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u044B\\u0445 \\u043A\\u0430\\u043D\\u0430\\u043B\\u043E\\u0432\"}):channels.map(ch=>/*#__PURE__*/_jsx(\"div\",{style:chatStyles.channelItem(selectedChannel===ch._id),onClick:e=>{e.stopPropagation();setSelectedChannel(ch._id);setMobileMenuOpen(false);},children:ch.name},ch._id)),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.createBtn,onClick:e=>{e.stopPropagation();setShowCreate(v=>!v);},children:showCreate?\"Скрыть создание\":\"Создать канал\"}),showCreate&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:10},children:[/*#__PURE__*/_jsx(\"input\",{style:chatStyles.input,placeholder:\"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u043A\\u0430\\u043D\\u0430\\u043B\\u0430\",value:newChannel,onChange:e=>setNewChannel(e.target.value),onClick:e=>e.stopPropagation()}),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.createBtn,onClick:e=>{e.stopPropagation();handleCreateChannel();setMobileMenuOpen(false);},children:\"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"govchat-mobile-profile-actions\",style:{display:\"flex\",flexDirection:\"row\",alignItems:\"center\",justifyContent:\"center\",gap:18,margin:\"18px 0 16px 0\"},children:[/*#__PURE__*/_jsx(\"button\",{style:_objectSpread(_objectSpread({},chatStyles.profileBtn),{},{width:48,height:48,fontSize:24,flexDirection:\"column\",alignItems:\"center\",justifyContent:\"center\"}),onClick:e=>{e.stopPropagation();setShowProfile(true);setMobileMenuOpen(false);setEditMode(false);},title:\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\",children:/*#__PURE__*/_jsxs(\"svg\",{width:\"26\",height:\"26\",viewBox:\"0 0 26 26\",fill:\"none\",children:[/*#__PURE__*/_jsx(\"circle\",{cx:\"13\",cy:\"13\",r:\"13\",fill:\"#00c3ff\"}),/*#__PURE__*/_jsx(\"circle\",{cx:\"13\",cy:\"10\",r:\"4\",fill:\"#fff\"}),/*#__PURE__*/_jsx(\"ellipse\",{cx:\"13\",cy:\"19\",rx:\"7\",ry:\"4\",fill:\"#fff\"})]})}),/*#__PURE__*/_jsx(\"button\",{style:_objectSpread(_objectSpread({},chatStyles.profileBtn),{},{width:48,height:48,fontSize:24,flexDirection:\"column\",alignItems:\"center\",justifyContent:\"center\",background:\"none\",border:\"none\",marginRight:0,marginLeft:0,boxShadow:\"0 2px 8px #00c3ff33\"}),onClick:e=>{e.stopPropagation();setShowCustomizer(true);setMobileMenuOpen(false);},title:\"\\u041A\\u0430\\u0441\\u0442\\u043E\\u043C\\u0438\\u0437\\u0430\\u0446\\u0438\\u044F\",children:/*#__PURE__*/_jsxs(\"svg\",{width:\"26\",height:\"26\",viewBox:\"0 0 26 26\",fill:\"none\",children:[/*#__PURE__*/_jsx(\"circle\",{cx:\"13\",cy:\"13\",r:\"13\",fill:\"#ffb347\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M7 19c0-2 2-4 4-4s4 2 4 4\",stroke:\"#fff\",strokeWidth:\"2\"}),/*#__PURE__*/_jsx(\"rect\",{x:\"10\",y:\"6\",width:\"6\",height:\"8\",rx:\"2\",fill:\"#fff\",stroke:\"#ffb347\",strokeWidth:\"1.5\"}),/*#__PURE__*/_jsx(\"rect\",{x:\"8\",y:\"14\",width:\"10\",height:\"4\",rx:\"2\",fill:\"#ffb347\",stroke:\"#fff\",strokeWidth:\"1.5\"})]})})]}),/*#__PURE__*/_jsx(\"div\",{style:chatStyles.mobileMenuFooter})]})});return/*#__PURE__*/_jsxs(\"div\",{style:themedPageStyle,className:\"govchat-page\",children:[isMobile&&mobileHeader,isMobile&&mobileMenu,videoCallNotification&&/*#__PURE__*/_jsx(\"div\",{style:{position:\"fixed\",top:20,right:20,background:\"white\",border:\"1px solid #ddd\",borderRadius:10,boxShadow:\"0 4px 12px rgba(0, 0, 0, 0.15)\",padding:15,maxWidth:350,zIndex:1001,animation:\"slideIn 0.3s ease-out\"},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",flexDirection:\"column\",gap:10},children:[/*#__PURE__*/_jsx(\"div\",{style:{color:\"#007bff\",fontSize:24,alignSelf:\"center\"},children:\"\\uD83D\\uDCF9\"}),/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:\"center\",color:\"#333\"},children:[/*#__PURE__*/_jsx(\"strong\",{children:videoCallNotification.caller}),\" \\u043D\\u0430\\u0447\\u0430\\u043B \\u0432\\u0438\\u0434\\u0435\\u043E\\u0441\\u0435\\u0430\\u043D\\u0441 \\u0432 \\u043A\\u0430\\u043D\\u0430\\u043B\\u0435 \",/*#__PURE__*/_jsxs(\"strong\",{children:[\"#\",videoCallNotification.channel]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:10},children:[/*#__PURE__*/_jsx(\"button\",{style:{flex:1,background:\"#28a745\",color:\"white\",border:\"none\",padding:10,borderRadius:5,cursor:\"pointer\",fontWeight:\"bold\"},onClick:joinVideoCall,onMouseEnter:e=>e.target.style.background=\"#218838\",onMouseLeave:e=>e.target.style.background=\"#28a745\",children:\"\\u041F\\u0440\\u0438\\u0441\\u043E\\u0435\\u0434\\u0438\\u043D\\u0438\\u0442\\u044C\\u0441\\u044F\"}),/*#__PURE__*/_jsx(\"button\",{style:{flex:1,background:\"#6c757d\",color:\"white\",border:\"none\",padding:10,borderRadius:5,cursor:\"pointer\"},onClick:dismissVideoNotification,onMouseEnter:e=>e.target.style.background=\"#5a6268\",onMouseLeave:e=>e.target.style.background=\"#6c757d\",children:\"\\u041E\\u0442\\u043A\\u043B\\u043E\\u043D\\u0438\\u0442\\u044C\"})]})]})}),isVideoCallOpen&&/*#__PURE__*/_jsx(\"div\",{style:{position:\"fixed\",top:0,left:0,right:0,bottom:0,background:\"rgba(0, 0, 0, 0.9)\",zIndex:1000,display:\"flex\",alignItems:\"center\",justifyContent:\"center\"},children:/*#__PURE__*/_jsxs(\"div\",{style:{width:\"95vw\",height:\"90vh\",background:\"#1a1a1a\",borderRadius:10,overflow:\"hidden\",display:\"flex\",flexDirection:\"column\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\",padding:\"1rem\",background:\"#2a2a2a\",color:\"white\"},children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"\\u0412\\u0438\\u0434\\u0435\\u043E\\u0437\\u0432\\u043E\\u043D\\u043E\\u043A #\",selectedChannel]}),/*#__PURE__*/_jsx(\"button\",{style:{background:\"none\",border:\"none\",color:\"white\",fontSize:24,cursor:\"pointer\"},onClick:endVideoCall,children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1,position:\"relative\",background:\"#333\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\"},children:[videoCallParticipants.length>0?/*#__PURE__*/_jsx(\"div\",{style:{display:\"grid\",gridTemplateColumns:videoCallParticipants.length===1?\"1fr\":\"repeat(auto-fit, minmax(300px, 1fr))\",gap:10,width:\"100%\",height:\"100%\",padding:20},children:videoCallParticipants.map(participant=>/*#__PURE__*/_jsxs(\"div\",{style:{position:\"relative\",background:\"#444\",borderRadius:10,overflow:\"hidden\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\",minHeight:200},children:[remoteStreams[participant.id]?/*#__PURE__*/_jsx(\"video\",{ref:el=>{if(el&&remoteStreams[participant.id]){el.srcObject=remoteStreams[participant.id];}},autoPlay:true,style:{width:\"100%\",height:\"100%\",objectFit:\"cover\"}}):/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",flexDirection:\"column\",alignItems:\"center\",justifyContent:\"center\",color:\"#888\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:48,marginBottom:10},children:\"\\uD83D\\uDC64\"}),/*#__PURE__*/_jsx(\"div\",{children:\"\\u041F\\u043E\\u0434\\u043A\\u043B\\u044E\\u0447\\u0430\\u0435\\u0442\\u0441\\u044F...\"})]}),/*#__PURE__*/_jsx(\"span\",{style:{position:\"absolute\",bottom:10,left:10,background:\"rgba(0, 0, 0, 0.7)\",color:\"white\",padding:\"5px 10px\",borderRadius:5,fontSize:14},children:participant.username})]},participant.id))}):/*#__PURE__*/_jsxs(\"div\",{style:{color:\"#888\",fontSize:18,textAlign:\"center\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:48,marginBottom:20},children:\"\\uD83D\\uDCF9\"}),/*#__PURE__*/_jsx(\"div\",{children:\"\\u041E\\u0436\\u0438\\u0434\\u0430\\u043D\\u0438\\u0435 \\u0443\\u0447\\u0430\\u0441\\u0442\\u043D\\u0438\\u043A\\u043E\\u0432...\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:14,marginTop:10},children:\"\\u041F\\u0440\\u0438\\u0433\\u043B\\u0430\\u0441\\u0438\\u0442\\u0435 \\u0434\\u0440\\u0443\\u0433\\u0438\\u0445 \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u0435\\u0439 \\u043F\\u0440\\u0438\\u0441\\u043E\\u0435\\u0434\\u0438\\u043D\\u0438\\u0442\\u044C\\u0441\\u044F \\u043A \\u0432\\u0438\\u0434\\u0435\\u043E\\u0437\\u0432\\u043E\\u043D\\u043A\\u0443\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{position:\"absolute\",top:20,right:20,width:200,height:150,background:\"#222\",borderRadius:10,overflow:\"hidden\",border:\"2px solid #00c3ff\",zIndex:10},children:[/*#__PURE__*/_jsx(\"video\",{ref:localVideoRef,autoPlay:true,muted:true,style:{width:\"100%\",height:\"100%\",objectFit:\"cover\"}}),/*#__PURE__*/_jsx(\"span\",{style:{position:\"absolute\",bottom:5,left:5,background:\"rgba(0, 0, 0, 0.7)\",color:\"white\",padding:\"2px 6px\",borderRadius:3,fontSize:12},children:\"\\u0412\\u044B\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"center\",gap:20,padding:20,background:\"#2a2a2a\"},children:[/*#__PURE__*/_jsx(\"button\",{style:{width:50,height:50,borderRadius:\"50%\",border:\"none\",color:\"white\",fontSize:20,cursor:\"pointer\",background:isMuted?\"#dc3545\":\"#4a4a4a\",transition:\"background-color 0.3s\"},onClick:toggleMute,onMouseEnter:e=>e.target.style.background=isMuted?\"#c82333\":\"#5a5a5a\",onMouseLeave:e=>e.target.style.background=isMuted?\"#dc3545\":\"#4a4a4a\",children:isMuted?\"🔇\":\"🎤\"}),/*#__PURE__*/_jsx(\"button\",{style:{width:50,height:50,borderRadius:\"50%\",border:\"none\",color:\"white\",fontSize:20,cursor:\"pointer\",background:isVideoOff?\"#dc3545\":\"#4a4a4a\",transition:\"background-color 0.3s\"},onClick:toggleVideo,onMouseEnter:e=>e.target.style.background=isVideoOff?\"#c82333\":\"#5a5a5a\",onMouseLeave:e=>e.target.style.background=isVideoOff?\"#dc3545\":\"#4a4a4a\",children:isVideoOff?\"📹\":\"📷\"}),/*#__PURE__*/_jsx(\"button\",{style:{width:50,height:50,borderRadius:\"50%\",border:\"none\",color:\"white\",fontSize:20,cursor:\"pointer\",background:\"#dc3545\",transition:\"background-color 0.3s\"},onClick:endVideoCall,onMouseEnter:e=>e.target.style.background=\"#c82333\",onMouseLeave:e=>e.target.style.background=\"#dc3545\",children:\"\\uD83D\\uDCDE\"})]})]})}),!isMobile&&/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.sidebar,className:\"govchat-sidebar\",children:[/*#__PURE__*/_jsx(\"div\",{style:chatStyles.sidebarTitle,children:\"\\u0413\\u043E\\u0412\\u0427\\u0430\\u0442 2.1 Beta\"}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.channelList,className:\"govchat-channel-list\",children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:600,color:\"#fff\",marginBottom:10},children:\"\\u041A\\u0430\\u043D\\u0430\\u043B\\u044B\"}),channels.length===0?/*#__PURE__*/_jsx(\"div\",{style:{color:\"#b2bec3\",marginBottom:8},children:\"\\u041D\\u0435\\u0442 \\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u044B\\u0445 \\u043A\\u0430\\u043D\\u0430\\u043B\\u043E\\u0432\"}):/*#__PURE__*/_jsx(_Fragment,{children:channels.map(ch=>/*#__PURE__*/_jsx(\"div\",{style:chatStyles.channelItem(selectedChannel===ch._id),onClick:()=>setSelectedChannel(ch._id),children:ch.name},ch._id))}),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.createBtn,onClick:()=>setShowCreate(v=>!v),children:showCreate?\"Скрыть создание\":\"Создать канал\"}),showCreate&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:10},children:[/*#__PURE__*/_jsx(\"input\",{style:chatStyles.input,placeholder:\"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u043A\\u0430\\u043D\\u0430\\u043B\\u0430\",value:newChannel,onChange:e=>setNewChannel(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.createBtn,onClick:handleCreateChannel,children:\"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:_objectSpread(_objectSpread({},chatStyles.profileBtnBox),{},{left:\"auto\",right:178,bottom:70,display:\"flex\",flexDirection:\"row\",alignItems:\"center\",gap:10,zIndex:10}),children:[/*#__PURE__*/_jsx(\"button\",{style:chatStyles.profileBtn,onClick:()=>{setShowProfile(v=>!v);setEditMode(false);},title:\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\",children:/*#__PURE__*/_jsxs(\"svg\",{width:\"26\",height:\"26\",viewBox:\"0 0 26 26\",fill:\"none\",children:[/*#__PURE__*/_jsx(\"circle\",{cx:\"13\",cy:\"13\",r:\"13\",fill:\"#00c3ff\"}),/*#__PURE__*/_jsx(\"circle\",{cx:\"13\",cy:\"10\",r:\"4\",fill:\"#fff\"}),/*#__PURE__*/_jsx(\"ellipse\",{cx:\"13\",cy:\"19\",rx:\"7\",ry:\"4\",fill:\"#fff\"})]})}),/*#__PURE__*/_jsx(\"button\",{style:_objectSpread(_objectSpread({},chatStyles.profileBtn),{},{background:\"none\",border:\"none\",marginRight:0,marginLeft:0,boxShadow:\"0 2px 8px #00c3ff33\"}),onClick:()=>setShowCustomizer(v=>!v),title:\"\\u041A\\u0430\\u0441\\u0442\\u043E\\u043C\\u0438\\u0437\\u0430\\u0446\\u0438\\u044F\",children:/*#__PURE__*/_jsxs(\"svg\",{width:\"26\",height:\"26\",viewBox:\"0 0 26 26\",fill:\"none\",children:[/*#__PURE__*/_jsx(\"circle\",{cx:\"13\",cy:\"13\",r:\"13\",fill:\"#ffb347\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M7 19c0-2 2-4 4-4s4 2 4 4\",stroke:\"#fff\",strokeWidth:\"2\"}),/*#__PURE__*/_jsx(\"rect\",{x:\"10\",y:\"6\",width:\"6\",height:\"8\",rx:\"2\",fill:\"#fff\",stroke:\"#ffb347\",strokeWidth:\"1.5\"}),/*#__PURE__*/_jsx(\"rect\",{x:\"8\",y:\"14\",width:\"10\",height:\"4\",rx:\"2\",fill:\"#ffb347\",stroke:\"#fff\",strokeWidth:\"1.5\"})]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:_objectSpread(_objectSpread({},chatStyles.chatContainer),isMobile?{paddingTop:40,height:\"calc(100vh - 40px)\",maxHeight:\"calc(100vh - 40px)\"}:{}),className:\"govchat-chat-container\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",alignItems:\"center\",justifyContent:\"center\",width:\"100%\",marginBottom:10,minHeight:32,marginTop:isMobile?18:0,position:\"relative\"},children:[/*#__PURE__*/_jsx(\"div\",{style:chatStyles.chatTitle,children:\"\\u0427\\u0430\\u0442\"}),selectedChannel&&/*#__PURE__*/_jsx(\"button\",{style:{position:\"absolute\",right:isMobile?16:0,background:\"#007bff\",color:\"white\",border:\"none\",borderRadius:\"50%\",width:40,height:40,display:\"flex\",alignItems:\"center\",justifyContent:\"center\",cursor:\"pointer\",transition:\"background-color 0.3s\",fontSize:16,boxShadow:\"0 2px 8px rgba(0, 123, 255, 0.3)\"},onClick:startVideoCall,title:\"\\u041D\\u0430\\u0447\\u0430\\u0442\\u044C \\u0432\\u0438\\u0434\\u0435\\u043E\\u0437\\u0432\\u043E\\u043D\\u043E\\u043A\",onMouseEnter:e=>e.target.style.background=\"#0056b3\",onMouseLeave:e=>e.target.style.background=\"#007bff\",children:\"\\uD83D\\uDCF9\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"govchat-chat-box\",style:themedChatBoxStyle,children:[messages.map(msg=>{const isMine=msg.sender===username;// Формат времени\nconst time=msg.createdAt?new Date(msg.createdAt).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'}):'';return/*#__PURE__*/_jsx(\"div\",{style:chatStyles.messageRow(isMine),children:/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.message(isMine),children:[!isMine&&/*#__PURE__*/_jsxs(\"span\",{style:chatStyles.messageSender,children:[msg.sender,\":\"]}),msg.text,msg.fileUrl&&msg.fileType&&/*#__PURE__*/_jsx(\"span\",{style:{display:\"block\",marginTop:8},children:msg.fileType.startsWith(\"audio/\")?/*#__PURE__*/_jsx(\"audio\",{src:msg.fileUrl,controls:true,style:{maxWidth:220,borderRadius:8,background:\"#232526\"}}):msg.fileType.startsWith(\"image/\")?/*#__PURE__*/_jsx(\"img\",{src:msg.fileUrl,alt:msg.originalName||\"image\",style:{maxWidth:120,maxHeight:120,borderRadius:8,cursor:\"pointer\",boxShadow:\"0 2px 8px #00c3ff33\"},onClick:()=>setModalMedia({type:\"image\",url:msg.fileUrl,name:msg.originalName})}):msg.fileType.startsWith(\"video/\")?/*#__PURE__*/_jsx(\"video\",{src:msg.fileUrl,controls:false,style:{maxWidth:120,maxHeight:120,borderRadius:8,cursor:\"pointer\",boxShadow:\"0 2px 8px #00c3ff33\"},onClick:()=>setModalMedia({type:\"video\",url:msg.fileUrl,name:msg.originalName}),children:\"\\u0412\\u0430\\u0448 \\u0431\\u0440\\u0430\\u0443\\u0437\\u0435\\u0440 \\u043D\\u0435 \\u043F\\u043E\\u0434\\u0434\\u0435\\u0440\\u0436\\u0438\\u0432\\u0430\\u0435\\u0442 \\u0432\\u0438\\u0434\\u0435\\u043E.\"}):/*#__PURE__*/// Превью для документов\n_jsxs(\"span\",{style:{display:\"flex\",alignItems:\"center\",gap:8,cursor:\"pointer\",background:\"#232526\",borderRadius:8,padding:\"8px 12px\",boxShadow:\"0 2px 8px #00c3ff22\",maxWidth:220,minWidth:0,color:\"#fff\"},onClick:()=>{// Определяем тип документа для предпросмотра\nconst ext=(msg.originalName||\"\").split('.').pop().toLowerCase();if(msg.fileType===\"application/pdf\"){setModalMedia({type:\"pdf\",url:msg.fileUrl,name:msg.originalName});}else{setModalMedia({type:\"doc\",url:msg.fileUrl,name:msg.originalName,ext});}},title:msg.originalName,children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:28},children:(()=>{const ext=(msg.originalName||\"\").split('.').pop().toLowerCase();if(ext===\"pdf\")return\"📄\";if([\"doc\",\"docx\"].includes(ext))return\"📝\";if([\"xls\",\"xlsx\"].includes(ext))return\"📊\";if([\"ppt\",\"pptx\"].includes(ext))return\"📈\";if([\"txt\",\"rtf\"].includes(ext))return\"📃\";return\"📁\";})()}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:14,color:\"#fff\",wordBreak:\"break-all\",flex:1,minWidth:0},children:msg.originalName})]})}),/*#__PURE__*/_jsx(\"div\",{style:{color:\"#b2bec3\",fontSize:11,marginTop:4,textAlign:isMine?\"right\":\"left\"},children:time})]})},msg._id);}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsx(\"div\",{style:{minHeight:22,display:\"flex\",alignItems:\"flex-end\",marginBottom:2},children:typing&&/*#__PURE__*/_jsx(\"div\",{style:_objectSpread(_objectSpread({},chatStyles.typing),{},{margin:0,paddingLeft:8,paddingRight:8,background:\"none\",borderRadius:0,position:\"relative\",zIndex:2,width:\"fit-content\",maxWidth:\"80%\",alignSelf:\"flex-start\",boxShadow:\"none\"}),children:typing})}),fileToSend&&/*#__PURE__*/_jsxs(\"div\",{style:_objectSpread(_objectSpread({},isMobile?{position:\"fixed\",left:0,right:0,bottom:58,zIndex:1002,background:\"#35363a\",borderRadius:\"12px 12px 0 0\",padding:\"6px 8px 6px 8px\",// уменьшили паддинги\nmaxWidth:\"100vw\",width:\"100vw\",display:\"flex\",alignItems:\"center\",gap:10,// уменьшили gap\nboxShadow:\"0 -2px 12px #0005\",justifyContent:\"flex-start\",minHeight:44// уменьшили высоту\n}:{margin:\"0 0 8px 0\",padding:\"6px 10px\",background:\"#35363a\",borderRadius:8,display:\"flex\",alignItems:\"center\",gap:10,maxWidth:320}),{},{position:isMobile?\"fixed\":undefined}),children:[isMobile&&/*#__PURE__*/_jsx(\"button\",{style:{position:\"absolute\",left:8,top:\"50%\",transform:\"translateY(-50%)\",background:\"none\",border:\"none\",color:\"#ff7675\",fontWeight:700,fontSize:22,cursor:\"pointer\",padding:0,zIndex:2},title:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u0444\\u0430\\u0439\\u043B\",onClick:()=>{setFileToSend(null);setFilePreviewUrl(null);if(fileInputRefChat.current)fileInputRefChat.current.value=\"\";},children:\"\\u2715\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",alignItems:\"center\",gap:10,width:\"100%\",marginLeft:isMobile?36:0// отступ под крестик\n},children:[fileToSend.type.startsWith(\"image/\")&&filePreviewUrl&&/*#__PURE__*/_jsx(\"img\",{src:filePreviewUrl,alt:\"preview\",style:{maxWidth:isMobile?56:48,// уменьшили размер\nmaxHeight:isMobile?56:48,borderRadius:8,objectFit:\"cover\"}}),fileToSend.type.startsWith(\"video/\")&&filePreviewUrl&&/*#__PURE__*/_jsx(\"video\",{src:filePreviewUrl,style:{maxWidth:isMobile?56:48,maxHeight:isMobile?56:48,borderRadius:8,objectFit:\"cover\"},controls:true}),!fileToSend.type.startsWith(\"image/\")&&!fileToSend.type.startsWith(\"video/\")&&/*#__PURE__*/_jsx(\"span\",{role:\"img\",\"aria-label\":\"file\",style:{fontSize:isMobile?26:22},children:\"\\uD83D\\uDCCE\"}),/*#__PURE__*/_jsx(\"span\",{style:{color:\"#fff\",fontSize:isMobile?14:14,wordBreak:\"break-all\",flex:1,minWidth:0},children:fileToSend.name}),!isMobile&&/*#__PURE__*/_jsx(\"button\",{style:{marginLeft:\"auto\",background:\"none\",border:\"none\",color:\"#ff7675\",fontWeight:700,fontSize:16,cursor:\"pointer\",padding:0},title:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u0444\\u0430\\u0439\\u043B\",onClick:()=>{setFileToSend(null);setFilePreviewUrl(null);if(fileInputRefChat.current)fileInputRefChat.current.value=\"\";},children:\"\\u2715\"})]})]}),audioBlob&&audioUrl&&(isMobile?/*#__PURE__*/_jsxs(\"div\",{style:{position:\"fixed\",left:0,right:0,bottom:58,// чуть выше inputRow (учитываем высоту inputRow)\nzIndex:1001,background:\"#35363a\",borderRadius:\"12px 12px 0 0\",padding:\"10px 12px 10px 12px\",maxWidth:\"100vw\",width:\"100vw\",display:\"flex\",alignItems:\"center\",gap:10,boxShadow:\"0 -2px 12px #0005\",justifyContent:\"center\",minHeight:48},children:[/*#__PURE__*/_jsx(\"audio\",{src:audioUrl,controls:true,style:{height:28,maxWidth:180,borderRadius:8,background:\"#232526\"}}),/*#__PURE__*/_jsx(\"button\",{style:{background:\"#ff7675\",color:\"#fff\",border:\"none\",borderRadius:8,padding:\"6px 12px\",fontWeight:600,fontSize:15,cursor:\"pointer\",marginLeft:4},onClick:sendAudioMessage,title:\"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C \\u0433\\u043E\\u043B\\u043E\\u0441\\u043E\\u0432\\u043E\\u0435\",children:\"\\u27A4\"}),/*#__PURE__*/_jsx(\"button\",{style:{background:\"none\",color:\"#ff7675\",border:\"none\",fontWeight:700,fontSize:20,cursor:\"pointer\"},title:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u0437\\u0430\\u043F\\u0438\\u0441\\u044C\",onClick:()=>{setAudioBlob(null);setAudioUrl(null);},children:\"\\u2715\"})]}):/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",alignItems:\"center\",gap:8,margin:\"8px 0 0 0\",background:\"#35363a\",borderRadius:8,padding:\"8px 16px\",maxWidth:420},children:[/*#__PURE__*/_jsx(\"audio\",{src:audioUrl,controls:true,style:{height:32,maxWidth:220,borderRadius:8}}),/*#__PURE__*/_jsx(\"button\",{style:{background:\"#ff7675\",color:\"#fff\",border:\"none\",borderRadius:8,padding:\"6px 14px\",fontWeight:600,fontSize:15,cursor:\"pointer\",marginLeft:4},onClick:sendAudioMessage,title:\"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C \\u0433\\u043E\\u043B\\u043E\\u0441\\u043E\\u0432\\u043E\\u0435\",children:\"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{style:{background:\"none\",color:\"#ff7675\",border:\"none\",fontWeight:700,fontSize:18,cursor:\"pointer\"},title:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u0437\\u0430\\u043F\\u0438\\u0441\\u044C\",onClick:()=>{setAudioBlob(null);setAudioUrl(null);},children:\"\\u2715\"})]})),/*#__PURE__*/_jsxs(\"div\",{style:_objectSpread(_objectSpread({},chatStyles.inputRow),isMobile?{padding:\"6px 2vw 6px 2vw\"}:{}),className:\"govchat-input-row\",children:[/*#__PURE__*/_jsx(\"button\",{style:_objectSpread(_objectSpread({},attachBtnHover?_objectSpread(_objectSpread({},chatStyles.attachBtn),chatStyles.attachBtnHover):chatStyles.attachBtn),isMobile?{width:34,height:34,minWidth:34,minHeight:34,fontSize:18,marginRight:2}:{}),type:\"button\",onClick:()=>fileInputRefChat.current&&fileInputRefChat.current.click(),title:\"\\u041F\\u0440\\u0438\\u043A\\u0440\\u0435\\u043F\\u0438\\u0442\\u044C \\u0444\\u0430\\u0439\\u043B\",tabIndex:-1,onMouseEnter:()=>setAttachBtnHover(true),onMouseLeave:()=>setAttachBtnHover(false),disabled:false,children:/*#__PURE__*/_jsx(\"span\",{style:{color:\"#222\",fontSize:isMobile?18:22,display:\"flex\",alignItems:\"center\"},children:\"\\uD83D\\uDCCE\"})}),/*#__PURE__*/_jsx(\"input\",{ref:fileInputRefChat,type:\"file\",style:{display:\"none\"},onChange:e=>{var _e$target$files;if((_e$target$files=e.target.files)!==null&&_e$target$files!==void 0&&_e$target$files[0])setFileToSend(e.target.files[0]);}}),/*#__PURE__*/_jsx(\"button\",{style:_objectSpread(_objectSpread({},chatStyles.attachBtn),{},{background:recording?\"#ff7675\":\"#fff\",color:recording?\"#fff\":\"#222\",marginRight:2,marginLeft:0,border:recording?\"2px solid #ff7675\":\"none\"},isMobile?{width:34,height:34,minWidth:34,minHeight:34,fontSize:18}:{}),type:\"button\",onClick:()=>{if(!recording)startRecording();else stopRecording();},title:recording?\"Остановить запись\":\"Записать голосовое\",disabled:fileToSend||audioBlob,children:recording?/*#__PURE__*/_jsx(\"span\",{style:{color:\"#fff\",fontSize:isMobile?18:22,display:\"flex\",alignItems:\"center\"},children:\"\\u23FA\"}):/*#__PURE__*/_jsx(\"span\",{style:{color:\"#222\",fontSize:isMobile?18:22,display:\"flex\",alignItems:\"center\"},children:\"\\uD83C\\uDFA4\"})}),recording&&/*#__PURE__*/_jsx(\"span\",{style:{color:\"#ff7675\",fontWeight:600,minWidth:isMobile?28:40,fontSize:isMobile?13:16},children:\"\".concat(Math.floor(recordTime/60).toString().padStart(2,\"0\"),\":\").concat((recordTime%60).toString().padStart(2,\"0\"))}),/*#__PURE__*/_jsx(\"input\",{style:_objectSpread(_objectSpread({},chatStyles.input),isMobile?{fontSize:14,padding:\"8px 10px\"}:{}),value:input,onChange:e=>setInput(e.target.value),onKeyDown:e=>{if(selectedChannel){socketRef.current.emit(\"typing\",{channel:selectedChannel});if(e.key===\"Enter\")handleSend();}},disabled:!selectedChannel,placeholder:selectedChannel?\"Введите сообщение...\":\"Выберите канал\"}),/*#__PURE__*/_jsx(\"button\",{style:_objectSpread({},isMobile?{background:\"linear-gradient(90deg,#00c3ff,#3a7bd5)\",color:\"#fff\",border:\"none\",borderRadius:8,width:34,height:34,minWidth:34,minHeight:34,padding:0,fontSize:18,display:\"flex\",alignItems:\"center\",justifyContent:\"center\",boxShadow:\"0 2px 8px #00c3ff33\",marginLeft:2}:chatStyles.sendBtn),onClick:handleSend,disabled:!selectedChannel||!input.trim()&&!fileToSend,title:\"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\",children:isMobile?/*#__PURE__*/_jsx(\"span\",{style:{fontSize:18,color:\"#fff\"},children:\"\\u27A4\"}):\"Отправить\"})]}),modalMedia&&/*#__PURE__*/_jsx(\"div\",{style:{position:\"fixed\",left:0,top:0,width:\"100vw\",height:\"100vh\",background:\"rgba(0,0,0,0.7)\",zIndex:9999,display:\"flex\",alignItems:\"center\",justifyContent:\"center\"},onClick:()=>setModalMedia(null),children:/*#__PURE__*/_jsxs(\"div\",{style:{background:\"#232526\",borderRadius:12,padding:24,maxWidth:\"90vw\",maxHeight:\"90vh\",boxShadow:\"0 4px 32px #000a\",display:\"flex\",flexDirection:\"column\",alignItems:\"center\",position:\"relative\"},onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"button\",{style:{position:\"absolute\",top:8,right:12,background:\"none\",border:\"none\",color:\"#fff\",fontSize:28,fontWeight:700,cursor:\"pointer\",zIndex:2},onClick:()=>setModalMedia(null),title:\"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\",children:\"\\u2715\"}),modalMedia.type===\"image\"?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"img\",{src:modalMedia.url,alt:modalMedia.name,style:{maxWidth:\"70vw\",maxHeight:\"70vh\",borderRadius:10,marginBottom:16}}),modalMedia.name&&/*#__PURE__*/_jsx(\"div\",{style:{color:\"#fff\",fontSize:16,marginBottom:16,wordBreak:\"break-all\",textAlign:\"center\",maxWidth:\"60vw\"},children:modalMedia.name})]}):modalMedia.type===\"video\"?/*#__PURE__*/_jsx(\"video\",{src:modalMedia.url,controls:true,autoPlay:true,style:{maxWidth:\"70vw\",maxHeight:\"70vh\",borderRadius:10,marginBottom:16,background:\"#000\"}}):modalMedia.type===\"pdf\"?/*#__PURE__*/_jsx(\"iframe\",{src:modalMedia.url,title:modalMedia.name,style:{width:\"70vw\",height:\"70vh\",border:\"none\",borderRadius:10,background:\"#fff\",marginBottom:16}}):modalMedia.type===\"doc\"?/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",flexDirection:\"column\",alignItems:\"center\",justifyContent:\"center\",minHeight:200,minWidth:200,marginBottom:16},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:64,marginBottom:16},children:(()=>{const ext=(modalMedia.ext||\"\").toLowerCase();if(ext===\"pdf\")return\"📄\";if([\"doc\",\"docx\"].includes(ext))return\"📝\";if([\"xls\",\"xlsx\"].includes(ext))return\"📊\";if([\"ppt\",\"pptx\"].includes(ext))return\"📈\";if([\"txt\",\"rtf\"].includes(ext))return\"📃\";return\"📁\";})()}),/*#__PURE__*/_jsx(\"div\",{style:{color:\"#fff\",fontSize:18,marginBottom:8,wordBreak:\"break-all\",textAlign:\"center\"},children:modalMedia.name}),/*#__PURE__*/_jsx(\"div\",{style:{color:\"#b2bec3\",fontSize:15,marginBottom:18},children:\"\\u041F\\u0440\\u0435\\u0434\\u043F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440 \\u043D\\u0435\\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u0435\\u043D \\u0434\\u043B\\u044F \\u044D\\u0442\\u043E\\u0433\\u043E \\u0442\\u0438\\u043F\\u0430 \\u0444\\u0430\\u0439\\u043B\\u0430\"})]}):null,/*#__PURE__*/_jsx(\"button\",{style:{background:\"linear-gradient(90deg,#00c3ff,#3a7bd5)\",color:\"#fff\",border:\"none\",borderRadius:8,padding:\"10px 22px\",fontWeight:600,fontSize:15,cursor:\"pointer\",boxShadow:\"0 2px 8px #00c3ff33\",textDecoration:\"none\"},onClick:async e=>{e.stopPropagation();try{const response=await fetch(modalMedia.url,{credentials:\"same-origin\"});const blob=await response.blob();const url=window.URL.createObjectURL(blob);const a=document.createElement(\"a\");a.href=url;a.download=modalMedia.name||\"file\";document.body.appendChild(a);a.click();setTimeout(()=>{window.URL.revokeObjectURL(url);a.remove();},200);}catch(err){alert(\"Ошибка скачивания файла\");}},children:\"\\u0421\\u043A\\u0430\\u0447\\u0430\\u0442\\u044C\"})]})})]}),showProfile&&/*#__PURE__*/_jsx(\"div\",{style:{position:\"fixed\",left:0,top:0,width:\"100vw\",height:\"100vh\",background:\"rgba(0,0,0,0.12)\",zIndex:99,transition:\"background 0.2s\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\"},onClick:handleProfilePopupBgClick,children:/*#__PURE__*/_jsxs(\"div\",{style:_objectSpread(_objectSpread(_objectSpread({},chatStyles.profilePopup),isMobile?{position:\"fixed\",left:\"50%\",top:\"50%\",transform:\"translate(-50%, -50%)\",width:\"92vw\",maxWidth:340,minWidth:0,height:\"auto\",maxHeight:\"72vh\",minHeight:240,borderRadius:18,padding:\"14px 8px 8px 8px\",boxShadow:\"0 2px 16px #00c3ff33\",fontSize:15,display:\"flex\",flexDirection:\"column\",alignItems:\"center\",justifyContent:\"flex-start\"}:{transform:showProfile?\"translateY(0)\":\"translateY(120%)\",opacity:showProfile?1:0,pointerEvents:showProfile?\"auto\":\"none\"}),{},{transition:\"transform 0.32s cubic-bezier(.4,1.4,.6,1), opacity 0.22s\"}),className:\"govchat-profile-popup\",onClick:e=>e.stopPropagation(),children:[isMobile&&/*#__PURE__*/_jsxs(\"div\",{style:{position:\"sticky\",top:0,left:0,width:\"100%\",background:\"#232526\",zIndex:2,display:\"flex\",alignItems:\"center\",justifyContent:\"center\",padding:\"0 4px 0 0\",minHeight:36,marginBottom:8},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,fontSize:17,color:\"#00c3ff\",flex:1,textAlign:\"center\"},children:\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{style:_objectSpread(_objectSpread({},chatStyles.profileCloseBtn),{},{position:\"static\",right:0,top:0,width:32,height:32,fontSize:22,marginRight:4,marginTop:0,marginBottom:0,background:\"none\",color:\"#b2bec3\",boxShadow:\"none\"}),onClick:()=>setShowProfile(false),title:\"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\",children:\"\\u2715\"})]}),/*#__PURE__*/_jsx(\"div\",{style:_objectSpread(_objectSpread({},chatStyles.profileAvatar),isMobile?{width:70,height:70,margin:\"8px auto 8px auto\",fontSize:36}:{}),className:\"govchat-profile-avatar\",children:/*#__PURE__*/_jsxs(\"div\",{style:{position:\"relative\",width:isMobile?70:90,height:isMobile?70:90,borderRadius:\"50%\",overflow:\"hidden\",cursor:\"pointer\",border:\"2px solid #00c3ff\",margin:\"0 auto\",background:\"#35363a\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\"},onClick:()=>fileInputRefAvatar.current&&fileInputRefAvatar.current.click(),title:\"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C \\u0444\\u043E\\u0442\\u043E\",children:[userProfile!==null&&userProfile!==void 0&&userProfile.avatarUrl&&userProfile.avatarUrl!==\"/uploads/avatar-default.png\"?/*#__PURE__*/_jsx(\"img\",{src:userProfile.avatarUrl?userProfile.avatarUrl+\"?t=\"+avatarVersion:\"/uploads/avatar-default.png\",alt:\"avatar\",style:{width:isMobile?70:90,height:isMobile?70:90,borderRadius:\"50%\",objectFit:\"cover\",display:\"block\"},onError:e=>{e.target.onerror=null;e.target.src=\"\".concat(window.location.protocol,\"//\").concat(window.location.hostname,\":5000/uploads/avatar-default.png\");}},userProfile.avatarUrl+avatarVersion):/*#__PURE__*/// Показываем дефолтную картинку, если нет пользовательской\n_jsx(\"img\",{src:\"/uploads/avatar-default.png\",alt:\"avatar\",style:{width:isMobile?70:90,height:isMobile?70:90,borderRadius:\"50%\",objectFit:\"cover\",display:\"block\"},onError:e=>{e.target.onerror=null;e.target.src=\"https://ui-avatars.com/api/?name=\"+encodeURIComponent((userProfile===null||userProfile===void 0?void 0:userProfile.username)||\"U\")+\"&background=00c3ff&color=fff&size=90\";}}),/*#__PURE__*/_jsx(\"input\",{ref:fileInputRefAvatar,type:\"file\",accept:\"image/*\",style:{display:\"none\"},onChange:async e=>{var _e$target$files2;if(!((_e$target$files2=e.target.files)!==null&&_e$target$files2!==void 0&&_e$target$files2[0]))return;const formData=new FormData();formData.append(\"file\",e.target.files[0]);const uploadRes=await axios.post(\"\".concat(API_URL,\"/upload?avatar=1\"),formData,{headers:{Authorization:\"Bearer \".concat(token)}});await axios.patch(\"\".concat(API_URL,\"/profile\"),{avatarUrl:uploadRes.data.url},{headers:{Authorization:\"Bearer \".concat(token)}});const profileRes=await axios.get(\"\".concat(API_URL,\"/profile\"),{headers:{Authorization:\"Bearer \".concat(token)}});setUserProfile(profileRes.data);setAvatarVersion(Date.now());}})]})}),/*#__PURE__*/_jsxs(\"div\",{style:_objectSpread({flex:1,overflowY:\"auto\",minHeight:0,marginBottom:10,display:\"flex\",flexDirection:\"column\",justifyContent:\"flex-start\"},isMobile?{padding:\"0 4px\"}:{}),children:[userProfile&&!editMode&&/*#__PURE__*/_jsxs(_Fragment,{children:[!isMobile&&/*#__PURE__*/_jsx(\"div\",{style:chatStyles.profileTitle,className:\"govchat-profile-title\",children:\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\"}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u041D\\u0438\\u043A:\"}),\" \",userProfile.username]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u0412\\u043E\\u0437\\u0440\\u0430\\u0441\\u0442:\"}),\" \",(_userProfile$age=userProfile.age)!==null&&_userProfile$age!==void 0?_userProfile$age:\"—\"]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u0413\\u043E\\u0440\\u043E\\u0434:\"}),\" \",(_userProfile$city=userProfile.city)!==null&&_userProfile$city!==void 0?_userProfile$city:\"—\"]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u0421\\u0435\\u043C\\u0435\\u0439\\u043D\\u044B\\u0439 \\u0441\\u0442\\u0430\\u0442\\u0443\\u0441:\"}),\" \",(_userProfile$status=userProfile.status)!==null&&_userProfile$status!==void 0?_userProfile$status:\"—\"]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:8,marginTop:18,justifyContent:\"flex-end\",flexWrap:isMobile?\"wrap\":\"nowrap\"},children:[/*#__PURE__*/_jsx(\"button\",{style:_objectSpread(_objectSpread({},chatStyles.profileEditBtn),isMobile?{fontSize:14,padding:\"7px 12px\"}:{}),onClick:()=>{setEditData({username:userProfile.username||\"\",password:\"\",city:userProfile.city||\"\",status:userProfile.status||\"\",age:userProfile.age||\"\"});setEditMode(true);},children:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{style:_objectSpread(_objectSpread({},chatStyles.profileLogoutBtn),isMobile?{fontSize:14,padding:\"7px 12px\"}:{}),onClick:()=>{localStorage.removeItem(\"token\");window.location.reload();},children:\"\\u0412\\u044B\\u0439\\u0442\\u0438\"})]})]}),userProfile&&editMode&&/*#__PURE__*/_jsxs(_Fragment,{children:[!isMobile&&/*#__PURE__*/_jsx(\"div\",{style:chatStyles.profileTitle,children:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435 \\u043F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044F\"}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u041D\\u0438\\u043A:\"}),/*#__PURE__*/_jsx(\"input\",{style:_objectSpread(_objectSpread({},chatStyles.profileInput),isMobile?{fontSize:14,padding:\"6px 8px\"}:{}),value:editData.username,onChange:e=>setEditData(d=>_objectSpread(_objectSpread({},d),{},{username:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C:\"}),/*#__PURE__*/_jsx(\"input\",{style:_objectSpread(_objectSpread({},chatStyles.profileInput),isMobile?{fontSize:14,padding:\"6px 8px\"}:{}),type:\"password\",value:editData.password,placeholder:\"\\u041D\\u043E\\u0432\\u044B\\u0439 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\",onChange:e=>setEditData(d=>_objectSpread(_objectSpread({},d),{},{password:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u0412\\u043E\\u0437\\u0440\\u0430\\u0441\\u0442:\"}),/*#__PURE__*/_jsx(\"input\",{style:_objectSpread(_objectSpread({},chatStyles.profileInput),isMobile?{fontSize:14,padding:\"6px 8px\"}:{}),type:\"number\",min:0,value:editData.age,onChange:e=>setEditData(d=>_objectSpread(_objectSpread({},d),{},{age:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u0413\\u043E\\u0440\\u043E\\u0434:\"}),/*#__PURE__*/_jsx(\"input\",{style:_objectSpread(_objectSpread({},chatStyles.profileInput),isMobile?{fontSize:14,padding:\"6px 8px\"}:{}),value:editData.city,onChange:e=>setEditData(d=>_objectSpread(_objectSpread({},d),{},{city:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u0421\\u0435\\u043C\\u0435\\u0439\\u043D\\u044B\\u0439 \\u0441\\u0442\\u0430\\u0442\\u0443\\u0441:\"}),/*#__PURE__*/_jsx(\"input\",{style:_objectSpread(_objectSpread({},chatStyles.profileInput),isMobile?{fontSize:14,padding:\"6px 8px\"}:{}),value:editData.status,onChange:e=>setEditData(d=>_objectSpread(_objectSpread({},d),{},{status:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:8,marginTop:10,justifyContent:\"flex-end\",flexWrap:isMobile?\"wrap\":\"nowrap\"},children:[/*#__PURE__*/_jsx(\"button\",{style:_objectSpread(_objectSpread({},chatStyles.profileEditBtn),isMobile?{fontSize:14,padding:\"7px 12px\"}:{}),onClick:handleProfileSave,children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{style:_objectSpread(_objectSpread({},chatStyles.profileCloseBtn),{},{position:\"static\",width:\"auto\",height:\"auto\",fontSize:isMobile?14:15,marginLeft:0,marginTop:0,marginBottom:0,background:\"#35363a\",color:\"#b2bec3\",boxShadow:\"0 2px 8px #0002\"},isMobile?{padding:\"7px 12px\"}:{}),onClick:()=>setEditMode(false),children:\"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\"})]})]}),!userProfile&&/*#__PURE__*/_jsx(\"div\",{style:{color:\"#b2bec3\",marginBottom:8},children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"})]})]})}),showCustomizer&&/*#__PURE__*/_jsx(\"div\",{style:{position:\"fixed\",left:0,top:0,width:\"100vw\",height:\"100vh\",background:\"rgba(0,0,0,0.12)\",zIndex:120,display:\"flex\",alignItems:\"center\",justifyContent:\"center\"},onClick:()=>setShowCustomizer(false),children:/*#__PURE__*/_jsxs(\"div\",{style:{background:\"#232526\",borderRadius:16,boxShadow:\"0 2px 16px #00c3ff33\",padding:\"32px 32px 24px 32px\",minWidth:320,maxWidth:420,zIndex:121,display:\"flex\",flexDirection:\"column\",alignItems:\"center\",position:\"relative\"},onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"button\",{style:{position:\"absolute\",top:10,right:16,background:\"none\",color:\"#b2bec3\",border:\"none\",borderRadius:\"50%\",width:32,height:32,fontSize:22,fontWeight:700,cursor:\"pointer\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\",transition:\"background 0.2s, color 0.2s\",zIndex:122},onClick:()=>setShowCustomizer(false),title:\"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\",children:\"\\u2715\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,fontSize:20,color:\"#ffb347\",marginBottom:18},children:\"\\u041A\\u0430\\u0441\\u0442\\u043E\\u043C\\u0438\\u0437\\u0430\\u0446\\u0438\\u044F \\u043E\\u0444\\u043E\\u0440\\u043C\\u043B\\u0435\\u043D\\u0438\\u044F\"}),/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",flexDirection:\"column\",gap:18,width:\"100%\"},children:chatStyles.themes.map((t,idx)=>/*#__PURE__*/_jsxs(\"button\",{style:{display:\"flex\",alignItems:\"center\",gap:16,width:\"100%\",background:t.pageBg,border:theme.name===t.name?\"2px solid #00c3ff\":\"2px solid transparent\",borderRadius:10,padding:\"12px 18px\",cursor:\"pointer\",color:\"#222\",fontWeight:600,fontSize:16,boxShadow:theme.name===t.name?\"0 2px 12px #00c3ff44\":\"0 2px 8px #0002\",transition:\"border 0.2s, box-shadow 0.2s\"},onClick:()=>handleThemeSelect(t),children:[/*#__PURE__*/_jsx(\"span\",{style:{width:32,height:32,borderRadius:8,background:t.chatBg,border:\"1.5px solid #fff\",display:\"inline-block\",marginRight:8}}),/*#__PURE__*/_jsx(\"span\",{style:{color:\"#fff\",textShadow:\"0 1px 4px #0005\"},children:t.name}),theme.name===t.name&&/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:\"auto\",color:\"#00c3ff\",fontSize:22},children:\"\\u2714\"})]},t.name))})]})})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","useRef","axios","chatStyles","io","ReCAPTCHA","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","API_URL","parseToken","token","t","split","replace","n","decodeURIComponent","atob","map","c","charCodeAt","toString","slice","join","JSON","parse","username","_unused","App","_userProfile$age","_userProfile$city","_userProfile$status","setToken","localStorage","getItem","channels","setChannels","selectedChannel","setSelectedChannel","messages","setMessages","input","setInput","typing","setTyping","typingTimeoutRef","showCreate","setShowCreate","newChannel","setNewChannel","authMode","setAuthMode","setUsername","password","setPassword","error","setError","userProfile","setUserProfile","editMode","setEditMode","editData","setEditData","city","status","age","showProfile","setShowProfile","showProfileModal","setShowProfileModal","profileModalData","setProfileModalData","registering","setRegistering","socketRef","messagesEndRef","fileInputRefChat","fileInputRefAvatar","avatarVersion","setAvatarVersion","Date","now","fileToSend","setFileToSend","filePreviewUrl","setFilePreviewUrl","modalMedia","setModalMedia","attachBtnHover","setAttachBtnHover","showCustomizer","setShowCustomizer","theme","setTheme","themes","recording","setRecording","recordTime","setRecordTime","mediaRecorder","setMediaRecorder","audioBlob","setAudioBlob","audioUrl","setAudioUrl","recordTimerRef","mobileMenuOpen","setMobileMenuOpen","recaptchaToken","setRecaptchaToken","recaptchaRef","recaptchaInvisibleRef","isVideoCallOpen","setIsVideoCallOpen","videoCallNotification","setVideoCallNotification","videoCallParticipants","setVideoCallParticipants","localStream","setLocalStream","remoteStreams","setRemoteStreams","isMuted","setIsMuted","isVideoOff","setIsVideoOff","localVideoRef","remoteVideoRefs","peerConnections","startRecording","navigator","mediaDevices","window","MediaRecorder","alert","stream","getUserMedia","audio","recorder","chunks","ondataavailable","e","data","size","push","onstop","blob","Blob","type","URL","createObjectURL","getTracks","forEach","track","stop","current","setInterval","rt","start","err","stopRecording","clearInterval","sendAudioMessage","formData","FormData","append","uploadRes","post","concat","headers","Authorization","msg","text","sender","channel","fileUrl","url","fileType","originalName","emit","startLocalStream","video","srcObject","console","stopLocalStream","startVideoCall","caller","joinVideoCall","endVideoCall","dismissVideoNotification","toggleMute","getAudioTracks","enabled","toggleVideo","getVideoTracks","sendSignal","payload","_objectSpread","handleSignal","from","sdp","candidate","id","pc","RTCPeerConnection","iceServers","urls","addTrack","onicecandidate","event","to","ontrack","prev","streams","setRemoteDescription","RTCSessionDescription","answer","createAnswer","setLocalDescription","addIceCandidate","RTCIceCandidate","_unused2","on","handleUserJoined","userId","createOffer","then","offer","handleUserLeft","close","newStreams","off","Object","values","fetchProfile","res","get","pageBg","chatBg","found","find","_unused3","catch","auth","user","clearTimeout","setTimeout","p","log","filter","handleNewChannel","disconnect","scrollIntoView","behavior","handler","handleCreateChannel","trim","name","members","chs","_id","_unused4","handleSend","value","handleRegister","preventDefault","recaptcha","setItem","_e$response","_e$response$data","response","message","handleLogin","_e$response2","_e$response2$data","handleProfileSave","keys","k","patch","_e$response3","_e$response3$data","handleProfilePopupBgClick","d","document","title","faviconId","link","querySelector","createElement","rel","head","appendChild","href","startsWith","revokeObjectURL","handleThemeSelect","u","_unused5","themedPageStyle","page","background","themedChatBoxStyle","chatBox","styleId","getElementById","style","innerHTML","responsive","isMobile","setIsMobile","innerWidth","onResize","mobile","addEventListener","removeEventListener","handleClickOutside","menuButton","menu","contains","target","timer","mobileHeader","className","children","mobileMenuBtn","onClick","stopPropagation","fontSize","fontWeight","color","letterSpacing","textShadow","margin","mobileMenu","mobileMenuOverlay","mobileMenuCloseBtn","mobileMenuTitle","mobileMenuChannels","length","marginBottom","ch","channelItem","createBtn","v","marginTop","placeholder","onChange","display","flexDirection","alignItems","justifyContent","gap","profileBtn","width","height","viewBox","fill","cx","cy","r","rx","ry","border","marginRight","marginLeft","boxShadow","stroke","strokeWidth","x","y","mobileMenuFooter","position","top","right","borderRadius","padding","maxWidth","zIndex","animation","alignSelf","textAlign","flex","cursor","onMouseEnter","onMouseLeave","left","bottom","overflow","gridTemplateColumns","participant","minHeight","ref","el","autoPlay","objectFit","muted","transition","sidebar","sidebarTitle","channelList","profileBtnBox","chatContainer","paddingTop","maxHeight","chatTitle","isMine","time","createdAt","toLocaleTimeString","hour","minute","messageRow","messageSender","src","controls","alt","minWidth","ext","pop","toLowerCase","includes","wordBreak","paddingLeft","paddingRight","undefined","transform","role","inputRow","attachBtn","click","tabIndex","disabled","_e$target$files","files","Math","floor","padStart","onKeyDown","key","sendBtn","textDecoration","fetch","credentials","a","download","body","remove","profilePopup","opacity","pointerEvents","profileCloseBtn","profileAvatar","avatarUrl","onError","onerror","location","protocol","hostname","encodeURIComponent","accept","_e$target$files2","profileRes","overflowY","profileTitle","profileField","profileLabel","flexWrap","profileEditBtn","profileLogoutBtn","removeItem","reload","profileInput","min","idx"],"sources":["D:/GITHAB/online-chat/frontend/src/App.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\nimport axios from \"axios\";\r\nimport * as chatStyles from \"./styles/chatStyles\";\r\nimport io from \"socket.io-client\";\r\nimport ReCAPTCHA from \"react-google-recaptcha\";\r\n\r\nconst API_URL = \"/api\";\r\n\r\nfunction parseToken(token) {\r\n  if (!token) return \"\";\r\n  try {\r\n    const t = token.split(\".\")[1].replace(/-/g, \"+\").replace(/_/g, \"/\");\r\n    const n = decodeURIComponent(\r\n      atob(t)\r\n        .split(\"\")\r\n        .map((c) => \"%\" + (\"00\" + c.charCodeAt(0).toString(16)).slice(-2))\r\n        .join(\"\")\r\n    );\r\n    return JSON.parse(n).username || \"\";\r\n  } catch {\r\n    return \"\";\r\n  }\r\n}\r\n\r\nfunction App() {\r\n  const [token, setToken] = useState(localStorage.getItem(\"token\"));\r\n  const [channels, setChannels] = useState([]);\r\n  const [selectedChannel, setSelectedChannel] = useState(null);\r\n  const [messages, setMessages] = useState([]);\r\n  const [input, setInput] = useState(\"\");\r\n  const [typing, setTyping] = useState(\"\");\r\n  const typingTimeoutRef = useRef(null);\r\n  const [showCreate, setShowCreate] = useState(false);\r\n  const [newChannel, setNewChannel] = useState(\"\");\r\n  const [authMode, setAuthMode] = useState(\"login\");\r\n  const [username, setUsername] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [error, setError] = useState(\"\");\r\n  const [userProfile, setUserProfile] = useState(null);\r\n  const [editMode, setEditMode] = useState(false);\r\n  const [editData, setEditData] = useState({\r\n    username: \"\",\r\n    password: \"\",\r\n    city: \"\",\r\n    status: \"\",\r\n    age: \"\",\r\n  });\r\n  const [showProfile, setShowProfile] = useState(false);\r\n  const [showProfileModal, setShowProfileModal] = useState(false);\r\n  const [profileModalData, setProfileModalData] = useState({\r\n    city: \"\",\r\n    status: \"\",\r\n    age: \"\",\r\n  });\r\n  const [registering, setRegistering] = useState(false);\r\n  const socketRef = useRef(null);\r\n  const messagesEndRef = useRef(null);\r\n  const fileInputRefChat = React.useRef(null); // для вложений в чат\r\n  const fileInputRefAvatar = React.useRef(null); // для аватара профиля\r\n  const [avatarVersion, setAvatarVersion] = useState(Date.now());\r\n  const [fileToSend, setFileToSend] = useState(null);\r\n  const [filePreviewUrl, setFilePreviewUrl] = useState(null);\r\n  const [modalMedia, setModalMedia] = useState(null); // {type, url, name}\r\n  const [attachBtnHover, setAttachBtnHover] = useState(false); // Состояние для ховера кнопки вложений\r\n  const [showCustomizer, setShowCustomizer] = useState(false); // новое состояние\r\n  const [theme, setTheme] = useState(chatStyles.themes[0]); // выбранная тема\r\n  const [recording, setRecording] = useState(false);\r\n  const [recordTime, setRecordTime] = useState(0);\r\n  const [mediaRecorder, setMediaRecorder] = useState(null);\r\n  const [audioBlob, setAudioBlob] = useState(null);\r\n  const [audioUrl, setAudioUrl] = useState(null);\r\n  const recordTimerRef = useRef(null);\r\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\r\n  const [recaptchaToken, setRecaptchaToken] = useState(\"\");\r\n  const recaptchaRef = useRef(null); // обычная капча\r\n  const recaptchaInvisibleRef = useRef(null); // невидимая капча для автологина\r\n\r\n  // Добавляем состояния для видеозвонков\r\n  const [isVideoCallOpen, setIsVideoCallOpen] = useState(false);\r\n  const [videoCallNotification, setVideoCallNotification] = useState(null);\r\n  const [videoCallParticipants, setVideoCallParticipants] = useState([]);\r\n  const [localStream, setLocalStream] = useState(null);\r\n  const [remoteStreams, setRemoteStreams] = useState({});\r\n  const [isMuted, setIsMuted] = useState(false);\r\n  const [isVideoOff, setIsVideoOff] = useState(false);\r\n  const localVideoRef = useRef(null);\r\n  const remoteVideoRefs = useRef({});\r\n\r\n  // --- WebRTC state ---\r\n  const peerConnections = useRef({});\r\n\r\n  // Функция для старта записи аудио\r\n  const startRecording = async () => {\r\n    if (!navigator.mediaDevices || !window.MediaRecorder) {\r\n      alert(\"Ваш браузер не поддерживает запись аудио\");\r\n      return;\r\n    }\r\n    try {\r\n      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\r\n      const recorder = new window.MediaRecorder(stream);\r\n      let chunks = [];\r\n      recorder.ondataavailable = (e) => {\r\n        if (e.data.size > 0) chunks.push(e.data);\r\n      };\r\n      recorder.onstop = () => {\r\n        const blob = new Blob(chunks, { type: \"audio/webm\" });\r\n        setAudioBlob(blob);\r\n        setAudioUrl(URL.createObjectURL(blob));\r\n        setRecording(false);\r\n        setRecordTime(0);\r\n        stream.getTracks().forEach(track => track.stop());\r\n      };\r\n      setMediaRecorder(recorder);\r\n      setRecording(true);\r\n      setRecordTime(0);\r\n      recordTimerRef.current = setInterval(() => {\r\n        setRecordTime(rt => rt + 1);\r\n      }, 1000);\r\n      chunks = [];\r\n      recorder.start();\r\n    } catch (err) {\r\n      alert(\"Ошибка доступа к микрофону\");\r\n    }\r\n  };\r\n\r\n  // Функция для остановки записи аудио\r\n  const stopRecording = () => {\r\n    if (mediaRecorder) {\r\n      mediaRecorder.stop();\r\n      setMediaRecorder(null);\r\n    }\r\n    setRecording(false);\r\n    if (recordTimerRef.current) {\r\n      clearInterval(recordTimerRef.current);\r\n      recordTimerRef.current = null;\r\n    }\r\n  };\r\n\r\n  // Функция для отправки аудиосообщения\r\n  const sendAudioMessage = async () => {\r\n    if (!audioBlob || !selectedChannel) return;\r\n    const t = parseToken(token);\r\n    const formData = new FormData();\r\n    formData.append(\"file\", audioBlob, \"voice-message.webm\");\r\n    const uploadRes = await axios.post(\r\n      `${API_URL}/upload`,\r\n      formData,\r\n      { headers: { Authorization: `Bearer ${token}` } }\r\n    );\r\n    const msg = {\r\n      text: \"\",\r\n      sender: t,\r\n      channel: selectedChannel,\r\n      fileUrl: uploadRes.data.url,\r\n      fileType: uploadRes.data.fileType,\r\n      originalName: uploadRes.data.originalName || \"voice-message.webm\"\r\n    };\r\n    socketRef.current && socketRef.current.emit(\"join\", selectedChannel);\r\n    socketRef.current.emit(\"message\", msg);\r\n    setAudioBlob(null);\r\n    setAudioUrl(null);\r\n  };\r\n\r\n  // Функции для работы с видеозвонками\r\n  const startLocalStream = async () => {\r\n    try {\r\n      const stream = await navigator.mediaDevices.getUserMedia({\r\n        video: true,\r\n        audio: true\r\n      });\r\n      setLocalStream(stream);\r\n      if (localVideoRef.current) {\r\n        localVideoRef.current.srcObject = stream;\r\n      }\r\n    } catch (error) {\r\n      console.error('Ошибка доступа к камере/микрофону:', error);\r\n      alert('Ошибка доступа к камере/микрофону');\r\n    }\r\n  };\r\n\r\n  const stopLocalStream = () => {\r\n    if (localStream) {\r\n      localStream.getTracks().forEach(track => track.stop());\r\n      setLocalStream(null);\r\n    }\r\n    setVideoCallParticipants([]);\r\n    setRemoteStreams({});\r\n  };\r\n\r\n  const startVideoCall = () => {\r\n    if (!selectedChannel) {\r\n      alert('Выберите канал для видеозвонка');\r\n      return;\r\n    }\r\n    socketRef.current.emit('start-video-call', { \r\n      channel: selectedChannel,\r\n      caller: username \r\n    });\r\n    setIsVideoCallOpen(true);\r\n    startLocalStream();\r\n  };\r\n\r\n  const joinVideoCall = () => {\r\n    setIsVideoCallOpen(true);\r\n    setVideoCallNotification(null);\r\n    startLocalStream();\r\n    if (selectedChannel) {\r\n      socketRef.current.emit('join-video-call', { \r\n        channel: selectedChannel,\r\n        username: username \r\n      });\r\n    }\r\n  };\r\n\r\n  const endVideoCall = () => {\r\n    stopLocalStream();\r\n    if (selectedChannel) {\r\n      socketRef.current.emit('leave-video-call', { channel: selectedChannel });\r\n    }\r\n    setIsVideoCallOpen(false);\r\n  };\r\n\r\n  const dismissVideoNotification = () => {\r\n    setVideoCallNotification(null);\r\n  };\r\n\r\n  const toggleMute = () => {\r\n    if (localStream) {\r\n      localStream.getAudioTracks().forEach(track => {\r\n        track.enabled = isMuted;\r\n      });\r\n      setIsMuted(!isMuted);\r\n    }\r\n  };\r\n\r\n  const toggleVideo = () => {\r\n    if (localStream) {\r\n      localStream.getVideoTracks().forEach(track => {\r\n        track.enabled = isVideoOff;\r\n      });\r\n      setIsVideoOff(!isVideoOff);\r\n    }\r\n  };\r\n\r\n  // Функция для отправки сигналов WebRTC через Socket.IO\r\n  const sendSignal = (type, payload) => {\r\n    if (selectedChannel) {\r\n      socketRef.current.emit('video-signal', {\r\n        channel: selectedChannel,\r\n        type,\r\n        ...payload,\r\n      });\r\n    }\r\n  };\r\n\r\n  // --- WebRTC обработчики ---\r\n  useEffect(() => {\r\n    if (!isVideoCallOpen || !localStream || !selectedChannel) return;\r\n\r\n    // При получении сигнала WebRTC\r\n    const handleSignal = async (data) => {\r\n      const { from, type, sdp, candidate } = data;\r\n      if (from === socketRef.current.id) return; // не обрабатывать свои сигналы\r\n\r\n      // Создаём PeerConnection если нет\r\n      if (!peerConnections.current[from]) {\r\n        const pc = new RTCPeerConnection({\r\n          iceServers: [{ urls: 'stun:stun.l.google.com:19302' }]\r\n        });\r\n        peerConnections.current[from] = pc;\r\n\r\n        // Добавляем свои треки\r\n        localStream.getTracks().forEach(track => pc.addTrack(track, localStream));\r\n\r\n        // ICE candidates\r\n        pc.onicecandidate = (event) => {\r\n          if (event.candidate) {\r\n            sendSignal('ice-candidate', { to: from, candidate: event.candidate });\r\n          }\r\n        };\r\n\r\n        // Получение remote stream\r\n        pc.ontrack = (event) => {\r\n          setRemoteStreams(prev => ({\r\n            ...prev,\r\n            [from]: event.streams[0]\r\n          }));\r\n        };\r\n      }\r\n      const pc = peerConnections.current[from];\r\n\r\n      if (type === 'offer') {\r\n        await pc.setRemoteDescription(new RTCSessionDescription(sdp));\r\n        const answer = await pc.createAnswer();\r\n        await pc.setLocalDescription(answer);\r\n        sendSignal('answer', { to: from, sdp: answer });\r\n      } else if (type === 'answer') {\r\n        await pc.setRemoteDescription(new RTCSessionDescription(sdp));\r\n      } else if (type === 'ice-candidate' && candidate) {\r\n        try {\r\n          await pc.addIceCandidate(new RTCIceCandidate(candidate));\r\n        } catch {}\r\n      }\r\n    };\r\n\r\n    socketRef.current.on('video-signal', handleSignal);\r\n\r\n    // При появлении нового участника инициируем offer\r\n    const handleUserJoined = (data) => {\r\n      const { userId } = data;\r\n      if (userId === socketRef.current.id) return;\r\n      if (!peerConnections.current[userId]) {\r\n        const pc = new RTCPeerConnection({\r\n          iceServers: [{ urls: 'stun:stun.l.google.com:19302' }]\r\n        });\r\n        peerConnections.current[userId] = pc;\r\n        localStream.getTracks().forEach(track => pc.addTrack(track, localStream));\r\n        pc.onicecandidate = (event) => {\r\n          if (event.candidate) {\r\n            sendSignal('ice-candidate', { to: userId, candidate: event.candidate });\r\n          }\r\n        };\r\n        pc.ontrack = (event) => {\r\n          setRemoteStreams(prev => ({\r\n            ...prev,\r\n            [userId]: event.streams[0]\r\n          }));\r\n        };\r\n        // Создаём offer\r\n        pc.createOffer().then(offer => {\r\n          pc.setLocalDescription(offer);\r\n          sendSignal('offer', { to: userId, sdp: offer });\r\n        });\r\n      }\r\n    };\r\n\r\n    socketRef.current.on('user-joined-video-call', handleUserJoined);\r\n\r\n    // Удаляем remote stream и peerConnection при выходе пользователя\r\n    const handleUserLeft = (data) => {\r\n      const { userId } = data;\r\n      if (peerConnections.current[userId]) {\r\n        peerConnections.current[userId].close();\r\n        delete peerConnections.current[userId];\r\n      }\r\n      setRemoteStreams(prev => {\r\n        const newStreams = { ...prev };\r\n        delete newStreams[userId];\r\n        return newStreams;\r\n      });\r\n    };\r\n\r\n    socketRef.current.on('user-left-video-call', handleUserLeft);\r\n\r\n    return () => {\r\n      socketRef.current.off('video-signal', handleSignal);\r\n      socketRef.current.off('user-joined-video-call', handleUserJoined);\r\n      socketRef.current.off('user-left-video-call', handleUserLeft);\r\n    };\r\n  }, [isVideoCallOpen, localStream, selectedChannel]);\r\n\r\n  // Очищаем peerConnections при завершении звонка\r\n  useEffect(() => {\r\n    if (!isVideoCallOpen) {\r\n      Object.values(peerConnections.current).forEach(pc => pc.close());\r\n      peerConnections.current = {};\r\n      setRemoteStreams({});\r\n    }\r\n  }, [isVideoCallOpen]);\r\n\r\n  useEffect(() => {\r\n    setUsername(parseToken(token));\r\n  }, [token]);\r\n\r\n  useEffect(() => {\r\n    if (!token) return;\r\n    const fetchProfile = async () => {\r\n      try {\r\n        const res = await axios.get(`${API_URL}/profile`, {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        });\r\n        setUserProfile(res.data);\r\n        // Применяем тему из профиля\r\n        if (res.data.theme && (res.data.theme.pageBg || res.data.theme.chatBg)) {\r\n          const found = chatStyles.themes.find(\r\n            t => t.pageBg === res.data.theme.pageBg && t.chatBg === res.data.theme.chatBg\r\n          );\r\n          setTheme(found || { ...chatStyles.themes[0], ...res.data.theme });\r\n        } else {\r\n          setTheme(chatStyles.themes[0]);\r\n        }\r\n      } catch {\r\n        setUserProfile(null);\r\n        setTheme(chatStyles.themes[0]);\r\n      }\r\n    };\r\n    fetchProfile();\r\n  }, [token]);\r\n\r\n  useEffect(() => {\r\n    if (!token) return;\r\n    axios\r\n      .get(`${API_URL}/channels`, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      })\r\n      .then((res) => setChannels(res.data))\r\n      .catch(() => setChannels([]));\r\n\r\n    socketRef.current = io(\"/\", {\r\n      auth: { token },\r\n    });\r\n\r\n    socketRef.current.on(\"message\", (msg) => {\r\n      setMessages((prev) =>\r\n        msg.channel === selectedChannel ? [...prev, msg] : prev\r\n      );\r\n    });\r\n\r\n    socketRef.current.on(\"typing\", (e) => {\r\n      setTyping(`${e.user} печатает...`);\r\n      if (typingTimeoutRef.current) clearTimeout(typingTimeoutRef.current);\r\n      typingTimeoutRef.current = setTimeout(() => setTyping(\"\"), 2000);\r\n    });\r\n\r\n    // Добавляем обработчики видеозвонков\r\n    socketRef.current.on('video-call-started', (data) => {\r\n      if (data.caller !== username) {\r\n        setVideoCallNotification({\r\n          caller: data.caller,\r\n          channel: data.channel\r\n        });\r\n      }\r\n    });\r\n\r\n    socketRef.current.on('video-call-ended', () => {\r\n      setIsVideoCallOpen(false);\r\n      setVideoCallNotification(null);\r\n      stopLocalStream();\r\n    });\r\n\r\n    socketRef.current.on('user-joined-video-call', (data) => {\r\n      setVideoCallParticipants(prev => {\r\n        if (!prev.find(p => p.id === data.userId)) {\r\n          return [...prev, { id: data.userId, username: data.username || 'Участник' }];\r\n        }\r\n        return prev;\r\n      });\r\n    });\r\n\r\n    socketRef.current.on('user-left-video-call', (data) => {\r\n      console.log('User left video call:', data.userId);\r\n      setVideoCallParticipants(prev => prev.filter(p => p.id !== data.userId));\r\n      setRemoteStreams(prev => {\r\n        const newStreams = { ...prev };\r\n        delete newStreams[data.userId];\r\n        return newStreams;\r\n      });\r\n    });\r\n\r\n    // Новый обработчик: обновлять список каналов при появлении нового\r\n    const handleNewChannel = () => {\r\n      axios\r\n        .get(`${API_URL}/channels`, {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        })\r\n        .then((res) => setChannels(res.data))\r\n        .catch(() => setChannels([]));\r\n    };\r\n    socketRef.current.on(\"new-channel\", handleNewChannel);\r\n\r\n    return () => {\r\n      socketRef.current && socketRef.current.disconnect();\r\n      socketRef.current && socketRef.current.off(\"new-channel\", handleNewChannel);\r\n      socketRef.current && socketRef.current.off('video-call-started');\r\n      socketRef.current && socketRef.current.off('video-call-ended');\r\n      socketRef.current && socketRef.current.off('user-joined-video-call');\r\n      socketRef.current && socketRef.current.off('user-left-video-call');\r\n      if (typingTimeoutRef.current) clearTimeout(typingTimeoutRef.current);\r\n    };\r\n    // eslint-disable-next-line\r\n  }, [token, username]);\r\n\r\n  useEffect(() => {\r\n    if (token && selectedChannel) {\r\n      axios\r\n        .get(`${API_URL}/messages/${selectedChannel}`, {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        })\r\n        .then((res) => setMessages(res.data));\r\n      socketRef.current && socketRef.current.emit(\"join\", selectedChannel);\r\n    }\r\n  }, [token, selectedChannel]);\r\n\r\n  useEffect(() => {\r\n    messagesEndRef.current && messagesEndRef.current.scrollIntoView({ behavior: \"smooth\" });\r\n  }, [messages]);\r\n\r\n  useEffect(() => {\r\n    if (!socketRef.current) return;\r\n    const handler = (msg) => {\r\n      if (msg.channel === selectedChannel) setMessages((prev) => [...prev, msg]);\r\n    };\r\n    socketRef.current.on(\"message\", handler);\r\n    return () => socketRef.current.off(\"message\", handler);\r\n  }, [selectedChannel]);\r\n\r\n  const handleCreateChannel = async () => {\r\n    if (!newChannel.trim()) return;\r\n    try {\r\n      const t = parseToken(token);\r\n      const res = await axios.post(\r\n        `${API_URL}/channels`,\r\n        { name: newChannel, members: [t] },\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n      setShowCreate(false);\r\n      setNewChannel(\"\");\r\n      const chs = await axios.get(`${API_URL}/channels`, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      setChannels(chs.data);\r\n      setSelectedChannel(res.data._id);\r\n      socketRef.current && socketRef.current.emit(\"join\", res.data._id);\r\n      // socketRef.current && socketRef.current.emit(\"new-channel\"); // УДАЛЕНО, теперь сервер сам эмитит\r\n    } catch {\r\n      alert(\"Ошибка создания канала\");\r\n    }\r\n  };\r\n\r\n  const handleSend = async () => {\r\n    if ((!input.trim() && !fileToSend) || !selectedChannel) return;\r\n    const t = parseToken(token);\r\n    let msg = { text: input, sender: t, channel: selectedChannel };\r\n    if (fileToSend) {\r\n      const formData = new FormData();\r\n      formData.append(\"file\", fileToSend);\r\n      const uploadRes = await axios.post(\r\n        `${API_URL}/upload`,\r\n        formData,\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n      msg.fileUrl = uploadRes.data.url;\r\n      msg.fileType = uploadRes.data.fileType;\r\n      msg.originalName = uploadRes.data.originalName;\r\n    }\r\n    socketRef.current && socketRef.current.emit(\"join\", selectedChannel);\r\n    socketRef.current.emit(\"message\", msg);\r\n    setInput(\"\");\r\n    setFileToSend(null);\r\n    setFilePreviewUrl(null);\r\n    if (fileInputRefChat.current) fileInputRefChat.current.value = \"\";\r\n  };\r\n\r\n  // Обработчик регистрации\r\n  const handleRegister = async (e) => {\r\n    e.preventDefault();\r\n    setError(\"\");\r\n    setRegistering(true);\r\n    if (!recaptchaToken) {\r\n      setError(\"Пожалуйста, подтвердите, что вы не робот\");\r\n      setRegistering(false);\r\n      return;\r\n    }\r\n    try {\r\n      await axios.post(`${API_URL}/register`, {\r\n        username,\r\n        password,\r\n        recaptcha: recaptchaToken,\r\n      });\r\n      // После успешной регистрации сразу логинимся (без капчи)\r\n      const res = await axios.post(`${API_URL}/login`, {\r\n        username,\r\n        password,\r\n      });\r\n      localStorage.setItem(\"token\", res.data.token);\r\n      setToken(res.data.token);\r\n    } catch (e) {\r\n      let msg = \"Ошибка регистрации или входа\";\r\n      if (e?.response?.data?.error) msg = e.response.data.error;\r\n      else if (typeof e?.message === \"string\" && e.message) msg = e.message;\r\n      setError(msg);\r\n    }\r\n    setRegistering(false);\r\n  };\r\n\r\n  // Обработчик входа\r\n  const handleLogin = async (e) => {\r\n    e.preventDefault();\r\n    setError(\"\");\r\n    setRegistering(true);\r\n    // Капча не требуется для входа\r\n    try {\r\n      const res = await axios.post(`${API_URL}/login`, {\r\n        username,\r\n        password,\r\n      });\r\n      localStorage.setItem(\"token\", res.data.token);\r\n      setToken(res.data.token);\r\n    } catch (e) {\r\n      let msg = \"Неверный логин или пароль\";\r\n      if (e?.response?.data?.error) msg = e.response.data.error;\r\n      else if (typeof e?.message === \"string\" && e.message) msg = e.message;\r\n      setError(msg);\r\n    }\r\n    setRegistering(false);\r\n  };\r\n\r\n  // Функция для отправки изменений профиля\r\n  const handleProfileSave = async () => {\r\n    try {\r\n      const payload = {\r\n        username: editData.username,\r\n        password: editData.password,\r\n        city: editData.city,\r\n        status: editData.status,\r\n        age: editData.age,\r\n      };\r\n      Object.keys(payload).forEach(k => {\r\n        if (payload[k] === \"\" || payload[k] === null) delete payload[k];\r\n      });\r\n      const res = await axios.patch(`${API_URL}/profile`, payload, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      setUserProfile(res.data);\r\n      setEditMode(false);\r\n      if (payload.username && payload.username !== userProfile.username && res.data.token) {\r\n        localStorage.setItem(\"token\", res.data.token);\r\n        setToken(res.data.token);\r\n      }\r\n    } catch (e) {\r\n      alert(e?.response?.data?.error || e?.message || \"Ошибка обновления профиля\");\r\n    }\r\n  };\r\n\r\n  const handleProfilePopupBgClick = (e) => {\r\n    // Если клик по фону (а не по самому popup), закрываем\r\n    setShowProfile(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (userProfile) {\r\n      setEditData(d => ({\r\n        ...d,\r\n      }));\r\n    }\r\n  }, [userProfile]);\r\n\r\n  useEffect(() => {\r\n    document.title = \"ГоВЧат 2.1 Beta\";\r\n    // Добавляем/заменяем favicon\r\n    const faviconId = \"govchat-favicon\";\r\n    let link = document.querySelector(`link[rel=\"icon\"]#${faviconId}`);\r\n    if (!link) {\r\n      link = document.createElement(\"link\");\r\n      link.rel = \"icon\";\r\n      link.id = faviconId;\r\n      document.head.appendChild(link);\r\n    }\r\n    // SVG-эмодзи-иконка (например, 🦆)\r\n    link.type = \"image/svg+xml\";\r\n    link.href =\r\n      'data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 64 64\"><text y=\"52\" font-size=\"52\">🦆</text></svg>';\r\n    return () => {\r\n      // Не удаляем favicon при размонтировании\r\n    };\r\n  }, []);\r\n\r\n  // Показывать превью выбранного файла\r\n  useEffect(() => {\r\n    if (fileToSend) {\r\n      if (fileToSend.type.startsWith(\"image/\") || fileToSend.type.startsWith(\"video/\")) {\r\n        const url = URL.createObjectURL(fileToSend);\r\n        setFilePreviewUrl(url);\r\n        return () => URL.revokeObjectURL(url);\r\n      } else {\r\n        setFilePreviewUrl(null);\r\n      }\r\n    } else {\r\n      setFilePreviewUrl(null);\r\n    }\r\n  }, [fileToSend]);\r\n\r\n  // Сохранение выбранной темы в профиль\r\n  const handleThemeSelect = async (t) => {\r\n    setTheme(t);\r\n    setShowCustomizer(false);\r\n    try {\r\n      await axios.patch(`${API_URL}/profile`, { theme: { pageBg: t.pageBg, chatBg: t.chatBg } }, {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      setUserProfile((u) => u ? { ...u, theme: { pageBg: t.pageBg, chatBg: t.chatBg } } : u);\r\n    } catch {\r\n      // ignore\r\n    }\r\n  };\r\n\r\n  // Применяем тему к стилям\r\n  const themedPageStyle = { ...chatStyles.page, background: theme.pageBg };\r\n  const themedChatBoxStyle = { ...chatStyles.chatBox, background: theme.chatBg };\r\n\r\n  // Вставляем адаптивные стили в <head>\r\n  useEffect(() => {\r\n    const styleId = \"govchat-responsive-style\";\r\n    if (!document.getElementById(styleId)) {\r\n      const style = document.createElement(\"style\");\r\n      style.id = styleId;\r\n      style.innerHTML = chatStyles.responsive;\r\n      document.head.appendChild(style);\r\n    }\r\n  }, []);\r\n\r\n  // Для определения мобильного режима\r\n  const [isMobile, setIsMobile] = useState(window.innerWidth <= 700);\r\n  useEffect(() => {\r\n    const onResize = () => {\r\n      const mobile = window.innerWidth <= 700;\r\n      setIsMobile(mobile);\r\n      // Закрываем мобильное меню при переходе на десктоп\r\n      if (!mobile) {\r\n        setMobileMenuOpen(false);\r\n      }\r\n    };\r\n    window.addEventListener(\"resize\", onResize);\r\n    return () => window.removeEventListener(\"resize\", onResize);\r\n  }, []);\r\n\r\n  // Закрытие мобильного меню при клике вне его области\r\n  useEffect(() => {\r\n    const handleClickOutside = (e) => {\r\n      if (mobileMenuOpen && isMobile) {\r\n        // Проверяем, что клик не по кнопке открытия меню и не внутри самого меню\r\n        const menuButton = document.querySelector('.govchat-mobile-menu-btn');\r\n        const menu = document.querySelector('.govchat-mobile-menu');\r\n        \r\n        if (menuButton && !menuButton.contains(e.target) && \r\n            menu && !menu.contains(e.target)) {\r\n          setMobileMenuOpen(false);\r\n        }\r\n      }\r\n    };\r\n\r\n    if (isMobile && mobileMenuOpen) {\r\n      // Небольшая задержка перед добавлением обработчиков, чтобы не конфликтовать с кликом кнопки\r\n      const timer = setTimeout(() => {\r\n        document.addEventListener('touchstart', handleClickOutside);\r\n        document.addEventListener('click', handleClickOutside);\r\n      }, 100);\r\n      \r\n      return () => {\r\n        clearTimeout(timer);\r\n        document.removeEventListener('touchstart', handleClickOutside);\r\n        document.removeEventListener('click', handleClickOutside);\r\n      };\r\n    }\r\n  }, [mobileMenuOpen, isMobile]);\r\n\r\n  // --- Мобильный header ---\r\n  const mobileHeader = (\r\n    <div style={chatStyles.mobileHeader} className=\"govchat-mobile-header\">\r\n      <button\r\n        style={chatStyles.mobileMenuBtn}\r\n        className=\"govchat-mobile-menu-btn\"\r\n        onClick={(e) => {\r\n          e.stopPropagation();\r\n          setMobileMenuOpen(true);\r\n        }}\r\n        aria-label=\"Меню\"\r\n      >\r\n        <span style={{ fontSize: 28 }}>☰</span>\r\n      </button>\r\n      <div style={{\r\n        fontWeight: 700,\r\n        fontSize: 20,\r\n        color: \"#00c3ff\",\r\n        letterSpacing: 1,\r\n        textShadow: \"0 2px 8px #0002\",\r\n        margin: \"0 auto\",\r\n      }}>\r\n        ГоВЧат 2.1 Beta\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  // --- Мобильное меню ---\r\n  const mobileMenu = (\r\n    mobileMenuOpen && (\r\n      <div \r\n        style={chatStyles.mobileMenuOverlay}\r\n        className=\"govchat-mobile-menu-overlay\"\r\n        onClick={() => setMobileMenuOpen(false)}\r\n      >\r\n        <div\r\n          style={chatStyles.mobileMenu}\r\n          className=\"govchat-mobile-menu\"\r\n          onClick={e => e.stopPropagation()}\r\n        >\r\n          <button\r\n            style={chatStyles.mobileMenuCloseBtn}\r\n            onClick={() => setMobileMenuOpen(false)}\r\n            aria-label=\"Закрыть\"\r\n          >✕</button>\r\n          <div style={chatStyles.mobileMenuTitle}>Каналы</div>\r\n          <div style={chatStyles.mobileMenuChannels}>\r\n            {channels.length === 0 ? (\r\n              <div style={{ color: \"#b2bec3\", marginBottom: 8 }}>\r\n                Нет доступных каналов\r\n              </div>\r\n            ) : (\r\n              channels.map((ch) => (\r\n                <div\r\n                  key={ch._id}\r\n                  style={chatStyles.channelItem(selectedChannel === ch._id)}\r\n                  onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    setSelectedChannel(ch._id);\r\n                    setMobileMenuOpen(false);\r\n                  }}\r\n                >\r\n                  {ch.name}\r\n                </div>\r\n              ))\r\n            )\r\n            }\r\n            <button\r\n              style={chatStyles.createBtn}\r\n              onClick={(e) => {\r\n                e.stopPropagation();\r\n                setShowCreate((v) => !v);\r\n              }}\r\n            >\r\n              {showCreate ? \"Скрыть создание\" : \"Создать канал\"}\r\n            </button>\r\n            {showCreate && (\r\n              <div style={{ marginTop: 10 }}>\r\n                <input\r\n                  style={chatStyles.input}\r\n                  placeholder=\"Название канала\"\r\n                  value={newChannel}\r\n                  onChange={e => setNewChannel(e.target.value)}\r\n                  onClick={e => e.stopPropagation()}\r\n                />\r\n                <button \r\n                  style={chatStyles.createBtn} \r\n                  onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    handleCreateChannel();\r\n                    setMobileMenuOpen(false);\r\n                  }}\r\n                >\r\n                  Создать\r\n                </button>\r\n              </div>\r\n            )}\r\n          </div>\r\n          {/* Кнопки профиля и кастомизации теперь после списка каналов */}\r\n          <div\r\n            className=\"govchat-mobile-profile-actions\"\r\n            style={{\r\n              display: \"flex\",\r\n              flexDirection: \"row\",\r\n              alignItems: \"center\",\r\n              justifyContent: \"center\",\r\n              gap: 18,\r\n              margin: \"18px 0 16px 0\",\r\n            }}\r\n          >\r\n            {/* Профиль */}\r\n            <button\r\n              style={{\r\n                ...chatStyles.profileBtn,\r\n                width: 48,\r\n                height: 48,\r\n                fontSize: 24,\r\n                flexDirection: \"column\",\r\n                alignItems: \"center\",\r\n                justifyContent: \"center\"\r\n              }}\r\n              onClick={(e) => {\r\n                e.stopPropagation();\r\n                setShowProfile(true);\r\n                setMobileMenuOpen(false);\r\n                setEditMode(false);\r\n              }}\r\n              title=\"Профиль\"\r\n            >\r\n              <svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" fill=\"none\">\r\n                <circle cx=\"13\" cy=\"13\" r=\"13\" fill=\"#00c3ff\" />\r\n                <circle cx=\"13\" cy=\"10\" r=\"4\" fill=\"#fff\" />\r\n                <ellipse cx=\"13\" cy=\"19\" rx=\"7\" ry=\"4\" fill=\"#fff\" />\r\n              </svg>\r\n            </button>\r\n            {/* Кастомизация */}\r\n            <button\r\n              style={{\r\n                ...chatStyles.profileBtn,\r\n                width: 48,\r\n                height: 48,\r\n                fontSize: 24,\r\n                flexDirection: \"column\",\r\n                alignItems: \"center\",\r\n                justifyContent: \"center\",\r\n                background: \"none\",\r\n                border: \"none\",\r\n                marginRight: 0,\r\n                marginLeft: 0,\r\n                boxShadow: \"0 2px 8px #00c3ff33\"\r\n              }}\r\n              onClick={(e) => {\r\n                e.stopPropagation();\r\n                setShowCustomizer(true);\r\n                setMobileMenuOpen(false);\r\n              }}\r\n              title=\"Кастомизация\"\r\n            >\r\n              <svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" fill=\"none\">\r\n                <circle cx=\"13\" cy=\"13\" r=\"13\" fill=\"#ffb347\" />\r\n                <path d=\"M7 19c0-2 2-4 4-4s4 2 4 4\" stroke=\"#fff\" strokeWidth=\"2\" />\r\n                <rect x=\"10\" y=\"6\" width=\"6\" height=\"8\" rx=\"2\" fill=\"#fff\" stroke=\"#ffb347\" strokeWidth=\"1.5\"/>\r\n                <rect x=\"8\" y=\"14\" width=\"10\" height=\"4\" rx=\"2\" fill=\"#ffb347\" stroke=\"#fff\" strokeWidth=\"1.5\"/>\r\n              </svg>\r\n            </button>\r\n          </div>\r\n          <div style={chatStyles.mobileMenuFooter}>\r\n            {/* Кнопка \"Выйти\" убрана из мобильного меню */}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  );\r\n\r\n  return (\r\n    <div style={themedPageStyle} className=\"govchat-page\">\r\n      {/* Мобильный header */}\r\n      {isMobile && mobileHeader}\r\n      {/* Мобильное меню - теперь только если открыто */}\r\n      {isMobile && mobileMenu}\r\n      \r\n      {/* Уведомление о видеозвонке */}\r\n      {videoCallNotification && (\r\n        <div style={{\r\n          position: \"fixed\",\r\n          top: 20,\r\n          right: 20,\r\n          background: \"white\",\r\n          border: \"1px solid #ddd\",\r\n          borderRadius: 10,\r\n          boxShadow: \"0 4px 12px rgba(0, 0, 0, 0.15)\",\r\n          padding: 15,\r\n          maxWidth: 350,\r\n          zIndex: 1001,\r\n          animation: \"slideIn 0.3s ease-out\"\r\n        }}>\r\n          <div style={{\r\n            display: \"flex\",\r\n            flexDirection: \"column\",\r\n            gap: 10\r\n          }}>\r\n            <div style={{\r\n              color: \"#007bff\",\r\n              fontSize: 24,\r\n              alignSelf: \"center\"\r\n            }}>📹</div>\r\n            <div style={{\r\n              textAlign: \"center\",\r\n              color: \"#333\"\r\n            }}>\r\n              <strong>{videoCallNotification.caller}</strong> начал видеосеанс в канале <strong>#{videoCallNotification.channel}</strong>\r\n            </div>\r\n            <div style={{\r\n              display: \"flex\",\r\n              gap: 10\r\n            }}>\r\n              <button\r\n                style={{\r\n                  flex: 1,\r\n                  background: \"#28a745\",\r\n                  color: \"white\",\r\n                  border: \"none\",\r\n                  padding: 10,\r\n                  borderRadius: 5,\r\n                  cursor: \"pointer\",\r\n                  fontWeight: \"bold\"\r\n                }}\r\n                onClick={joinVideoCall}\r\n                onMouseEnter={(e) => e.target.style.background = \"#218838\"}\r\n                onMouseLeave={(e) => e.target.style.background = \"#28a745\"}\r\n              >\r\n                Присоединиться\r\n              </button>\r\n              <button\r\n                style={{\r\n                  flex: 1,\r\n                  background: \"#6c757d\",\r\n                  color: \"white\",\r\n                  border: \"none\",\r\n                  padding: 10,\r\n                  borderRadius: 5,\r\n                  cursor: \"pointer\"\r\n                }}\r\n                onClick={dismissVideoNotification}\r\n                onMouseEnter={(e) => e.target.style.background = \"#5a6268\"}\r\n                onMouseLeave={(e) => e.target.style.background = \"#6c757d\"}\r\n              >\r\n                Отклонить\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Модальное окно видеозвонка */}\r\n      {isVideoCallOpen && (\r\n        <div style={{\r\n          position: \"fixed\",\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          background: \"rgba(0, 0, 0, 0.9)\",\r\n          zIndex: 1000,\r\n          display: \"flex\",\r\n          alignItems: \"center\",\r\n          justifyContent: \"center\"\r\n        }}>\r\n          <div style={{\r\n            width: \"95vw\",\r\n            height: \"90vh\",\r\n            background: \"#1a1a1a\",\r\n            borderRadius: 10,\r\n            overflow: \"hidden\",\r\n            display: \"flex\",\r\n            flexDirection: \"column\"\r\n          }}>\r\n            <div style={{\r\n              display: \"flex\",\r\n              justifyContent: \"space-between\",\r\n              alignItems: \"center\",\r\n              padding: \"1rem\",\r\n              background: \"#2a2a2a\",\r\n              color: \"white\"\r\n            }}>\r\n              <h3>Видеозвонок #{selectedChannel}</h3>\r\n              <button\r\n                style={{\r\n                  background: \"none\",\r\n                  border: \"none\",\r\n                  color: \"white\",\r\n                  fontSize: 24,\r\n                  cursor: \"pointer\"\r\n                }}\r\n                onClick={endVideoCall}\r\n              >×</button>\r\n            </div>\r\n            \r\n            <div style={{\r\n              flex: 1,\r\n              position: \"relative\",\r\n              background: \"#333\",\r\n              display: \"flex\",\r\n              alignItems: \"center\",\r\n              justifyContent: \"center\"\r\n            }}>\r\n              {/* Основная область для видео других участников */}\r\n              {videoCallParticipants.length > 0 ? (\r\n                <div style={{\r\n                  display: \"grid\",\r\n                  gridTemplateColumns: videoCallParticipants.length === 1 ? \"1fr\" : \"repeat(auto-fit, minmax(300px, 1fr))\",\r\n                  gap: 10,\r\n                  width: \"100%\",\r\n                  height: \"100%\",\r\n                  padding: 20\r\n                }}>\r\n                  {videoCallParticipants.map((participant) => (\r\n                    <div key={participant.id} style={{\r\n                      position: \"relative\",\r\n                      background: \"#444\",\r\n                      borderRadius: 10,\r\n                      overflow: \"hidden\",\r\n                      display: \"flex\",\r\n                      alignItems: \"center\",\r\n                      justifyContent: \"center\",\r\n                      minHeight: 200\r\n                    }}>\r\n                      {remoteStreams[participant.id] ? (\r\n                        <video\r\n                          ref={el => {\r\n                            if (el && remoteStreams[participant.id]) {\r\n                              el.srcObject = remoteStreams[participant.id];\r\n                            }\r\n                          }}\r\n                          autoPlay\r\n                          style={{\r\n                            width: \"100%\",\r\n                            height: \"100%\",\r\n                            objectFit: \"cover\"\r\n                          }}\r\n                        />\r\n                      ) : (\r\n                        <div style={{\r\n                          display: \"flex\",\r\n                          flexDirection: \"column\",\r\n                          alignItems: \"center\",\r\n                          justifyContent: \"center\",\r\n                          color: \"#888\"\r\n                        }}>\r\n                          <div style={{ fontSize: 48, marginBottom: 10 }}>👤</div>\r\n                          <div>Подключается...</div>\r\n                        </div>\r\n                      )}\r\n                      <span style={{\r\n                        position: \"absolute\",\r\n                        bottom: 10,\r\n                        left: 10,\r\n                        background: \"rgba(0, 0, 0, 0.7)\",\r\n                        color: \"white\",\r\n                        padding: \"5px 10px\",\r\n                        borderRadius: 5,\r\n                        fontSize: 14\r\n                      }}>\r\n                        {participant.username}\r\n                      </span>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              ) : (\r\n                <div style={{\r\n                  color: \"#888\",\r\n                  fontSize: 18,\r\n                  textAlign: \"center\"\r\n                }}>\r\n                  <div style={{ fontSize: 48, marginBottom: 20 }}>📹</div>\r\n                  <div>Ожидание участников...</div>\r\n                  <div style={{ fontSize: 14, marginTop: 10 }}>\r\n                    Пригласите других пользователей присоединиться к видеозвонку\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Мое видео в углу (маленькое) */}\r\n              <div style={{\r\n                position: \"absolute\",\r\n                top: 20,\r\n                right: 20,\r\n                width: 200,\r\n                height: 150,\r\n                background: \"#222\",\r\n                borderRadius: 10,\r\n                overflow: \"hidden\",\r\n                border: \"2px solid #00c3ff\",\r\n                zIndex: 10\r\n              }}>\r\n                <video\r\n                  ref={localVideoRef}\r\n                  autoPlay\r\n                  muted\r\n                  style={{\r\n                    width: \"100%\",\r\n                    height: \"100%\",\r\n                    objectFit: \"cover\"\r\n                  }}\r\n                />\r\n                <span style={{\r\n                  position: \"absolute\",\r\n                  bottom: 5,\r\n                  left: 5,\r\n                  background: \"rgba(0, 0, 0, 0.7)\",\r\n                  color: \"white\",\r\n                  padding: \"2px 6px\",\r\n                  borderRadius: 3,\r\n                  fontSize: 12\r\n                }}>\r\n                  Вы\r\n                </span>\r\n              </div>\r\n            </div>\r\n\r\n            <div style={{\r\n              display: \"flex\",\r\n              justifyContent: \"center\",\r\n              gap: 20,\r\n              padding: 20,\r\n              background: \"#2a2a2a\"\r\n            }}>\r\n              <button\r\n                style={{\r\n                  width: 50,\r\n                  height: 50,\r\n                  borderRadius: \"50%\",\r\n                  border: \"none\",\r\n                  color: \"white\",\r\n                  fontSize: 20,\r\n                  cursor: \"pointer\",\r\n                  background: isMuted ? \"#dc3545\" : \"#4a4a4a\",\r\n                  transition: \"background-color 0.3s\"\r\n                }}\r\n                onClick={toggleMute}\r\n                onMouseEnter={(e) => e.target.style.background = isMuted ? \"#c82333\" : \"#5a5a5a\"}\r\n                onMouseLeave={(e) => e.target.style.background = isMuted ? \"#dc3545\" : \"#4a4a4a\"}\r\n              >\r\n                {isMuted ? \"🔇\" : \"🎤\"}\r\n              </button>\r\n              \r\n              <button\r\n                style={{\r\n                  width: 50,\r\n                  height: 50,\r\n                  borderRadius: \"50%\",\r\n                  border: \"none\",\r\n                  color: \"white\",\r\n                  fontSize: 20,\r\n                  cursor: \"pointer\",\r\n                  background: isVideoOff ? \"#dc3545\" : \"#4a4a4a\",\r\n                  transition: \"background-color 0.3s\"\r\n                }}\r\n                onClick={toggleVideo}\r\n                onMouseEnter={(e) => e.target.style.background = isVideoOff ? \"#c82333\" : \"#5a5a5a\"}\r\n                onMouseLeave={(e) => e.target.style.background = isVideoOff ? \"#dc3545\" : \"#4a4a4a\"}\r\n              >\r\n                {isVideoOff ? \"📹\" : \"📷\"}\r\n              </button>\r\n              \r\n              <button\r\n                style={{\r\n                  width: 50,\r\n                  height: 50,\r\n                  borderRadius: \"50%\",\r\n                  border: \"none\",\r\n                  color: \"white\",\r\n                  fontSize: 20,\r\n                  cursor: \"pointer\",\r\n                  background: \"#dc3545\",\r\n                  transition: \"background-color 0.3s\"\r\n                }}\r\n                onClick={endVideoCall}\r\n                onMouseEnter={(e) => e.target.style.background = \"#c82333\"}\r\n                onMouseLeave={(e) => e.target.style.background = \"#dc3545\"}\r\n              >\r\n                📞\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Сайдбар только на десктопе */}\r\n      {!isMobile && (\r\n        <div style={chatStyles.sidebar} className=\"govchat-sidebar\">\r\n          <div style={chatStyles.sidebarTitle}>ГоВЧат 2.1 Beta</div>\r\n          <div style={chatStyles.channelList} className=\"govchat-channel-list\">\r\n            <div style={{ fontWeight: 600, color: \"#fff\", marginBottom: 10 }}>Каналы</div>\r\n            {channels.length === 0 ? (\r\n              <div style={{ color: \"#b2bec3\", marginBottom: 8 }}>\r\n                Нет доступных каналов\r\n              </div>\r\n            ) : (\r\n              <>\r\n                {channels.map((ch) => (\r\n                  <div\r\n                    key={ch._id}\r\n                    style={chatStyles.channelItem(selectedChannel === ch._id)}\r\n                    onClick={() => setSelectedChannel(ch._id)}\r\n                  >\r\n                    {ch.name}\r\n                  </div>\r\n                ))}\r\n              </>\r\n            )}\r\n            <button\r\n              style={chatStyles.createBtn}\r\n              onClick={() => setShowCreate((v) => !v)}\r\n            >\r\n              {showCreate ? \"Скрыть создание\" : \"Создать канал\"}\r\n            </button>\r\n            {showCreate && (\r\n              <div style={{ marginTop: 10 }}>\r\n                <input\r\n                  style={chatStyles.input}\r\n                  placeholder=\"Название канала\"\r\n                  value={newChannel}\r\n                  onChange={e => setNewChannel(e.target.value)}\r\n                />\r\n                <button style={chatStyles.createBtn} onClick={handleCreateChannel}>\r\n                  Создать\r\n                </button>\r\n              </div>\r\n            )}\r\n          </div>\r\n          {/* --- Кнопки профиля и кастомизации для десктопа --- */}\r\n          <div style={{\r\n            ...chatStyles.profileBtnBox,\r\n            left: \"auto\",\r\n            right: 178,\r\n            bottom: 70,\r\n            display: \"flex\",\r\n            flexDirection: \"row\",\r\n            alignItems: \"center\",\r\n            gap: 10,\r\n            zIndex: 10\r\n          }}>\r\n            {/* Кнопка профиля */}\r\n            <button\r\n              style={chatStyles.profileBtn}\r\n              onClick={() => {\r\n                setShowProfile(v => !v);\r\n                setEditMode(false);\r\n              }}\r\n              title=\"Профиль\"\r\n            >\r\n              <svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" fill=\"none\">\r\n                <circle cx=\"13\" cy=\"13\" r=\"13\" fill=\"#00c3ff\" />\r\n                <circle cx=\"13\" cy=\"10\" r=\"4\" fill=\"#fff\" />\r\n                <ellipse cx=\"13\" cy=\"19\" rx=\"7\" ry=\"4\" fill=\"#fff\" />\r\n              </svg>\r\n            </button>\r\n            {/* Кнопка кастомизации */}\r\n            <button\r\n              style={{\r\n                ...chatStyles.profileBtn,\r\n                background: \"none\",\r\n                border: \"none\",\r\n                marginRight: 0,\r\n                marginLeft: 0,\r\n                boxShadow: \"0 2px 8px #00c3ff33\"\r\n              }}\r\n              onClick={() => setShowCustomizer(v => !v)}\r\n              title=\"Кастомизация\"\r\n            >\r\n              <svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" fill=\"none\">\r\n                <circle cx=\"13\" cy=\"13\" r=\"13\" fill=\"#ffb347\" />\r\n                <path d=\"M7 19c0-2 2-4 4-4s4 2 4 4\" stroke=\"#fff\" strokeWidth=\"2\" />\r\n                <rect x=\"10\" y=\"6\" width=\"6\" height=\"8\" rx=\"2\" fill=\"#fff\" stroke=\"#ffb347\" strokeWidth=\"1.5\"/>\r\n                <rect x=\"8\" y=\"14\" width=\"10\" height=\"4\" rx=\"2\" fill=\"#ffb347\" stroke=\"#fff\" strokeWidth=\"1.5\"/>\r\n              </svg>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {/* Чат всегда на экране, но с отступом сверху на мобиле */}\r\n      <div\r\n        style={{\r\n          ...chatStyles.chatContainer,\r\n          ...(isMobile\r\n            ? {\r\n                paddingTop: 40,\r\n                height: \"calc(100vh - 40px)\",\r\n                maxHeight: \"calc(100vh - 40px)\",\r\n              }\r\n            : {}),\r\n        }}\r\n        className=\"govchat-chat-container\"\r\n      >\r\n        {/* Заголовок чата с кнопкой видеозвонка */}\r\n        <div style={{\r\n          display: \"flex\",\r\n          alignItems: \"center\",\r\n          justifyContent: \"center\",\r\n          width: \"100%\",\r\n          marginBottom: 10,\r\n          minHeight: 32,\r\n          marginTop: isMobile ? 18 : 0,\r\n          position: \"relative\"\r\n        }}>\r\n          <div style={chatStyles.chatTitle}>Чат</div>\r\n          {selectedChannel && (\r\n            <button\r\n              style={{\r\n                position: \"absolute\",\r\n                right: isMobile ? 16 : 0,\r\n                background: \"#007bff\",\r\n                color: \"white\",\r\n                border: \"none\",\r\n                borderRadius: \"50%\",\r\n                width: 40,\r\n                height: 40,\r\n                display: \"flex\",\r\n                alignItems: \"center\",\r\n                justifyContent: \"center\",\r\n                cursor: \"pointer\",\r\n                transition: \"background-color 0.3s\",\r\n                fontSize: 16,\r\n                boxShadow: \"0 2px 8px rgba(0, 123, 255, 0.3)\"\r\n              }}\r\n              onClick={startVideoCall}\r\n              title=\"Начать видеозвонок\"\r\n              onMouseEnter={(e) => e.target.style.background = \"#0056b3\"}\r\n              onMouseLeave={(e) => e.target.style.background = \"#007bff\"}\r\n            >\r\n              {/* Заменяем <FaVideo /> на эмодзи */}\r\n              📹\r\n            </button>\r\n          )}\r\n        </div>\r\n\r\n        <div\r\n          className=\"govchat-chat-box\"\r\n          style={themedChatBoxStyle}\r\n        >\r\n          {messages.map((msg) => {\r\n            const isMine = msg.sender === username;\r\n            // Формат времени\r\n            const time = msg.createdAt ? new Date(msg.createdAt).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) : '';\r\n            return (\r\n              <div key={msg._id} style={chatStyles.messageRow(isMine)}>\r\n                <div style={chatStyles.message(isMine)}>\r\n                  {/* Только для чужих сообщений показываем имя */}\r\n                  {!isMine && (\r\n                    <span style={chatStyles.messageSender}>\r\n                      {msg.sender}:\r\n                    </span>\r\n                  )}\r\n                  {msg.text}\r\n                  {/* Превью файлов */}\r\n                  {msg.fileUrl && msg.fileType && (\r\n                    <span style={{ display: \"block\", marginTop: 8 }}>\r\n                      {msg.fileType.startsWith(\"audio/\") ? (\r\n                        <audio src={msg.fileUrl} controls style={{ maxWidth: 220, borderRadius: 8, background: \"#232526\" }} />\r\n                      ) : msg.fileType.startsWith(\"image/\") ? (\r\n                        <img\r\n                          src={msg.fileUrl}\r\n                          alt={msg.originalName || \"image\"}\r\n                          style={{ maxWidth: 120, maxHeight: 120, borderRadius: 8, cursor: \"pointer\", boxShadow: \"0 2px 8px #00c3ff33\" }}\r\n                          onClick={() => setModalMedia({ type: \"image\", url: msg.fileUrl, name: msg.originalName })}\r\n                        />\r\n                      ) : msg.fileType.startsWith(\"video/\") ? (\r\n                        <video\r\n                          src={msg.fileUrl}\r\n                          controls={false}\r\n                          style={{ maxWidth: 120, maxHeight: 120, borderRadius: 8, cursor: \"pointer\", boxShadow: \"0 2px 8px #00c3ff33\" }}\r\n                          onClick={() => setModalMedia({ type: \"video\", url: msg.fileUrl, name: msg.originalName })}\r\n                        >\r\n                          Ваш браузер не поддерживает видео.\r\n                        </video>\r\n                      ) : (\r\n                        // Превью для документов\r\n                        <span\r\n                          style={{\r\n                            display: \"flex\",\r\n                            alignItems: \"center\",\r\n                            gap: 8,\r\n                            cursor: \"pointer\",\r\n                            background: \"#232526\",\r\n                            borderRadius: 8,\r\n                            padding: \"8px 12px\",\r\n                            boxShadow: \"0 2px 8px #00c3ff22\",\r\n                            maxWidth: 220,\r\n                            minWidth: 0,\r\n                            color: \"#fff\"\r\n                          }}\r\n                          onClick={() => {\r\n                            // Определяем тип документа для предпросмотра\r\n                            const ext = (msg.originalName || \"\").split('.').pop().toLowerCase();\r\n                            if (msg.fileType === \"application/pdf\") {\r\n                              setModalMedia({ type: \"pdf\", url: msg.fileUrl, name: msg.originalName });\r\n                            } else {\r\n                              setModalMedia({ type: \"doc\", url: msg.fileUrl, name: msg.originalName, ext });\r\n                            }\r\n                          }}\r\n                          title={msg.originalName}\r\n                        >\r\n                          {/* Иконка документа по расширению */}\r\n                          <span style={{ fontSize: 28 }}>\r\n                            {(() => {\r\n                              const ext = (msg.originalName || \"\").split('.').pop().toLowerCase();\r\n                              if (ext === \"pdf\") return \"📄\";\r\n                              if ([\"doc\", \"docx\"].includes(ext)) return \"📝\";\r\n                              if ([\"xls\", \"xlsx\"].includes(ext)) return \"📊\";\r\n                              if ([\"ppt\", \"pptx\"].includes(ext)) return \"📈\";\r\n                              if ([\"txt\", \"rtf\"].includes(ext)) return \"📃\";\r\n                              return \"📁\";\r\n                            })()}\r\n                          </span>\r\n                          <span style={{\r\n                            fontSize: 14,\r\n                            color: \"#fff\",\r\n                            wordBreak: \"break-all\",\r\n                            flex: 1,\r\n                            minWidth: 0,\r\n                          }}>\r\n                            {msg.originalName}\r\n                          </span>\r\n                        </span>\r\n                      )}\r\n                      {/* Кнопка скачать убрана отсюда */}\r\n                    </span>\r\n                  )}\r\n                  {/* Время сообщения под текстом, меньшим шрифтом */}\r\n                  <div style={{ color: \"#b2bec3\", fontSize: 11, marginTop: 4, textAlign: isMine ? \"right\" : \"left\" }}>\r\n                    {time}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n          <div ref={messagesEndRef} />\r\n        </div>\r\n        {/* typing вынесен в отдельный flex-контейнер над inputRow */}\r\n        <div style={{ minHeight: 22, display: \"flex\", alignItems: \"flex-end\", marginBottom: 2 }}>\r\n          {typing && (\r\n            <div style={{\r\n              ...chatStyles.typing,\r\n              margin: 0,\r\n              paddingLeft: 8,\r\n              paddingRight: 8,\r\n              background: \"none\",\r\n              borderRadius: 0,\r\n              position: \"relative\",\r\n              zIndex: 2,\r\n              width: \"fit-content\",\r\n              maxWidth: \"80%\",\r\n              alignSelf: \"flex-start\",\r\n              boxShadow: \"none\"\r\n            }}>\r\n              {typing}\r\n            </div>\r\n          )}\r\n        </div>\r\n        {/* Превью выбранного файла теперь над inputRow (и на мобильном, и на десктопе) */}\r\n        {fileToSend && (\r\n          <div\r\n            style={{\r\n              ...(isMobile\r\n                ? {\r\n                    position: \"fixed\",\r\n                    left: 0,\r\n                    right: 0,\r\n                    bottom: 58,\r\n                    zIndex: 1002,\r\n                    background: \"#35363a\",\r\n                    borderRadius: \"12px 12px 0 0\",\r\n                    padding: \"6px 8px 6px 8px\", // уменьшили паддинги\r\n                    maxWidth: \"100vw\",\r\n                    width: \"100vw\",\r\n                    display: \"flex\",\r\n                    alignItems: \"center\",\r\n                    gap: 10, // уменьшили gap\r\n                    boxShadow: \"0 -2px 12px #0005\",\r\n                    justifyContent: \"flex-start\",\r\n                    minHeight: 44, // уменьшили высоту\r\n                  }\r\n                : {\r\n                    margin: \"0 0 8px 0\",\r\n                    padding: \"6px 10px\",\r\n                    background: \"#35363a\",\r\n                    borderRadius: 8,\r\n                    display: \"flex\",\r\n                    alignItems: \"center\",\r\n                    gap: 10,\r\n                    maxWidth: 320,\r\n                  }),\r\n              position: isMobile ? \"fixed\" : undefined,\r\n            }}\r\n          >\r\n            {/* Кнопка крестика для отмены - на мобильном абсолютная слева */}\r\n            {isMobile && (\r\n              <button\r\n                style={{\r\n                  position: \"absolute\",\r\n                  left: 8,\r\n                  top: \"50%\",\r\n                  transform: \"translateY(-50%)\",\r\n                  background: \"none\",\r\n                  border: \"none\",\r\n                  color: \"#ff7675\",\r\n                  fontWeight: 700,\r\n                  fontSize: 22,\r\n                  cursor: \"pointer\",\r\n                  padding: 0,\r\n                  zIndex: 2,\r\n                }}\r\n                title=\"Удалить файл\"\r\n                onClick={() => {\r\n                  setFileToSend(null);\r\n                  setFilePreviewUrl(null);\r\n                  if (fileInputRefChat.current) fileInputRefChat.current.value = \"\";\r\n                }}\r\n              >\r\n                ✕\r\n              </button>\r\n            )}\r\n            {/* Сдвигаем содержимое вправо если мобильный */}\r\n            <div style={{\r\n              display: \"flex\",\r\n              alignItems: \"center\",\r\n              gap: 10,\r\n              width: \"100%\",\r\n              marginLeft: isMobile ? 36 : 0, // отступ под крестик\r\n            }}>\r\n              {fileToSend.type.startsWith(\"image/\") && filePreviewUrl && (\r\n                <img\r\n                  src={filePreviewUrl}\r\n                  alt=\"preview\"\r\n                  style={{\r\n                    maxWidth: isMobile ? 56 : 48, // уменьшили размер\r\n                    maxHeight: isMobile ? 56 : 48,\r\n                    borderRadius: 8,\r\n                    objectFit: \"cover\",\r\n                  }}\r\n                />\r\n              )}\r\n              {fileToSend.type.startsWith(\"video/\") && filePreviewUrl && (\r\n                <video\r\n                  src={filePreviewUrl}\r\n                  style={{\r\n                    maxWidth: isMobile ? 56 : 48,\r\n                    maxHeight: isMobile ? 56 : 48,\r\n                    borderRadius: 8,\r\n                    objectFit: \"cover\",\r\n                  }}\r\n                  controls\r\n                />\r\n              )}\r\n              {!fileToSend.type.startsWith(\"image/\") && !fileToSend.type.startsWith(\"video/\") && (\r\n                <span role=\"img\" aria-label=\"file\" style={{ fontSize: isMobile ? 26 : 22 }}>📎</span>\r\n              )}\r\n              <span\r\n                style={{\r\n                  color: \"#fff\",\r\n                  fontSize: isMobile ? 14 : 14,\r\n                  wordBreak: \"break-all\",\r\n                  flex: 1,\r\n                  minWidth: 0,\r\n                }}\r\n              >\r\n                {fileToSend.name}\r\n              </span>\r\n              {/* На десктопе крестик справа, на мобиле убираем */}\r\n              {!isMobile && (\r\n                <button\r\n                  style={{\r\n                    marginLeft: \"auto\",\r\n                    background: \"none\",\r\n                    border: \"none\",\r\n                    color: \"#ff7675\",\r\n                    fontWeight: 700,\r\n                    fontSize: 16,\r\n                    cursor: \"pointer\",\r\n                    padding: 0,\r\n                  }}\r\n                  title=\"Удалить файл\"\r\n                  onClick={() => {\r\n                    setFileToSend(null);\r\n                    setFilePreviewUrl(null);\r\n                    if (fileInputRefChat.current) fileInputRefChat.current.value = \"\";\r\n                  }}\r\n                >\r\n                  ✕\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* --- Блок предпрослушивания и отправки голосового сообщения --- */}\r\n        {audioBlob && audioUrl && (\r\n          isMobile ? (\r\n            <div style={{\r\n              position: \"fixed\",\r\n              left: 0,\r\n              right: 0,\r\n              bottom: 58, // чуть выше inputRow (учитываем высоту inputRow)\r\n              zIndex: 1001,\r\n              background: \"#35363a\",\r\n              borderRadius: \"12px 12px 0 0\",\r\n              padding: \"10px 12px 10px 12px\",\r\n              maxWidth: \"100vw\",\r\n              width: \"100vw\",\r\n              display: \"flex\",\r\n              alignItems: \"center\",\r\n              gap: 10,\r\n              boxShadow: \"0 -2px 12px #0005\",\r\n              justifyContent: \"center\",\r\n              minHeight: 48\r\n            }}>\r\n              <audio src={audioUrl} controls style={{ height: 28, maxWidth: 180, borderRadius: 8, background: \"#232526\" }} />\r\n              <button\r\n                style={{\r\n                  background: \"#ff7675\",\r\n                  color: \"#fff\",\r\n                  border: \"none\",\r\n                  borderRadius: 8,\r\n                  padding: \"6px 12px\",\r\n                  fontWeight: 600,\r\n                  fontSize: 15,\r\n                  cursor: \"pointer\",\r\n                  marginLeft: 4\r\n                }}\r\n                onClick={sendAudioMessage}\r\n                title=\"Отправить голосовое\"\r\n              >\r\n                ➤\r\n              </button>\r\n              <button\r\n                style={{\r\n                  background: \"none\",\r\n                  color: \"#ff7675\",\r\n                  border: \"none\",\r\n                  fontWeight: 700,\r\n                  fontSize: 20,\r\n                  cursor: \"pointer\"\r\n                }}\r\n                title=\"Удалить запись\"\r\n                onClick={() => {\r\n                  setAudioBlob(null);\r\n                  setAudioUrl(null);\r\n                }}\r\n              >\r\n                ✕\r\n              </button>\r\n            </div>\r\n          ) : (\r\n            <div style={{\r\n              display: \"flex\",\r\n              alignItems: \"center\",\r\n              gap: 8,\r\n              margin: \"8px 0 0 0\",\r\n              background: \"#35363a\",\r\n              borderRadius: 8,\r\n              padding: \"8px 16px\",\r\n              maxWidth: 420\r\n            }}>\r\n              <audio src={audioUrl} controls style={{ height: 32, maxWidth: 220, borderRadius: 8 }} />\r\n              <button\r\n                style={{\r\n                  background: \"#ff7675\",\r\n                  color: \"#fff\",\r\n                  border: \"none\",\r\n                  borderRadius: 8,\r\n                  padding: \"6px 14px\",\r\n                  fontWeight: 600,\r\n                  fontSize: 15,\r\n                  cursor: \"pointer\",\r\n                  marginLeft: 4\r\n                }}\r\n                onClick={sendAudioMessage}\r\n                title=\"Отправить голосовое\"\r\n              >\r\n                Отправить\r\n              </button>\r\n              <button\r\n                style={{\r\n                  background: \"none\",\r\n                  color: \"#ff7675\",\r\n                  border: \"none\",\r\n                  fontWeight: 700,\r\n                  fontSize: 18,\r\n                  cursor: \"pointer\"\r\n                }}\r\n                title=\"Удалить запись\"\r\n                onClick={() => {\r\n                  setAudioBlob(null);\r\n                  setAudioUrl(null);\r\n                }}\r\n              >\r\n                ✕\r\n              </button>\r\n            </div>\r\n          )\r\n        )}\r\n        <div\r\n          style={{\r\n            ...chatStyles.inputRow,\r\n            ...(isMobile ? { padding: \"6px 2vw 6px 2vw\" } : {}),\r\n          }}\r\n          className=\"govchat-input-row\"\r\n        >\r\n          {/* Кнопка вложения */}\r\n          <button\r\n            style={{\r\n              ...(attachBtnHover\r\n                ? { ...chatStyles.attachBtn, ...chatStyles.attachBtnHover }\r\n                : chatStyles.attachBtn),\r\n              ...(isMobile\r\n                ? {\r\n                    width: 34,\r\n                    height: 34,\r\n                    minWidth: 34,\r\n                    minHeight: 34,\r\n                    fontSize: 18,\r\n                    marginRight: 2,\r\n                  }\r\n                : {}),\r\n            }}\r\n            type=\"button\"\r\n            onClick={() => fileInputRefChat.current && fileInputRefChat.current.click()}\r\n            title=\"Прикрепить файл\"\r\n            tabIndex={-1}\r\n            onMouseEnter={() => setAttachBtnHover(true)}\r\n            onMouseLeave={() => setAttachBtnHover(false)}\r\n            disabled={false}\r\n          >\r\n            <span style={{\r\n              color: \"#222\",\r\n              fontSize: isMobile ? 18 : 22,\r\n              display: \"flex\",\r\n              alignItems: \"center\"\r\n            }}>📎</span>\r\n          </button>\r\n          <input\r\n            ref={fileInputRefChat}\r\n            type=\"file\"\r\n            style={{ display: \"none\" }}\r\n            onChange={e => {\r\n              if (e.target.files?.[0]) setFileToSend(e.target.files[0]);\r\n            }}\r\n          />\r\n          {/* Кнопка записи голосового (всегда показывать, уменьшить на мобиле) */}\r\n          <button\r\n            style={{\r\n              ...chatStyles.attachBtn,\r\n              background: recording ? \"#ff7675\" : \"#fff\",\r\n              color: recording ? \"#fff\" : \"#222\",\r\n              marginRight: 2,\r\n              marginLeft: 0,\r\n              border: recording ? \"2px solid #ff7675\" : \"none\",\r\n              ...(isMobile\r\n                ? {\r\n                    width: 34,\r\n                    height: 34,\r\n                    minWidth: 34,\r\n                    minHeight: 34,\r\n                    fontSize: 18,\r\n                  }\r\n                : {}),\r\n            }}\r\n            type=\"button\"\r\n            onClick={() => {\r\n              if (!recording) startRecording();\r\n              else stopRecording();\r\n            }}\r\n            title={recording ? \"Остановить запись\" : \"Записать голосовое\"}\r\n            disabled={fileToSend || audioBlob}\r\n          >\r\n            {recording ? (\r\n              <span style={{\r\n                color: \"#fff\",\r\n                fontSize: isMobile ? 18 : 22,\r\n                display: \"flex\",\r\n                alignItems: \"center\"\r\n              }}>⏺</span>\r\n            ) : (\r\n              <span style={{\r\n                color: \"#222\",\r\n                fontSize: isMobile ? 18 : 22,\r\n                display: \"flex\",\r\n                alignItems: \"center\"\r\n              }}>🎤</span>\r\n            )}\r\n          </button>\r\n          {/* Отображение времени записи */}\r\n          {recording && (\r\n            <span style={{\r\n              color: \"#ff7675\",\r\n              fontWeight: 600,\r\n              minWidth: isMobile ? 28 : 40,\r\n              fontSize: isMobile ? 13 : 16,\r\n            }}>\r\n              {`${Math.floor(recordTime / 60)\r\n                .toString()\r\n                .padStart(2, \"0\")}:${(recordTime % 60).toString().padStart(2, \"0\")}`}\r\n            </span>\r\n          )}\r\n          {/* Поле ввода */}\r\n          <input\r\n            style={{\r\n              ...chatStyles.input,\r\n              ...(isMobile ? { fontSize: 14, padding: \"8px 10px\" } : {}),\r\n            }}\r\n            value={input}\r\n            onChange={e => setInput(e.target.value)}\r\n            onKeyDown={e => {\r\n              if (selectedChannel) {\r\n                socketRef.current.emit(\"typing\", { channel: selectedChannel });\r\n                if (e.key === \"Enter\") handleSend();\r\n              }\r\n            }}\r\n            disabled={!selectedChannel}\r\n            placeholder={\r\n              selectedChannel\r\n                ? \"Введите сообщение...\"\r\n                : \"Выберите канал\"\r\n            }\r\n          />\r\n          {/* Кнопка отправки */}\r\n          <button\r\n            style={{\r\n              ...(isMobile\r\n                ? {\r\n                    background: \"linear-gradient(90deg,#00c3ff,#3a7bd5)\",\r\n                    color: \"#fff\",\r\n                    border: \"none\",\r\n                    borderRadius: 8,\r\n                    width: 34,\r\n                    height: 34,\r\n                    minWidth: 34,\r\n                    minHeight: 34,\r\n                    padding: 0,\r\n                    fontSize: 18,\r\n                    display: \"flex\",\r\n                    alignItems: \"center\",\r\n                    justifyContent: \"center\",\r\n                    boxShadow: \"0 2px 8px #00c3ff33\",\r\n                    marginLeft: 2,\r\n                  }\r\n                : chatStyles.sendBtn),\r\n            }}\r\n            onClick={handleSend}\r\n            disabled={!selectedChannel || (!input.trim() && !fileToSend)}\r\n            title=\"Отправить\"\r\n          >\r\n            {isMobile\r\n              ? <span style={{ fontSize: 18, color: \"#fff\" }}>➤</span>\r\n              : \"Отправить\"}\r\n          </button>\r\n        </div>\r\n        {/* Модальное окно для просмотра фото/видео */}\r\n        {modalMedia && (\r\n          <div\r\n            style={{\r\n              position: \"fixed\",\r\n              left: 0,\r\n              top: 0,\r\n              width: \"100vw\",\r\n              height: \"100vh\",\r\n              background: \"rgba(0,0,0,0.7)\",\r\n              zIndex: 9999,\r\n              display: \"flex\",\r\n              alignItems: \"center\",\r\n              justifyContent: \"center\"\r\n            }}\r\n            onClick={() => setModalMedia(null)}\r\n          >\r\n            <div\r\n              style={{\r\n                background: \"#232526\",\r\n                borderRadius: 12,\r\n                padding: 24,\r\n                maxWidth: \"90vw\",\r\n                maxHeight: \"90vh\",\r\n                boxShadow: \"0 4px 32px #000a\",\r\n                display: \"flex\",\r\n                flexDirection: \"column\",\r\n                alignItems: \"center\",\r\n                position: \"relative\"\r\n              }}\r\n              onClick={e => e.stopPropagation()}\r\n            >\r\n              <button\r\n                style={{\r\n                  position: \"absolute\",\r\n                  top: 8,\r\n                  right: 12,\r\n                  background: \"none\",\r\n                  border: \"none\",\r\n                  color: \"#fff\",\r\n                  fontSize: 28,\r\n                  fontWeight: 700,\r\n                  cursor: \"pointer\",\r\n                  zIndex: 2\r\n                }}\r\n                onClick={() => setModalMedia(null)}\r\n                title=\"Закрыть\"\r\n              >✕</button>\r\n              {modalMedia.type === \"image\" ? (\r\n                <>\r\n                  <img\r\n                    src={modalMedia.url}\r\n                    alt={modalMedia.name}\r\n                    style={{ maxWidth: \"70vw\", maxHeight: \"70vh\", borderRadius: 10, marginBottom: 16 }}\r\n                  />\r\n                  {/* Название изображения над кнопкой скачать */}\r\n                  {modalMedia.name && (\r\n                    <div style={{\r\n                      color: \"#fff\",\r\n                      fontSize: 16,\r\n                      marginBottom: 16,\r\n                      wordBreak: \"break-all\",\r\n                      textAlign: \"center\",\r\n                      maxWidth: \"60vw\"\r\n                    }}>\r\n                      {modalMedia.name}\r\n                    </div>\r\n                  )}\r\n                </>\r\n              ) : modalMedia.type === \"video\" ? (\r\n                <video\r\n                  src={modalMedia.url}\r\n                  controls\r\n                  autoPlay\r\n                  style={{ maxWidth: \"70vw\", maxHeight: \"70vh\", borderRadius: 10, marginBottom: 16, background: \"#000\" }}\r\n                />\r\n              ) : modalMedia.type === \"pdf\" ? (\r\n                <iframe\r\n                  src={modalMedia.url}\r\n                  title={modalMedia.name}\r\n                  style={{\r\n                    width: \"70vw\",\r\n                    height: \"70vh\",\r\n                    border: \"none\",\r\n                    borderRadius: 10,\r\n                    background: \"#fff\",\r\n                    marginBottom: 16\r\n                  }}\r\n                />\r\n              ) : modalMedia.type === \"doc\" ? (\r\n                <div style={{\r\n                  display: \"flex\",\r\n                  flexDirection: \"column\",\r\n                  alignItems: \"center\",\r\n                  justifyContent: \"center\",\r\n                  minHeight: 200,\r\n                  minWidth: 200,\r\n                  marginBottom: 16\r\n                }}>\r\n                  <span style={{ fontSize: 64, marginBottom: 16 }}>\r\n                    {(() => {\r\n                      const ext = (modalMedia.ext || \"\").toLowerCase();\r\n                      if (ext === \"pdf\") return \"📄\";\r\n                      if ([\"doc\", \"docx\"].includes(ext)) return \"📝\";\r\n                      if ([\"xls\", \"xlsx\"].includes(ext)) return \"📊\";\r\n                      if ([\"ppt\", \"pptx\"].includes(ext)) return \"📈\";\r\n                      if ([\"txt\", \"rtf\"].includes(ext)) return \"📃\";\r\n                      return \"📁\";\r\n                    })()}\r\n                  </span>\r\n                  <div style={{ color: \"#fff\", fontSize: 18, marginBottom: 8, wordBreak: \"break-all\", textAlign: \"center\" }}>\r\n                    {modalMedia.name}\r\n                  </div>\r\n                  <div style={{ color: \"#b2bec3\", fontSize: 15, marginBottom: 18 }}>\r\n                    Предпросмотр недоступен для этого типа файла\r\n                  </div>\r\n                </div>\r\n              ) : null}\r\n              <button\r\n                style={{\r\n                  background: \"linear-gradient(90deg,#00c3ff,#3a7bd5)\",\r\n                  color: \"#fff\",\r\n                  border: \"none\",\r\n                  borderRadius: 8,\r\n                  padding: \"10px 22px\",\r\n                  fontWeight: 600,\r\n                  fontSize: 15,\r\n                  cursor: \"pointer\",\r\n                  boxShadow: \"0 2px 8px #00c3ff33\",\r\n                  textDecoration: \"none\"\r\n                }}\r\n                onClick={async e => {\r\n                  e.stopPropagation();\r\n                  try {\r\n                    const response = await fetch(modalMedia.url, { credentials: \"same-origin\" });\r\n                    const blob = await response.blob();\r\n                    const url = window.URL.createObjectURL(blob);\r\n                    const a = document.createElement(\"a\");\r\n                    a.href = url;\r\n                    a.download = modalMedia.name || \"file\";\r\n                    document.body.appendChild(a);\r\n                    a.click();\r\n                    setTimeout(() => {\r\n                      window.URL.revokeObjectURL(url);\r\n                      a.remove();\r\n                    }, 200);\r\n                  } catch (err) {\r\n                    alert(\"Ошибка скачивания файла\");\r\n                  }\r\n                }}\r\n              >\r\n                Скачать\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n      {/* Модальное окно профиля */}\r\n      {showProfile && (\r\n        <div\r\n          style={{\r\n            position: \"fixed\",\r\n            left: 0,\r\n            top: 0,\r\n            width: \"100vw\",\r\n            height: \"100vh\",\r\n            background: \"rgba(0,0,0,0.12)\",\r\n            zIndex: 99,\r\n            transition: \"background 0.2s\",\r\n            display: \"flex\",\r\n            alignItems: \"center\",\r\n            justifyContent: \"center\"\r\n          }}\r\n          onClick={handleProfilePopupBgClick}\r\n        >\r\n          <div\r\n            style={{\r\n              ...chatStyles.profilePopup,\r\n              ...(isMobile\r\n                ? {\r\n                    position: \"fixed\",\r\n                    left: \"50%\",\r\n                    top: \"50%\",\r\n                    transform: \"translate(-50%, -50%)\",\r\n                    width: \"92vw\",\r\n                    maxWidth: 340,\r\n                    minWidth: 0,\r\n                    height: \"auto\",\r\n                    maxHeight: \"72vh\",\r\n                    minHeight: 240,\r\n                    borderRadius: 18,\r\n                    padding: \"14px 8px 8px 8px\",\r\n                    boxShadow: \"0 2px 16px #00c3ff33\",\r\n                    fontSize: 15,\r\n                    display: \"flex\",\r\n                    flexDirection: \"column\",\r\n                    alignItems: \"center\",\r\n                    justifyContent: \"flex-start\",\r\n                  }\r\n                : {\r\n                    transform: showProfile ? \"translateY(0)\" : \"translateY(120%)\",\r\n                    opacity: showProfile ? 1 : 0,\r\n                    pointerEvents: showProfile ? \"auto\" : \"none\",\r\n                  }),\r\n              transition: \"transform 0.32s cubic-bezier(.4,1.4,.6,1), opacity 0.22s\",\r\n            }}\r\n            className=\"govchat-profile-popup\"\r\n            onClick={e => e.stopPropagation()}\r\n          >\r\n            {/* Фиксированная шапка для мобильного */}\r\n            {isMobile && (\r\n              <div style={{\r\n                position: \"sticky\",\r\n                top: 0,\r\n                left: 0,\r\n                width: \"100%\",\r\n                background: \"#232526\",\r\n                zIndex: 2,\r\n                display: \"flex\",\r\n                alignItems: \"center\",\r\n                justifyContent: \"center\",\r\n                padding: \"0 4px 0 0\",\r\n                minHeight: 36,\r\n                marginBottom: 8\r\n              }}>\r\n                <div style={{ fontWeight: 700, fontSize: 17, color: \"#00c3ff\", flex: 1, textAlign: \"center\" }}>Профиль</div>\r\n                {/* Крестик справа сверху */}\r\n                <button\r\n                  style={{\r\n                    ...chatStyles.profileCloseBtn,\r\n                    position: \"static\",\r\n                    right: 0,\r\n                    top: 0,\r\n                    width: 32,\r\n                    height: 32,\r\n                    fontSize: 22,\r\n                    marginRight: 4,\r\n                    marginTop: 0,\r\n                    marginBottom: 0,\r\n                    background: \"none\",\r\n                    color: \"#b2bec3\",\r\n                    boxShadow: \"none\",\r\n                  }}\r\n                  onClick={() => setShowProfile(false)}\r\n                  title=\"Закрыть\"\r\n                >✕</button>\r\n\r\n              </div>\r\n            )}\r\n            {/* Новый аватар/значок профиля */}\r\n            <div\r\n              style={{\r\n                ...chatStyles.profileAvatar,\r\n                ...(isMobile\r\n                  ? { width: 70, height: 70, margin: \"8px auto 8px auto\", fontSize: 36 }\r\n                  : {}),\r\n              }}\r\n              className=\"govchat-profile-avatar\"\r\n            >\r\n              <div\r\n                style={{\r\n                  position: \"relative\",\r\n                  width: isMobile ? 70 : 90,\r\n                  height: isMobile ? 70 : 90,\r\n                  borderRadius: \"50%\",\r\n                  overflow: \"hidden\",\r\n                  cursor: \"pointer\",\r\n                  border: \"2px solid #00c3ff\",\r\n                  margin: \"0 auto\",\r\n                  background: \"#35363a\",\r\n                  display: \"flex\",\r\n                  alignItems: \"center\",\r\n                  justifyContent: \"center\",\r\n                }}\r\n                onClick={() => fileInputRefAvatar.current && fileInputRefAvatar.current.click()}\r\n                title=\"Изменить фото\"\r\n              >\r\n                {/* Показываем пользовательский аватар только если он есть и не дефолтный */}\r\n                {userProfile?.avatarUrl &&\r\n                  userProfile.avatarUrl !== \"/uploads/avatar-default.png\" ? (\r\n                  <img\r\n                    key={userProfile.avatarUrl + avatarVersion}\r\n                    src={\r\n                      userProfile.avatarUrl\r\n                        ? userProfile.avatarUrl + \"?t=\" + avatarVersion\r\n                        : \"/uploads/avatar-default.png\"\r\n                    }\r\n                    alt=\"avatar\"\r\n                    style={{\r\n                      width: isMobile ? 70 : 90,\r\n                      height: isMobile ? 70 : 90,\r\n                      borderRadius: \"50%\",\r\n                      objectFit: \"cover\",\r\n                      display: \"block\",\r\n                    }}\r\n                    onError={e => {\r\n                      e.target.onerror = null;\r\n                      e.target.src =\r\n                        `${window.location.protocol}//${window.location.hostname}:5000/uploads/avatar-default.png`;\r\n                    }}\r\n                  />\r\n                ) : (\r\n                  // Показываем дефолтную картинку, если нет пользовательской\r\n                  <img\r\n                    src={\"/uploads/avatar-default.png\"}\r\n                    alt=\"avatar\"\r\n                    style={{\r\n                      width: isMobile ? 70 : 90,\r\n                      height: isMobile ? 70 : 90,\r\n                      borderRadius: \"50%\",\r\n                      objectFit: \"cover\",\r\n                      display: \"block\",\r\n                    }}\r\n                    onError={e => {\r\n                      e.target.onerror = null;\r\n                      e.target.src =\r\n                        \"https://ui-avatars.com/api/?name=\" +\r\n                        encodeURIComponent(userProfile?.username || \"U\") +\r\n                        \"&background=00c3ff&color=fff&size=90\";\r\n                    }}\r\n                  />\r\n                )}\r\n                <input\r\n                  ref={fileInputRefAvatar}\r\n                  type=\"file\"\r\n                  accept=\"image/*\"\r\n                  style={{ display: \"none\" }}\r\n                  onChange={async e => {\r\n                    if (!e.target.files?.[0]) return;\r\n                    const formData = new FormData();\r\n                    formData.append(\"file\", e.target.files[0]);\r\n                    const uploadRes = await axios.post(\r\n                      `${API_URL}/upload?avatar=1`,\r\n                      formData,\r\n                      {\r\n                        headers: { Authorization: `Bearer ${token}` },\r\n                      }\r\n                    );\r\n                    await axios.patch(\r\n                      `${API_URL}/profile`,\r\n                      { avatarUrl: uploadRes.data.url },\r\n                      { headers: { Authorization: `Bearer ${token}` } }\r\n                    );\r\n                    const profileRes = await axios.get(`${API_URL}/profile`, {\r\n                      headers: { Authorization: `Bearer ${token}` },\r\n                    });\r\n                    setUserProfile(profileRes.data);\r\n                    setAvatarVersion(Date.now());\r\n                  }}\r\n                />\r\n              </div>\r\n            </div>\r\n            {/* Содержимое профиля с прокруткой */}\r\n            <div style={{\r\n              flex: 1,\r\n              overflowY: \"auto\",\r\n              minHeight: 0,\r\n              marginBottom: 10,\r\n              display: \"flex\",\r\n              flexDirection: \"column\",\r\n              justifyContent: \"flex-start\",\r\n              ...(isMobile ? { padding: \"0 4px\" } : {})\r\n            }}>\r\n              {userProfile && !editMode && (\r\n                <>\r\n                  {!isMobile && (\r\n                    <div style={chatStyles.profileTitle} className=\"govchat-profile-title\">Профиль</div>\r\n                  )}\r\n                  <div style={chatStyles.profileField}>\r\n                    <span style={chatStyles.profileLabel}>Ник:</span> {userProfile.username}\r\n                  </div>\r\n                  <div style={chatStyles.profileField}>\r\n                    <span style={chatStyles.profileLabel}>Возраст:</span> {userProfile.age ?? \"—\"}\r\n                  </div>\r\n                  <div style={chatStyles.profileField}>\r\n                    <span style={chatStyles.profileLabel}>Город:</span> {userProfile.city ?? \"—\"}\r\n                  </div>\r\n                  <div style={chatStyles.profileField}>\r\n                    <span style={chatStyles.profileLabel}>Семейный статус:</span> {userProfile.status ?? \"—\"}\r\n                  </div>\r\n                  {/* Кнопки теперь внутри скроллируемой области, сразу после информации */}\r\n                  <div style={{\r\n                    display: \"flex\",\r\n                    gap: 8,\r\n                    marginTop: 18,\r\n                    justifyContent: \"flex-end\",\r\n                    flexWrap: isMobile ? \"wrap\" : \"nowrap\"\r\n                  }}>\r\n                    <button\r\n                      style={{\r\n                        ...chatStyles.profileEditBtn,\r\n                        ...(isMobile ? { fontSize: 14, padding: \"7px 12px\" } : {})\r\n                      }}\r\n                      onClick={() => {\r\n                        setEditData({\r\n                          username: userProfile.username || \"\",\r\n                          password: \"\",\r\n                          city: userProfile.city || \"\",\r\n                          status: userProfile.status || \"\",\r\n                          age: userProfile.age || \"\",\r\n                        });\r\n                        setEditMode(true);\r\n                      }}\r\n                    >\r\n                      Редактировать\r\n                    </button>\r\n                    <button\r\n                      style={{\r\n                        ...chatStyles.profileLogoutBtn,\r\n                        ...(isMobile ? { fontSize: 14, padding: \"7px 12px\" } : {})\r\n                      }}\r\n                      onClick={() => {\r\n                        localStorage.removeItem(\"token\");\r\n                        window.location.reload();\r\n                      }}\r\n                    >\r\n                      Выйти\r\n                    </button>\r\n                  </div>\r\n                </>\r\n              )}\r\n              {userProfile && editMode && (\r\n                <>\r\n                  {!isMobile && (\r\n                    <div style={chatStyles.profileTitle}>Редактирование профиля</div>\r\n                  )}\r\n                  <div style={chatStyles.profileField}>\r\n                    <span style={chatStyles.profileLabel}>Ник:</span>\r\n                    <input\r\n                      style={{\r\n                        ...chatStyles.profileInput,\r\n                        ...(isMobile ? { fontSize: 14, padding: \"6px 8px\" } : {})\r\n                      }}\r\n                      value={editData.username}\r\n                      onChange={e => setEditData(d => ({ ...d, username: e.target.value }))}\r\n                    />\r\n                  </div>\r\n                  <div style={chatStyles.profileField}>\r\n                    <span style={chatStyles.profileLabel}>Пароль:</span>\r\n                    <input\r\n                      style={{\r\n                        ...chatStyles.profileInput,\r\n                        ...(isMobile ? { fontSize: 14, padding: \"6px 8px\" } : {})\r\n                      }}\r\n                      type=\"password\"\r\n                      value={editData.password}\r\n                      placeholder=\"Новый пароль\"\r\n                      onChange={e => setEditData(d => ({ ...d, password: e.target.value }))}\r\n                    />\r\n                  </div>\r\n                  <div style={chatStyles.profileField}>\r\n                    <span style={chatStyles.profileLabel}>Возраст:</span>\r\n                    <input\r\n                      style={{\r\n                        ...chatStyles.profileInput,\r\n                        ...(isMobile ? { fontSize: 14, padding: \"6px 8px\" } : {})\r\n                      }}\r\n                      type=\"number\"\r\n                      min={0}\r\n                      value={editData.age}\r\n                      onChange={e => setEditData(d => ({ ...d, age: e.target.value }))}\r\n                    />\r\n                  </div>\r\n                  <div style={chatStyles.profileField}>\r\n                    <span style={chatStyles.profileLabel}>Город:</span>\r\n                    <input\r\n                      style={{\r\n                        ...chatStyles.profileInput,\r\n                        ...(isMobile ? { fontSize: 14, padding: \"6px 8px\" } : {})\r\n                      }}\r\n                      value={editData.city}\r\n                      onChange={e => setEditData(d => ({ ...d, city: e.target.value }))}\r\n                    />\r\n                  </div>\r\n                  <div style={chatStyles.profileField}>\r\n                    <span style={chatStyles.profileLabel}>Семейный статус:</span>\r\n                    <input\r\n                      style={{\r\n                        ...chatStyles.profileInput,\r\n                        ...(isMobile ? { fontSize: 14, padding: \"6px 8px\" } : {})\r\n                      }}\r\n                      value={editData.status}\r\n                      onChange={e => setEditData(d => ({ ...d, status: e.target.value }))}\r\n                    />\r\n                  </div>\r\n                  {/* Кнопки теперь внутри скроллируемой области, сразу после полей */}\r\n                  <div style={{\r\n                    display: \"flex\",\r\n                    gap: 8,\r\n                    marginTop: 10,\r\n                    justifyContent: \"flex-end\",\r\n                    flexWrap: isMobile ? \"wrap\" : \"nowrap\"\r\n                  }}>\r\n                    <button\r\n                      style={{\r\n                        ...chatStyles.profileEditBtn,\r\n                        ...(isMobile ? { fontSize: 14, padding: \"7px 12px\" } : {})\r\n                      }}\r\n                      onClick={handleProfileSave}\r\n                    >\r\n                      Сохранить\r\n                    </button>\r\n                    <button\r\n                      style={{\r\n                        ...chatStyles.profileCloseBtn,\r\n                        position: \"static\",\r\n                        width: \"auto\",\r\n                        height: \"auto\",\r\n                        fontSize: isMobile ? 14 : 15,\r\n                        marginLeft: 0,\r\n                        marginTop: 0,\r\n                        marginBottom: 0,\r\n                        background: \"#35363a\",\r\n                        color: \"#b2bec3\",\r\n                        boxShadow: \"0 2px 8px #0002\",\r\n                        ...(isMobile ? { padding: \"7px 12px\" } : {})\r\n                      }}\r\n                      onClick={() => setEditMode(false)}\r\n                    >\r\n                      Отмена\r\n                    </button>\r\n                  </div>\r\n                </>\r\n              )}\r\n              {!userProfile && (\r\n                <div style={{ color: \"#b2bec3\", marginBottom: 8 }}>Загрузка...</div>\r\n              )}\r\n            </div>\r\n            {/* Кнопки убраны из нижней части popup */}\r\n          </div>\r\n        </div>\r\n      )}\r\n      {/* Модальное окно кастомизации */}\r\n      {showCustomizer && (\r\n        <div\r\n          style={{\r\n            position: \"fixed\",\r\n            left: 0,\r\n            top: 0,\r\n            width: \"100vw\",\r\n            height: \"100vh\",\r\n            background: \"rgba(0,0,0,0.12)\",\r\n            zIndex: 120,\r\n            display: \"flex\",\r\n            alignItems: \"center\",\r\n            justifyContent: \"center\"\r\n          }}\r\n          onClick={() => setShowCustomizer(false)}\r\n        >\r\n          <div\r\n            style={{\r\n              background: \"#232526\",\r\n              borderRadius: 16,\r\n              boxShadow: \"0 2px 16px #00c3ff33\",\r\n              padding: \"32px 32px 24px 32px\",\r\n              minWidth: 320,\r\n              maxWidth: 420,\r\n              zIndex: 121,\r\n              display: \"flex\",\r\n              flexDirection: \"column\",\r\n              alignItems: \"center\",\r\n              position: \"relative\"\r\n            }}\r\n            onClick={e => e.stopPropagation()}\r\n          >\r\n            <button\r\n              style={{\r\n                position: \"absolute\",\r\n                top: 10,\r\n                right: 16,\r\n                background: \"none\",\r\n                color: \"#b2bec3\",\r\n                border: \"none\",\r\n                borderRadius: \"50%\",\r\n                width: 32,\r\n                height: 32,\r\n                fontSize: 22,\r\n                fontWeight: 700,\r\n                cursor: \"pointer\",\r\n                display: \"flex\",\r\n                alignItems: \"center\",\r\n                justifyContent: \"center\",\r\n                transition: \"background 0.2s, color 0.2s\",\r\n                zIndex: 122,\r\n              }}\r\n              onClick={() => setShowCustomizer(false)}\r\n              title=\"Закрыть\"\r\n            >✕</button>\r\n            <div style={{ fontWeight: 700, fontSize: 20, color: \"#ffb347\", marginBottom: 18 }}>\r\n              Кастомизация оформления\r\n           \r\n            </div>\r\n            <div style={{ display: \"flex\", flexDirection: \"column\", gap: 18, width: \"100%\" }}>\r\n              {chatStyles.themes.map((t, idx) => (\r\n                <button\r\n                  key={t.name}\r\n                  style={{\r\n                    display: \"flex\",\r\n                    alignItems: \"center\",\r\n                    gap: 16,\r\n                    width: \"100%\",\r\n                    background: t.pageBg,\r\n                    border: theme.name === t.name ? \"2px solid #00c3ff\" : \"2px solid transparent\",\r\n                    borderRadius: 10,\r\n                    padding: \"12px 18px\",\r\n                    cursor: \"pointer\",\r\n                    color: \"#222\",\r\n                    fontWeight: 600,\r\n                    fontSize: 16,\r\n                    boxShadow: theme.name === t.name ? \"0 2px 12px #00c3ff44\" : \"0 2px 8px #0002\",\r\n                    transition: \"border 0.2s, box-shadow 0.2s\"\r\n                  }}\r\n                  onClick={() => handleThemeSelect(t)}\r\n                >\r\n                  <span style={{\r\n                    width: 32, height: 32, borderRadius: 8, background: t.chatBg,\r\n                    border: \"1.5px solid #fff\", display: \"inline-block\", marginRight: 8\r\n                  }} />\r\n                  <span style={{ color: \"#fff\", textShadow: \"0 1px 4px #0005\" }}>{t.name}</span>\r\n                  {theme.name === t.name && (\r\n                    <span style={{ marginLeft: \"auto\", color: \"#00c3ff\", fontSize: 22 }}>✔</span>\r\n                  )}\r\n                </button>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;"],"mappings":"iJAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,MAAM,KAAQ,OAAO,CAC1D,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,GAAK,CAAAC,UAAU,KAAM,qBAAqB,CACjD,MAAO,CAAAC,EAAE,KAAM,kBAAkB,CACjC,MAAO,CAAAC,SAAS,KAAM,wBAAwB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAE/C,KAAM,CAAAC,OAAO,CAAG,MAAM,CAEtB,QAAS,CAAAC,UAAUA,CAACC,KAAK,CAAE,CACzB,GAAI,CAACA,KAAK,CAAE,MAAO,EAAE,CACrB,GAAI,CACF,KAAM,CAAAC,CAAC,CAAGD,KAAK,CAACE,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAACC,OAAO,CAAC,IAAI,CAAE,GAAG,CAAC,CAACA,OAAO,CAAC,IAAI,CAAE,GAAG,CAAC,CACnE,KAAM,CAAAC,CAAC,CAAGC,kBAAkB,CAC1BC,IAAI,CAACL,CAAC,CAAC,CACJC,KAAK,CAAC,EAAE,CAAC,CACTK,GAAG,CAAEC,CAAC,EAAK,GAAG,CAAG,CAAC,IAAI,CAAGA,CAAC,CAACC,UAAU,CAAC,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,EAAEC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CACjEC,IAAI,CAAC,EAAE,CACZ,CAAC,CACD,MAAO,CAAAC,IAAI,CAACC,KAAK,CAACV,CAAC,CAAC,CAACW,QAAQ,EAAI,EAAE,CACrC,CAAE,MAAAC,OAAA,CAAM,CACN,MAAO,EAAE,CACX,CACF,CAEA,QAAS,CAAAC,GAAGA,CAAA,CAAG,KAAAC,gBAAA,CAAAC,iBAAA,CAAAC,mBAAA,CACb,KAAM,CAACpB,KAAK,CAAEqB,QAAQ,CAAC,CAAGpC,QAAQ,CAACqC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAC,CACjE,KAAM,CAACC,QAAQ,CAAEC,WAAW,CAAC,CAAGxC,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAACyC,eAAe,CAAEC,kBAAkB,CAAC,CAAG1C,QAAQ,CAAC,IAAI,CAAC,CAC5D,KAAM,CAAC2C,QAAQ,CAAEC,WAAW,CAAC,CAAG5C,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAAC6C,KAAK,CAAEC,QAAQ,CAAC,CAAG9C,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAAC+C,MAAM,CAAEC,SAAS,CAAC,CAAGhD,QAAQ,CAAC,EAAE,CAAC,CACxC,KAAM,CAAAiD,gBAAgB,CAAG/C,MAAM,CAAC,IAAI,CAAC,CACrC,KAAM,CAACgD,UAAU,CAAEC,aAAa,CAAC,CAAGnD,QAAQ,CAAC,KAAK,CAAC,CACnD,KAAM,CAACoD,UAAU,CAAEC,aAAa,CAAC,CAAGrD,QAAQ,CAAC,EAAE,CAAC,CAChD,KAAM,CAACsD,QAAQ,CAAEC,WAAW,CAAC,CAAGvD,QAAQ,CAAC,OAAO,CAAC,CACjD,KAAM,CAAC8B,QAAQ,CAAE0B,WAAW,CAAC,CAAGxD,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAACyD,QAAQ,CAAEC,WAAW,CAAC,CAAG1D,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAAC2D,KAAK,CAAEC,QAAQ,CAAC,CAAG5D,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAAC6D,WAAW,CAAEC,cAAc,CAAC,CAAG9D,QAAQ,CAAC,IAAI,CAAC,CACpD,KAAM,CAAC+D,QAAQ,CAAEC,WAAW,CAAC,CAAGhE,QAAQ,CAAC,KAAK,CAAC,CAC/C,KAAM,CAACiE,QAAQ,CAAEC,WAAW,CAAC,CAAGlE,QAAQ,CAAC,CACvC8B,QAAQ,CAAE,EAAE,CACZ2B,QAAQ,CAAE,EAAE,CACZU,IAAI,CAAE,EAAE,CACRC,MAAM,CAAE,EAAE,CACVC,GAAG,CAAE,EACP,CAAC,CAAC,CACF,KAAM,CAACC,WAAW,CAAEC,cAAc,CAAC,CAAGvE,QAAQ,CAAC,KAAK,CAAC,CACrD,KAAM,CAACwE,gBAAgB,CAAEC,mBAAmB,CAAC,CAAGzE,QAAQ,CAAC,KAAK,CAAC,CAC/D,KAAM,CAAC0E,gBAAgB,CAAEC,mBAAmB,CAAC,CAAG3E,QAAQ,CAAC,CACvDmE,IAAI,CAAE,EAAE,CACRC,MAAM,CAAE,EAAE,CACVC,GAAG,CAAE,EACP,CAAC,CAAC,CACF,KAAM,CAACO,WAAW,CAAEC,cAAc,CAAC,CAAG7E,QAAQ,CAAC,KAAK,CAAC,CACrD,KAAM,CAAA8E,SAAS,CAAG5E,MAAM,CAAC,IAAI,CAAC,CAC9B,KAAM,CAAA6E,cAAc,CAAG7E,MAAM,CAAC,IAAI,CAAC,CACnC,KAAM,CAAA8E,gBAAgB,CAAGjF,KAAK,CAACG,MAAM,CAAC,IAAI,CAAC,CAAE;AAC7C,KAAM,CAAA+E,kBAAkB,CAAGlF,KAAK,CAACG,MAAM,CAAC,IAAI,CAAC,CAAE;AAC/C,KAAM,CAACgF,aAAa,CAAEC,gBAAgB,CAAC,CAAGnF,QAAQ,CAACoF,IAAI,CAACC,GAAG,CAAC,CAAC,CAAC,CAC9D,KAAM,CAACC,UAAU,CAAEC,aAAa,CAAC,CAAGvF,QAAQ,CAAC,IAAI,CAAC,CAClD,KAAM,CAACwF,cAAc,CAAEC,iBAAiB,CAAC,CAAGzF,QAAQ,CAAC,IAAI,CAAC,CAC1D,KAAM,CAAC0F,UAAU,CAAEC,aAAa,CAAC,CAAG3F,QAAQ,CAAC,IAAI,CAAC,CAAE;AACpD,KAAM,CAAC4F,cAAc,CAAEC,iBAAiB,CAAC,CAAG7F,QAAQ,CAAC,KAAK,CAAC,CAAE;AAC7D,KAAM,CAAC8F,cAAc,CAAEC,iBAAiB,CAAC,CAAG/F,QAAQ,CAAC,KAAK,CAAC,CAAE;AAC7D,KAAM,CAACgG,KAAK,CAAEC,QAAQ,CAAC,CAAGjG,QAAQ,CAACI,UAAU,CAAC8F,MAAM,CAAC,CAAC,CAAC,CAAC,CAAE;AAC1D,KAAM,CAACC,SAAS,CAAEC,YAAY,CAAC,CAAGpG,QAAQ,CAAC,KAAK,CAAC,CACjD,KAAM,CAACqG,UAAU,CAAEC,aAAa,CAAC,CAAGtG,QAAQ,CAAC,CAAC,CAAC,CAC/C,KAAM,CAACuG,aAAa,CAAEC,gBAAgB,CAAC,CAAGxG,QAAQ,CAAC,IAAI,CAAC,CACxD,KAAM,CAACyG,SAAS,CAAEC,YAAY,CAAC,CAAG1G,QAAQ,CAAC,IAAI,CAAC,CAChD,KAAM,CAAC2G,QAAQ,CAAEC,WAAW,CAAC,CAAG5G,QAAQ,CAAC,IAAI,CAAC,CAC9C,KAAM,CAAA6G,cAAc,CAAG3G,MAAM,CAAC,IAAI,CAAC,CACnC,KAAM,CAAC4G,cAAc,CAAEC,iBAAiB,CAAC,CAAG/G,QAAQ,CAAC,KAAK,CAAC,CAC3D,KAAM,CAACgH,cAAc,CAAEC,iBAAiB,CAAC,CAAGjH,QAAQ,CAAC,EAAE,CAAC,CACxD,KAAM,CAAAkH,YAAY,CAAGhH,MAAM,CAAC,IAAI,CAAC,CAAE;AACnC,KAAM,CAAAiH,qBAAqB,CAAGjH,MAAM,CAAC,IAAI,CAAC,CAAE;AAE5C;AACA,KAAM,CAACkH,eAAe,CAAEC,kBAAkB,CAAC,CAAGrH,QAAQ,CAAC,KAAK,CAAC,CAC7D,KAAM,CAACsH,qBAAqB,CAAEC,wBAAwB,CAAC,CAAGvH,QAAQ,CAAC,IAAI,CAAC,CACxE,KAAM,CAACwH,qBAAqB,CAAEC,wBAAwB,CAAC,CAAGzH,QAAQ,CAAC,EAAE,CAAC,CACtE,KAAM,CAAC0H,WAAW,CAAEC,cAAc,CAAC,CAAG3H,QAAQ,CAAC,IAAI,CAAC,CACpD,KAAM,CAAC4H,aAAa,CAAEC,gBAAgB,CAAC,CAAG7H,QAAQ,CAAC,CAAC,CAAC,CAAC,CACtD,KAAM,CAAC8H,OAAO,CAAEC,UAAU,CAAC,CAAG/H,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAACgI,UAAU,CAAEC,aAAa,CAAC,CAAGjI,QAAQ,CAAC,KAAK,CAAC,CACnD,KAAM,CAAAkI,aAAa,CAAGhI,MAAM,CAAC,IAAI,CAAC,CAClC,KAAM,CAAAiI,eAAe,CAAGjI,MAAM,CAAC,CAAC,CAAC,CAAC,CAElC;AACA,KAAM,CAAAkI,eAAe,CAAGlI,MAAM,CAAC,CAAC,CAAC,CAAC,CAElC;AACA,KAAM,CAAAmI,cAAc,CAAG,KAAAA,CAAA,GAAY,CACjC,GAAI,CAACC,SAAS,CAACC,YAAY,EAAI,CAACC,MAAM,CAACC,aAAa,CAAE,CACpDC,KAAK,CAAC,0CAA0C,CAAC,CACjD,OACF,CACA,GAAI,CACF,KAAM,CAAAC,MAAM,CAAG,KAAM,CAAAL,SAAS,CAACC,YAAY,CAACK,YAAY,CAAC,CAAEC,KAAK,CAAE,IAAK,CAAC,CAAC,CACzE,KAAM,CAAAC,QAAQ,CAAG,GAAI,CAAAN,MAAM,CAACC,aAAa,CAACE,MAAM,CAAC,CACjD,GAAI,CAAAI,MAAM,CAAG,EAAE,CACfD,QAAQ,CAACE,eAAe,CAAIC,CAAC,EAAK,CAChC,GAAIA,CAAC,CAACC,IAAI,CAACC,IAAI,CAAG,CAAC,CAAEJ,MAAM,CAACK,IAAI,CAACH,CAAC,CAACC,IAAI,CAAC,CAC1C,CAAC,CACDJ,QAAQ,CAACO,MAAM,CAAG,IAAM,CACtB,KAAM,CAAAC,IAAI,CAAG,GAAI,CAAAC,IAAI,CAACR,MAAM,CAAE,CAAES,IAAI,CAAE,YAAa,CAAC,CAAC,CACrD9C,YAAY,CAAC4C,IAAI,CAAC,CAClB1C,WAAW,CAAC6C,GAAG,CAACC,eAAe,CAACJ,IAAI,CAAC,CAAC,CACtClD,YAAY,CAAC,KAAK,CAAC,CACnBE,aAAa,CAAC,CAAC,CAAC,CAChBqC,MAAM,CAACgB,SAAS,CAAC,CAAC,CAACC,OAAO,CAACC,KAAK,EAAIA,KAAK,CAACC,IAAI,CAAC,CAAC,CAAC,CACnD,CAAC,CACDtD,gBAAgB,CAACsC,QAAQ,CAAC,CAC1B1C,YAAY,CAAC,IAAI,CAAC,CAClBE,aAAa,CAAC,CAAC,CAAC,CAChBO,cAAc,CAACkD,OAAO,CAAGC,WAAW,CAAC,IAAM,CACzC1D,aAAa,CAAC2D,EAAE,EAAIA,EAAE,CAAG,CAAC,CAAC,CAC7B,CAAC,CAAE,IAAI,CAAC,CACRlB,MAAM,CAAG,EAAE,CACXD,QAAQ,CAACoB,KAAK,CAAC,CAAC,CAClB,CAAE,MAAOC,GAAG,CAAE,CACZzB,KAAK,CAAC,4BAA4B,CAAC,CACrC,CACF,CAAC,CAED;AACA,KAAM,CAAA0B,aAAa,CAAGA,CAAA,GAAM,CAC1B,GAAI7D,aAAa,CAAE,CACjBA,aAAa,CAACuD,IAAI,CAAC,CAAC,CACpBtD,gBAAgB,CAAC,IAAI,CAAC,CACxB,CACAJ,YAAY,CAAC,KAAK,CAAC,CACnB,GAAIS,cAAc,CAACkD,OAAO,CAAE,CAC1BM,aAAa,CAACxD,cAAc,CAACkD,OAAO,CAAC,CACrClD,cAAc,CAACkD,OAAO,CAAG,IAAI,CAC/B,CACF,CAAC,CAED;AACA,KAAM,CAAAO,gBAAgB,CAAG,KAAAA,CAAA,GAAY,CACnC,GAAI,CAAC7D,SAAS,EAAI,CAAChE,eAAe,CAAE,OACpC,KAAM,CAAAzB,CAAC,CAAGF,UAAU,CAACC,KAAK,CAAC,CAC3B,KAAM,CAAAwJ,QAAQ,CAAG,GAAI,CAAAC,QAAQ,CAAC,CAAC,CAC/BD,QAAQ,CAACE,MAAM,CAAC,MAAM,CAAEhE,SAAS,CAAE,oBAAoB,CAAC,CACxD,KAAM,CAAAiE,SAAS,CAAG,KAAM,CAAAvK,KAAK,CAACwK,IAAI,IAAAC,MAAA,CAC7B/J,OAAO,YACV0J,QAAQ,CACR,CAAEM,OAAO,CAAE,CAAEC,aAAa,WAAAF,MAAA,CAAY7J,KAAK,CAAG,CAAE,CAClD,CAAC,CACD,KAAM,CAAAgK,GAAG,CAAG,CACVC,IAAI,CAAE,EAAE,CACRC,MAAM,CAAEjK,CAAC,CACTkK,OAAO,CAAEzI,eAAe,CACxB0I,OAAO,CAAET,SAAS,CAACxB,IAAI,CAACkC,GAAG,CAC3BC,QAAQ,CAAEX,SAAS,CAACxB,IAAI,CAACmC,QAAQ,CACjCC,YAAY,CAAEZ,SAAS,CAACxB,IAAI,CAACoC,YAAY,EAAI,oBAC/C,CAAC,CACDxG,SAAS,CAACiF,OAAO,EAAIjF,SAAS,CAACiF,OAAO,CAACwB,IAAI,CAAC,MAAM,CAAE9I,eAAe,CAAC,CACpEqC,SAAS,CAACiF,OAAO,CAACwB,IAAI,CAAC,SAAS,CAAER,GAAG,CAAC,CACtCrE,YAAY,CAAC,IAAI,CAAC,CAClBE,WAAW,CAAC,IAAI,CAAC,CACnB,CAAC,CAED;AACA,KAAM,CAAA4E,gBAAgB,CAAG,KAAAA,CAAA,GAAY,CACnC,GAAI,CACF,KAAM,CAAA7C,MAAM,CAAG,KAAM,CAAAL,SAAS,CAACC,YAAY,CAACK,YAAY,CAAC,CACvD6C,KAAK,CAAE,IAAI,CACX5C,KAAK,CAAE,IACT,CAAC,CAAC,CACFlB,cAAc,CAACgB,MAAM,CAAC,CACtB,GAAIT,aAAa,CAAC6B,OAAO,CAAE,CACzB7B,aAAa,CAAC6B,OAAO,CAAC2B,SAAS,CAAG/C,MAAM,CAC1C,CACF,CAAE,MAAOhF,KAAK,CAAE,CACdgI,OAAO,CAAChI,KAAK,CAAC,oCAAoC,CAAEA,KAAK,CAAC,CAC1D+E,KAAK,CAAC,mCAAmC,CAAC,CAC5C,CACF,CAAC,CAED,KAAM,CAAAkD,eAAe,CAAGA,CAAA,GAAM,CAC5B,GAAIlE,WAAW,CAAE,CACfA,WAAW,CAACiC,SAAS,CAAC,CAAC,CAACC,OAAO,CAACC,KAAK,EAAIA,KAAK,CAACC,IAAI,CAAC,CAAC,CAAC,CACtDnC,cAAc,CAAC,IAAI,CAAC,CACtB,CACAF,wBAAwB,CAAC,EAAE,CAAC,CAC5BI,gBAAgB,CAAC,CAAC,CAAC,CAAC,CACtB,CAAC,CAED,KAAM,CAAAgE,cAAc,CAAGA,CAAA,GAAM,CAC3B,GAAI,CAACpJ,eAAe,CAAE,CACpBiG,KAAK,CAAC,gCAAgC,CAAC,CACvC,OACF,CACA5D,SAAS,CAACiF,OAAO,CAACwB,IAAI,CAAC,kBAAkB,CAAE,CACzCL,OAAO,CAAEzI,eAAe,CACxBqJ,MAAM,CAAEhK,QACV,CAAC,CAAC,CACFuF,kBAAkB,CAAC,IAAI,CAAC,CACxBmE,gBAAgB,CAAC,CAAC,CACpB,CAAC,CAED,KAAM,CAAAO,aAAa,CAAGA,CAAA,GAAM,CAC1B1E,kBAAkB,CAAC,IAAI,CAAC,CACxBE,wBAAwB,CAAC,IAAI,CAAC,CAC9BiE,gBAAgB,CAAC,CAAC,CAClB,GAAI/I,eAAe,CAAE,CACnBqC,SAAS,CAACiF,OAAO,CAACwB,IAAI,CAAC,iBAAiB,CAAE,CACxCL,OAAO,CAAEzI,eAAe,CACxBX,QAAQ,CAAEA,QACZ,CAAC,CAAC,CACJ,CACF,CAAC,CAED,KAAM,CAAAkK,YAAY,CAAGA,CAAA,GAAM,CACzBJ,eAAe,CAAC,CAAC,CACjB,GAAInJ,eAAe,CAAE,CACnBqC,SAAS,CAACiF,OAAO,CAACwB,IAAI,CAAC,kBAAkB,CAAE,CAAEL,OAAO,CAAEzI,eAAgB,CAAC,CAAC,CAC1E,CACA4E,kBAAkB,CAAC,KAAK,CAAC,CAC3B,CAAC,CAED,KAAM,CAAA4E,wBAAwB,CAAGA,CAAA,GAAM,CACrC1E,wBAAwB,CAAC,IAAI,CAAC,CAChC,CAAC,CAED,KAAM,CAAA2E,UAAU,CAAGA,CAAA,GAAM,CACvB,GAAIxE,WAAW,CAAE,CACfA,WAAW,CAACyE,cAAc,CAAC,CAAC,CAACvC,OAAO,CAACC,KAAK,EAAI,CAC5CA,KAAK,CAACuC,OAAO,CAAGtE,OAAO,CACzB,CAAC,CAAC,CACFC,UAAU,CAAC,CAACD,OAAO,CAAC,CACtB,CACF,CAAC,CAED,KAAM,CAAAuE,WAAW,CAAGA,CAAA,GAAM,CACxB,GAAI3E,WAAW,CAAE,CACfA,WAAW,CAAC4E,cAAc,CAAC,CAAC,CAAC1C,OAAO,CAACC,KAAK,EAAI,CAC5CA,KAAK,CAACuC,OAAO,CAAGpE,UAAU,CAC5B,CAAC,CAAC,CACFC,aAAa,CAAC,CAACD,UAAU,CAAC,CAC5B,CACF,CAAC,CAED;AACA,KAAM,CAAAuE,UAAU,CAAGA,CAAC/C,IAAI,CAAEgD,OAAO,GAAK,CACpC,GAAI/J,eAAe,CAAE,CACnBqC,SAAS,CAACiF,OAAO,CAACwB,IAAI,CAAC,cAAc,CAAAkB,aAAA,EACnCvB,OAAO,CAAEzI,eAAe,CACxB+G,IAAI,EACDgD,OAAO,CACX,CAAC,CACJ,CACF,CAAC,CAED;AACAvM,SAAS,CAAC,IAAM,CACd,GAAI,CAACmH,eAAe,EAAI,CAACM,WAAW,EAAI,CAACjF,eAAe,CAAE,OAE1D;AACA,KAAM,CAAAiK,YAAY,CAAG,KAAO,CAAAxD,IAAI,EAAK,CACnC,KAAM,CAAEyD,IAAI,CAAEnD,IAAI,CAAEoD,GAAG,CAAEC,SAAU,CAAC,CAAG3D,IAAI,CAC3C,GAAIyD,IAAI,GAAK7H,SAAS,CAACiF,OAAO,CAAC+C,EAAE,CAAE,OAAQ;AAE3C;AACA,GAAI,CAAC1E,eAAe,CAAC2B,OAAO,CAAC4C,IAAI,CAAC,CAAE,CAClC,KAAM,CAAAI,EAAE,CAAG,GAAI,CAAAC,iBAAiB,CAAC,CAC/BC,UAAU,CAAE,CAAC,CAAEC,IAAI,CAAE,8BAA+B,CAAC,CACvD,CAAC,CAAC,CACF9E,eAAe,CAAC2B,OAAO,CAAC4C,IAAI,CAAC,CAAGI,EAAE,CAElC;AACArF,WAAW,CAACiC,SAAS,CAAC,CAAC,CAACC,OAAO,CAACC,KAAK,EAAIkD,EAAE,CAACI,QAAQ,CAACtD,KAAK,CAAEnC,WAAW,CAAC,CAAC,CAEzE;AACAqF,EAAE,CAACK,cAAc,CAAIC,KAAK,EAAK,CAC7B,GAAIA,KAAK,CAACR,SAAS,CAAE,CACnBN,UAAU,CAAC,eAAe,CAAE,CAAEe,EAAE,CAAEX,IAAI,CAAEE,SAAS,CAAEQ,KAAK,CAACR,SAAU,CAAC,CAAC,CACvE,CACF,CAAC,CAED;AACAE,EAAE,CAACQ,OAAO,CAAIF,KAAK,EAAK,CACtBxF,gBAAgB,CAAC2F,IAAI,EAAAf,aAAA,CAAAA,aAAA,IAChBe,IAAI,MACP,CAACb,IAAI,EAAGU,KAAK,CAACI,OAAO,CAAC,CAAC,CAAC,EACxB,CAAC,CACL,CAAC,CACH,CACA,KAAM,CAAAV,EAAE,CAAG3E,eAAe,CAAC2B,OAAO,CAAC4C,IAAI,CAAC,CAExC,GAAInD,IAAI,GAAK,OAAO,CAAE,CACpB,KAAM,CAAAuD,EAAE,CAACW,oBAAoB,CAAC,GAAI,CAAAC,qBAAqB,CAACf,GAAG,CAAC,CAAC,CAC7D,KAAM,CAAAgB,MAAM,CAAG,KAAM,CAAAb,EAAE,CAACc,YAAY,CAAC,CAAC,CACtC,KAAM,CAAAd,EAAE,CAACe,mBAAmB,CAACF,MAAM,CAAC,CACpCrB,UAAU,CAAC,QAAQ,CAAE,CAAEe,EAAE,CAAEX,IAAI,CAAEC,GAAG,CAAEgB,MAAO,CAAC,CAAC,CACjD,CAAC,IAAM,IAAIpE,IAAI,GAAK,QAAQ,CAAE,CAC5B,KAAM,CAAAuD,EAAE,CAACW,oBAAoB,CAAC,GAAI,CAAAC,qBAAqB,CAACf,GAAG,CAAC,CAAC,CAC/D,CAAC,IAAM,IAAIpD,IAAI,GAAK,eAAe,EAAIqD,SAAS,CAAE,CAChD,GAAI,CACF,KAAM,CAAAE,EAAE,CAACgB,eAAe,CAAC,GAAI,CAAAC,eAAe,CAACnB,SAAS,CAAC,CAAC,CAC1D,CAAE,MAAAoB,QAAA,CAAM,CAAC,CACX,CACF,CAAC,CAEDnJ,SAAS,CAACiF,OAAO,CAACmE,EAAE,CAAC,cAAc,CAAExB,YAAY,CAAC,CAElD;AACA,KAAM,CAAAyB,gBAAgB,CAAIjF,IAAI,EAAK,CACjC,KAAM,CAAEkF,MAAO,CAAC,CAAGlF,IAAI,CACvB,GAAIkF,MAAM,GAAKtJ,SAAS,CAACiF,OAAO,CAAC+C,EAAE,CAAE,OACrC,GAAI,CAAC1E,eAAe,CAAC2B,OAAO,CAACqE,MAAM,CAAC,CAAE,CACpC,KAAM,CAAArB,EAAE,CAAG,GAAI,CAAAC,iBAAiB,CAAC,CAC/BC,UAAU,CAAE,CAAC,CAAEC,IAAI,CAAE,8BAA+B,CAAC,CACvD,CAAC,CAAC,CACF9E,eAAe,CAAC2B,OAAO,CAACqE,MAAM,CAAC,CAAGrB,EAAE,CACpCrF,WAAW,CAACiC,SAAS,CAAC,CAAC,CAACC,OAAO,CAACC,KAAK,EAAIkD,EAAE,CAACI,QAAQ,CAACtD,KAAK,CAAEnC,WAAW,CAAC,CAAC,CACzEqF,EAAE,CAACK,cAAc,CAAIC,KAAK,EAAK,CAC7B,GAAIA,KAAK,CAACR,SAAS,CAAE,CACnBN,UAAU,CAAC,eAAe,CAAE,CAAEe,EAAE,CAAEc,MAAM,CAAEvB,SAAS,CAAEQ,KAAK,CAACR,SAAU,CAAC,CAAC,CACzE,CACF,CAAC,CACDE,EAAE,CAACQ,OAAO,CAAIF,KAAK,EAAK,CACtBxF,gBAAgB,CAAC2F,IAAI,EAAAf,aAAA,CAAAA,aAAA,IAChBe,IAAI,MACP,CAACY,MAAM,EAAGf,KAAK,CAACI,OAAO,CAAC,CAAC,CAAC,EAC1B,CAAC,CACL,CAAC,CACD;AACAV,EAAE,CAACsB,WAAW,CAAC,CAAC,CAACC,IAAI,CAACC,KAAK,EAAI,CAC7BxB,EAAE,CAACe,mBAAmB,CAACS,KAAK,CAAC,CAC7BhC,UAAU,CAAC,OAAO,CAAE,CAAEe,EAAE,CAAEc,MAAM,CAAExB,GAAG,CAAE2B,KAAM,CAAC,CAAC,CACjD,CAAC,CAAC,CACJ,CACF,CAAC,CAEDzJ,SAAS,CAACiF,OAAO,CAACmE,EAAE,CAAC,wBAAwB,CAAEC,gBAAgB,CAAC,CAEhE;AACA,KAAM,CAAAK,cAAc,CAAItF,IAAI,EAAK,CAC/B,KAAM,CAAEkF,MAAO,CAAC,CAAGlF,IAAI,CACvB,GAAId,eAAe,CAAC2B,OAAO,CAACqE,MAAM,CAAC,CAAE,CACnChG,eAAe,CAAC2B,OAAO,CAACqE,MAAM,CAAC,CAACK,KAAK,CAAC,CAAC,CACvC,MAAO,CAAArG,eAAe,CAAC2B,OAAO,CAACqE,MAAM,CAAC,CACxC,CACAvG,gBAAgB,CAAC2F,IAAI,EAAI,CACvB,KAAM,CAAAkB,UAAU,CAAAjC,aAAA,IAAQe,IAAI,CAAE,CAC9B,MAAO,CAAAkB,UAAU,CAACN,MAAM,CAAC,CACzB,MAAO,CAAAM,UAAU,CACnB,CAAC,CAAC,CACJ,CAAC,CAED5J,SAAS,CAACiF,OAAO,CAACmE,EAAE,CAAC,sBAAsB,CAAEM,cAAc,CAAC,CAE5D,MAAO,IAAM,CACX1J,SAAS,CAACiF,OAAO,CAAC4E,GAAG,CAAC,cAAc,CAAEjC,YAAY,CAAC,CACnD5H,SAAS,CAACiF,OAAO,CAAC4E,GAAG,CAAC,wBAAwB,CAAER,gBAAgB,CAAC,CACjErJ,SAAS,CAACiF,OAAO,CAAC4E,GAAG,CAAC,sBAAsB,CAAEH,cAAc,CAAC,CAC/D,CAAC,CACH,CAAC,CAAE,CAACpH,eAAe,CAAEM,WAAW,CAAEjF,eAAe,CAAC,CAAC,CAEnD;AACAxC,SAAS,CAAC,IAAM,CACd,GAAI,CAACmH,eAAe,CAAE,CACpBwH,MAAM,CAACC,MAAM,CAACzG,eAAe,CAAC2B,OAAO,CAAC,CAACH,OAAO,CAACmD,EAAE,EAAIA,EAAE,CAAC0B,KAAK,CAAC,CAAC,CAAC,CAChErG,eAAe,CAAC2B,OAAO,CAAG,CAAC,CAAC,CAC5BlC,gBAAgB,CAAC,CAAC,CAAC,CAAC,CACtB,CACF,CAAC,CAAE,CAACT,eAAe,CAAC,CAAC,CAErBnH,SAAS,CAAC,IAAM,CACduD,WAAW,CAAC1C,UAAU,CAACC,KAAK,CAAC,CAAC,CAChC,CAAC,CAAE,CAACA,KAAK,CAAC,CAAC,CAEXd,SAAS,CAAC,IAAM,CACd,GAAI,CAACc,KAAK,CAAE,OACZ,KAAM,CAAA+N,YAAY,CAAG,KAAAA,CAAA,GAAY,CAC/B,GAAI,CACF,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAA5O,KAAK,CAAC6O,GAAG,IAAApE,MAAA,CAAI/J,OAAO,aAAY,CAChDgK,OAAO,CAAE,CAAEC,aAAa,WAAAF,MAAA,CAAY7J,KAAK,CAAG,CAC9C,CAAC,CAAC,CACF+C,cAAc,CAACiL,GAAG,CAAC7F,IAAI,CAAC,CACxB;AACA,GAAI6F,GAAG,CAAC7F,IAAI,CAAClD,KAAK,GAAK+I,GAAG,CAAC7F,IAAI,CAAClD,KAAK,CAACiJ,MAAM,EAAIF,GAAG,CAAC7F,IAAI,CAAClD,KAAK,CAACkJ,MAAM,CAAC,CAAE,CACtE,KAAM,CAAAC,KAAK,CAAG/O,UAAU,CAAC8F,MAAM,CAACkJ,IAAI,CAClCpO,CAAC,EAAIA,CAAC,CAACiO,MAAM,GAAKF,GAAG,CAAC7F,IAAI,CAAClD,KAAK,CAACiJ,MAAM,EAAIjO,CAAC,CAACkO,MAAM,GAAKH,GAAG,CAAC7F,IAAI,CAAClD,KAAK,CAACkJ,MACzE,CAAC,CACDjJ,QAAQ,CAACkJ,KAAK,EAAA1C,aAAA,CAAAA,aAAA,IAASrM,UAAU,CAAC8F,MAAM,CAAC,CAAC,CAAC,EAAK6I,GAAG,CAAC7F,IAAI,CAAClD,KAAK,CAAE,CAAC,CACnE,CAAC,IAAM,CACLC,QAAQ,CAAC7F,UAAU,CAAC8F,MAAM,CAAC,CAAC,CAAC,CAAC,CAChC,CACF,CAAE,MAAAmJ,QAAA,CAAM,CACNvL,cAAc,CAAC,IAAI,CAAC,CACpBmC,QAAQ,CAAC7F,UAAU,CAAC8F,MAAM,CAAC,CAAC,CAAC,CAAC,CAChC,CACF,CAAC,CACD4I,YAAY,CAAC,CAAC,CAChB,CAAC,CAAE,CAAC/N,KAAK,CAAC,CAAC,CAEXd,SAAS,CAAC,IAAM,CACd,GAAI,CAACc,KAAK,CAAE,OACZZ,KAAK,CACF6O,GAAG,IAAApE,MAAA,CAAI/J,OAAO,cAAa,CAC1BgK,OAAO,CAAE,CAAEC,aAAa,WAAAF,MAAA,CAAY7J,KAAK,CAAG,CAC9C,CAAC,CAAC,CACDuN,IAAI,CAAES,GAAG,EAAKvM,WAAW,CAACuM,GAAG,CAAC7F,IAAI,CAAC,CAAC,CACpCoG,KAAK,CAAC,IAAM9M,WAAW,CAAC,EAAE,CAAC,CAAC,CAE/BsC,SAAS,CAACiF,OAAO,CAAG1J,EAAE,CAAC,GAAG,CAAE,CAC1BkP,IAAI,CAAE,CAAExO,KAAM,CAChB,CAAC,CAAC,CAEF+D,SAAS,CAACiF,OAAO,CAACmE,EAAE,CAAC,SAAS,CAAGnD,GAAG,EAAK,CACvCnI,WAAW,CAAE4K,IAAI,EACfzC,GAAG,CAACG,OAAO,GAAKzI,eAAe,CAAG,CAAC,GAAG+K,IAAI,CAAEzC,GAAG,CAAC,CAAGyC,IACrD,CAAC,CACH,CAAC,CAAC,CAEF1I,SAAS,CAACiF,OAAO,CAACmE,EAAE,CAAC,QAAQ,CAAGjF,CAAC,EAAK,CACpCjG,SAAS,IAAA4H,MAAA,CAAI3B,CAAC,CAACuG,IAAI,wDAAc,CAAC,CAClC,GAAIvM,gBAAgB,CAAC8G,OAAO,CAAE0F,YAAY,CAACxM,gBAAgB,CAAC8G,OAAO,CAAC,CACpE9G,gBAAgB,CAAC8G,OAAO,CAAG2F,UAAU,CAAC,IAAM1M,SAAS,CAAC,EAAE,CAAC,CAAE,IAAI,CAAC,CAClE,CAAC,CAAC,CAEF;AACA8B,SAAS,CAACiF,OAAO,CAACmE,EAAE,CAAC,oBAAoB,CAAGhF,IAAI,EAAK,CACnD,GAAIA,IAAI,CAAC4C,MAAM,GAAKhK,QAAQ,CAAE,CAC5ByF,wBAAwB,CAAC,CACvBuE,MAAM,CAAE5C,IAAI,CAAC4C,MAAM,CACnBZ,OAAO,CAAEhC,IAAI,CAACgC,OAChB,CAAC,CAAC,CACJ,CACF,CAAC,CAAC,CAEFpG,SAAS,CAACiF,OAAO,CAACmE,EAAE,CAAC,kBAAkB,CAAE,IAAM,CAC7C7G,kBAAkB,CAAC,KAAK,CAAC,CACzBE,wBAAwB,CAAC,IAAI,CAAC,CAC9BqE,eAAe,CAAC,CAAC,CACnB,CAAC,CAAC,CAEF9G,SAAS,CAACiF,OAAO,CAACmE,EAAE,CAAC,wBAAwB,CAAGhF,IAAI,EAAK,CACvDzB,wBAAwB,CAAC+F,IAAI,EAAI,CAC/B,GAAI,CAACA,IAAI,CAAC4B,IAAI,CAACO,CAAC,EAAIA,CAAC,CAAC7C,EAAE,GAAK5D,IAAI,CAACkF,MAAM,CAAC,CAAE,CACzC,MAAO,CAAC,GAAGZ,IAAI,CAAE,CAAEV,EAAE,CAAE5D,IAAI,CAACkF,MAAM,CAAEtM,QAAQ,CAAEoH,IAAI,CAACpH,QAAQ,EAAI,UAAW,CAAC,CAAC,CAC9E,CACA,MAAO,CAAA0L,IAAI,CACb,CAAC,CAAC,CACJ,CAAC,CAAC,CAEF1I,SAAS,CAACiF,OAAO,CAACmE,EAAE,CAAC,sBAAsB,CAAGhF,IAAI,EAAK,CACrDyC,OAAO,CAACiE,GAAG,CAAC,uBAAuB,CAAE1G,IAAI,CAACkF,MAAM,CAAC,CACjD3G,wBAAwB,CAAC+F,IAAI,EAAIA,IAAI,CAACqC,MAAM,CAACF,CAAC,EAAIA,CAAC,CAAC7C,EAAE,GAAK5D,IAAI,CAACkF,MAAM,CAAC,CAAC,CACxEvG,gBAAgB,CAAC2F,IAAI,EAAI,CACvB,KAAM,CAAAkB,UAAU,CAAAjC,aAAA,IAAQe,IAAI,CAAE,CAC9B,MAAO,CAAAkB,UAAU,CAACxF,IAAI,CAACkF,MAAM,CAAC,CAC9B,MAAO,CAAAM,UAAU,CACnB,CAAC,CAAC,CACJ,CAAC,CAAC,CAEF;AACA,KAAM,CAAAoB,gBAAgB,CAAGA,CAAA,GAAM,CAC7B3P,KAAK,CACF6O,GAAG,IAAApE,MAAA,CAAI/J,OAAO,cAAa,CAC1BgK,OAAO,CAAE,CAAEC,aAAa,WAAAF,MAAA,CAAY7J,KAAK,CAAG,CAC9C,CAAC,CAAC,CACDuN,IAAI,CAAES,GAAG,EAAKvM,WAAW,CAACuM,GAAG,CAAC7F,IAAI,CAAC,CAAC,CACpCoG,KAAK,CAAC,IAAM9M,WAAW,CAAC,EAAE,CAAC,CAAC,CACjC,CAAC,CACDsC,SAAS,CAACiF,OAAO,CAACmE,EAAE,CAAC,aAAa,CAAE4B,gBAAgB,CAAC,CAErD,MAAO,IAAM,CACXhL,SAAS,CAACiF,OAAO,EAAIjF,SAAS,CAACiF,OAAO,CAACgG,UAAU,CAAC,CAAC,CACnDjL,SAAS,CAACiF,OAAO,EAAIjF,SAAS,CAACiF,OAAO,CAAC4E,GAAG,CAAC,aAAa,CAAEmB,gBAAgB,CAAC,CAC3EhL,SAAS,CAACiF,OAAO,EAAIjF,SAAS,CAACiF,OAAO,CAAC4E,GAAG,CAAC,oBAAoB,CAAC,CAChE7J,SAAS,CAACiF,OAAO,EAAIjF,SAAS,CAACiF,OAAO,CAAC4E,GAAG,CAAC,kBAAkB,CAAC,CAC9D7J,SAAS,CAACiF,OAAO,EAAIjF,SAAS,CAACiF,OAAO,CAAC4E,GAAG,CAAC,wBAAwB,CAAC,CACpE7J,SAAS,CAACiF,OAAO,EAAIjF,SAAS,CAACiF,OAAO,CAAC4E,GAAG,CAAC,sBAAsB,CAAC,CAClE,GAAI1L,gBAAgB,CAAC8G,OAAO,CAAE0F,YAAY,CAACxM,gBAAgB,CAAC8G,OAAO,CAAC,CACtE,CAAC,CACD;AACF,CAAC,CAAE,CAAChJ,KAAK,CAAEe,QAAQ,CAAC,CAAC,CAErB7B,SAAS,CAAC,IAAM,CACd,GAAIc,KAAK,EAAI0B,eAAe,CAAE,CAC5BtC,KAAK,CACF6O,GAAG,IAAApE,MAAA,CAAI/J,OAAO,eAAA+J,MAAA,CAAanI,eAAe,EAAI,CAC7CoI,OAAO,CAAE,CAAEC,aAAa,WAAAF,MAAA,CAAY7J,KAAK,CAAG,CAC9C,CAAC,CAAC,CACDuN,IAAI,CAAES,GAAG,EAAKnM,WAAW,CAACmM,GAAG,CAAC7F,IAAI,CAAC,CAAC,CACvCpE,SAAS,CAACiF,OAAO,EAAIjF,SAAS,CAACiF,OAAO,CAACwB,IAAI,CAAC,MAAM,CAAE9I,eAAe,CAAC,CACtE,CACF,CAAC,CAAE,CAAC1B,KAAK,CAAE0B,eAAe,CAAC,CAAC,CAE5BxC,SAAS,CAAC,IAAM,CACd8E,cAAc,CAACgF,OAAO,EAAIhF,cAAc,CAACgF,OAAO,CAACiG,cAAc,CAAC,CAAEC,QAAQ,CAAE,QAAS,CAAC,CAAC,CACzF,CAAC,CAAE,CAACtN,QAAQ,CAAC,CAAC,CAEd1C,SAAS,CAAC,IAAM,CACd,GAAI,CAAC6E,SAAS,CAACiF,OAAO,CAAE,OACxB,KAAM,CAAAmG,OAAO,CAAInF,GAAG,EAAK,CACvB,GAAIA,GAAG,CAACG,OAAO,GAAKzI,eAAe,CAAEG,WAAW,CAAE4K,IAAI,EAAK,CAAC,GAAGA,IAAI,CAAEzC,GAAG,CAAC,CAAC,CAC5E,CAAC,CACDjG,SAAS,CAACiF,OAAO,CAACmE,EAAE,CAAC,SAAS,CAAEgC,OAAO,CAAC,CACxC,MAAO,IAAMpL,SAAS,CAACiF,OAAO,CAAC4E,GAAG,CAAC,SAAS,CAAEuB,OAAO,CAAC,CACxD,CAAC,CAAE,CAACzN,eAAe,CAAC,CAAC,CAErB,KAAM,CAAA0N,mBAAmB,CAAG,KAAAA,CAAA,GAAY,CACtC,GAAI,CAAC/M,UAAU,CAACgN,IAAI,CAAC,CAAC,CAAE,OACxB,GAAI,CACF,KAAM,CAAApP,CAAC,CAAGF,UAAU,CAACC,KAAK,CAAC,CAC3B,KAAM,CAAAgO,GAAG,CAAG,KAAM,CAAA5O,KAAK,CAACwK,IAAI,IAAAC,MAAA,CACvB/J,OAAO,cACV,CAAEwP,IAAI,CAAEjN,UAAU,CAAEkN,OAAO,CAAE,CAACtP,CAAC,CAAE,CAAC,CAClC,CAAE6J,OAAO,CAAE,CAAEC,aAAa,WAAAF,MAAA,CAAY7J,KAAK,CAAG,CAAE,CAClD,CAAC,CACDoC,aAAa,CAAC,KAAK,CAAC,CACpBE,aAAa,CAAC,EAAE,CAAC,CACjB,KAAM,CAAAkN,GAAG,CAAG,KAAM,CAAApQ,KAAK,CAAC6O,GAAG,IAAApE,MAAA,CAAI/J,OAAO,cAAa,CACjDgK,OAAO,CAAE,CAAEC,aAAa,WAAAF,MAAA,CAAY7J,KAAK,CAAG,CAC9C,CAAC,CAAC,CACFyB,WAAW,CAAC+N,GAAG,CAACrH,IAAI,CAAC,CACrBxG,kBAAkB,CAACqM,GAAG,CAAC7F,IAAI,CAACsH,GAAG,CAAC,CAChC1L,SAAS,CAACiF,OAAO,EAAIjF,SAAS,CAACiF,OAAO,CAACwB,IAAI,CAAC,MAAM,CAAEwD,GAAG,CAAC7F,IAAI,CAACsH,GAAG,CAAC,CACjE;AACF,CAAE,MAAAC,QAAA,CAAM,CACN/H,KAAK,CAAC,wBAAwB,CAAC,CACjC,CACF,CAAC,CAED,KAAM,CAAAgI,UAAU,CAAG,KAAAA,CAAA,GAAY,CAC7B,GAAK,CAAC7N,KAAK,CAACuN,IAAI,CAAC,CAAC,EAAI,CAAC9K,UAAU,EAAK,CAAC7C,eAAe,CAAE,OACxD,KAAM,CAAAzB,CAAC,CAAGF,UAAU,CAACC,KAAK,CAAC,CAC3B,GAAI,CAAAgK,GAAG,CAAG,CAAEC,IAAI,CAAEnI,KAAK,CAAEoI,MAAM,CAAEjK,CAAC,CAAEkK,OAAO,CAAEzI,eAAgB,CAAC,CAC9D,GAAI6C,UAAU,CAAE,CACd,KAAM,CAAAiF,QAAQ,CAAG,GAAI,CAAAC,QAAQ,CAAC,CAAC,CAC/BD,QAAQ,CAACE,MAAM,CAAC,MAAM,CAAEnF,UAAU,CAAC,CACnC,KAAM,CAAAoF,SAAS,CAAG,KAAM,CAAAvK,KAAK,CAACwK,IAAI,IAAAC,MAAA,CAC7B/J,OAAO,YACV0J,QAAQ,CACR,CAAEM,OAAO,CAAE,CAAEC,aAAa,WAAAF,MAAA,CAAY7J,KAAK,CAAG,CAAE,CAClD,CAAC,CACDgK,GAAG,CAACI,OAAO,CAAGT,SAAS,CAACxB,IAAI,CAACkC,GAAG,CAChCL,GAAG,CAACM,QAAQ,CAAGX,SAAS,CAACxB,IAAI,CAACmC,QAAQ,CACtCN,GAAG,CAACO,YAAY,CAAGZ,SAAS,CAACxB,IAAI,CAACoC,YAAY,CAChD,CACAxG,SAAS,CAACiF,OAAO,EAAIjF,SAAS,CAACiF,OAAO,CAACwB,IAAI,CAAC,MAAM,CAAE9I,eAAe,CAAC,CACpEqC,SAAS,CAACiF,OAAO,CAACwB,IAAI,CAAC,SAAS,CAAER,GAAG,CAAC,CACtCjI,QAAQ,CAAC,EAAE,CAAC,CACZyC,aAAa,CAAC,IAAI,CAAC,CACnBE,iBAAiB,CAAC,IAAI,CAAC,CACvB,GAAIT,gBAAgB,CAAC+E,OAAO,CAAE/E,gBAAgB,CAAC+E,OAAO,CAAC4G,KAAK,CAAG,EAAE,CACnE,CAAC,CAED;AACA,KAAM,CAAAC,cAAc,CAAG,KAAO,CAAA3H,CAAC,EAAK,CAClCA,CAAC,CAAC4H,cAAc,CAAC,CAAC,CAClBjN,QAAQ,CAAC,EAAE,CAAC,CACZiB,cAAc,CAAC,IAAI,CAAC,CACpB,GAAI,CAACmC,cAAc,CAAE,CACnBpD,QAAQ,CAAC,0CAA0C,CAAC,CACpDiB,cAAc,CAAC,KAAK,CAAC,CACrB,OACF,CACA,GAAI,CACF,KAAM,CAAA1E,KAAK,CAACwK,IAAI,IAAAC,MAAA,CAAI/J,OAAO,cAAa,CACtCiB,QAAQ,CACR2B,QAAQ,CACRqN,SAAS,CAAE9J,cACb,CAAC,CAAC,CACF;AACA,KAAM,CAAA+H,GAAG,CAAG,KAAM,CAAA5O,KAAK,CAACwK,IAAI,IAAAC,MAAA,CAAI/J,OAAO,WAAU,CAC/CiB,QAAQ,CACR2B,QACF,CAAC,CAAC,CACFpB,YAAY,CAAC0O,OAAO,CAAC,OAAO,CAAEhC,GAAG,CAAC7F,IAAI,CAACnI,KAAK,CAAC,CAC7CqB,QAAQ,CAAC2M,GAAG,CAAC7F,IAAI,CAACnI,KAAK,CAAC,CAC1B,CAAE,MAAOkI,CAAC,CAAE,KAAA+H,WAAA,CAAAC,gBAAA,CACV,GAAI,CAAAlG,GAAG,CAAG,8BAA8B,CACxC,GAAI9B,CAAC,SAADA,CAAC,YAAA+H,WAAA,CAAD/H,CAAC,CAAEiI,QAAQ,UAAAF,WAAA,YAAAC,gBAAA,CAAXD,WAAA,CAAa9H,IAAI,UAAA+H,gBAAA,WAAjBA,gBAAA,CAAmBtN,KAAK,CAAEoH,GAAG,CAAG9B,CAAC,CAACiI,QAAQ,CAAChI,IAAI,CAACvF,KAAK,CAAC,IACrD,IAAI,OAAOsF,CAAC,SAADA,CAAC,iBAADA,CAAC,CAAEkI,OAAO,IAAK,QAAQ,EAAIlI,CAAC,CAACkI,OAAO,CAAEpG,GAAG,CAAG9B,CAAC,CAACkI,OAAO,CACrEvN,QAAQ,CAACmH,GAAG,CAAC,CACf,CACAlG,cAAc,CAAC,KAAK,CAAC,CACvB,CAAC,CAED;AACA,KAAM,CAAAuM,WAAW,CAAG,KAAO,CAAAnI,CAAC,EAAK,CAC/BA,CAAC,CAAC4H,cAAc,CAAC,CAAC,CAClBjN,QAAQ,CAAC,EAAE,CAAC,CACZiB,cAAc,CAAC,IAAI,CAAC,CACpB;AACA,GAAI,CACF,KAAM,CAAAkK,GAAG,CAAG,KAAM,CAAA5O,KAAK,CAACwK,IAAI,IAAAC,MAAA,CAAI/J,OAAO,WAAU,CAC/CiB,QAAQ,CACR2B,QACF,CAAC,CAAC,CACFpB,YAAY,CAAC0O,OAAO,CAAC,OAAO,CAAEhC,GAAG,CAAC7F,IAAI,CAACnI,KAAK,CAAC,CAC7CqB,QAAQ,CAAC2M,GAAG,CAAC7F,IAAI,CAACnI,KAAK,CAAC,CAC1B,CAAE,MAAOkI,CAAC,CAAE,KAAAoI,YAAA,CAAAC,iBAAA,CACV,GAAI,CAAAvG,GAAG,CAAG,2BAA2B,CACrC,GAAI9B,CAAC,SAADA,CAAC,YAAAoI,YAAA,CAADpI,CAAC,CAAEiI,QAAQ,UAAAG,YAAA,YAAAC,iBAAA,CAAXD,YAAA,CAAanI,IAAI,UAAAoI,iBAAA,WAAjBA,iBAAA,CAAmB3N,KAAK,CAAEoH,GAAG,CAAG9B,CAAC,CAACiI,QAAQ,CAAChI,IAAI,CAACvF,KAAK,CAAC,IACrD,IAAI,OAAOsF,CAAC,SAADA,CAAC,iBAADA,CAAC,CAAEkI,OAAO,IAAK,QAAQ,EAAIlI,CAAC,CAACkI,OAAO,CAAEpG,GAAG,CAAG9B,CAAC,CAACkI,OAAO,CACrEvN,QAAQ,CAACmH,GAAG,CAAC,CACf,CACAlG,cAAc,CAAC,KAAK,CAAC,CACvB,CAAC,CAED;AACA,KAAM,CAAA0M,iBAAiB,CAAG,KAAAA,CAAA,GAAY,CACpC,GAAI,CACF,KAAM,CAAA/E,OAAO,CAAG,CACd1K,QAAQ,CAAEmC,QAAQ,CAACnC,QAAQ,CAC3B2B,QAAQ,CAAEQ,QAAQ,CAACR,QAAQ,CAC3BU,IAAI,CAAEF,QAAQ,CAACE,IAAI,CACnBC,MAAM,CAAEH,QAAQ,CAACG,MAAM,CACvBC,GAAG,CAAEJ,QAAQ,CAACI,GAChB,CAAC,CACDuK,MAAM,CAAC4C,IAAI,CAAChF,OAAO,CAAC,CAAC5C,OAAO,CAAC6H,CAAC,EAAI,CAChC,GAAIjF,OAAO,CAACiF,CAAC,CAAC,GAAK,EAAE,EAAIjF,OAAO,CAACiF,CAAC,CAAC,GAAK,IAAI,CAAE,MAAO,CAAAjF,OAAO,CAACiF,CAAC,CAAC,CACjE,CAAC,CAAC,CACF,KAAM,CAAA1C,GAAG,CAAG,KAAM,CAAA5O,KAAK,CAACuR,KAAK,IAAA9G,MAAA,CAAI/J,OAAO,aAAY2L,OAAO,CAAE,CAC3D3B,OAAO,CAAE,CAAEC,aAAa,WAAAF,MAAA,CAAY7J,KAAK,CAAG,CAC9C,CAAC,CAAC,CACF+C,cAAc,CAACiL,GAAG,CAAC7F,IAAI,CAAC,CACxBlF,WAAW,CAAC,KAAK,CAAC,CAClB,GAAIwI,OAAO,CAAC1K,QAAQ,EAAI0K,OAAO,CAAC1K,QAAQ,GAAK+B,WAAW,CAAC/B,QAAQ,EAAIiN,GAAG,CAAC7F,IAAI,CAACnI,KAAK,CAAE,CACnFsB,YAAY,CAAC0O,OAAO,CAAC,OAAO,CAAEhC,GAAG,CAAC7F,IAAI,CAACnI,KAAK,CAAC,CAC7CqB,QAAQ,CAAC2M,GAAG,CAAC7F,IAAI,CAACnI,KAAK,CAAC,CAC1B,CACF,CAAE,MAAOkI,CAAC,CAAE,KAAA0I,YAAA,CAAAC,iBAAA,CACVlJ,KAAK,CAAC,CAAAO,CAAC,SAADA,CAAC,kBAAA0I,YAAA,CAAD1I,CAAC,CAAEiI,QAAQ,UAAAS,YAAA,kBAAAC,iBAAA,CAAXD,YAAA,CAAazI,IAAI,UAAA0I,iBAAA,iBAAjBA,iBAAA,CAAmBjO,KAAK,IAAIsF,CAAC,SAADA,CAAC,iBAADA,CAAC,CAAEkI,OAAO,GAAI,2BAA2B,CAAC,CAC9E,CACF,CAAC,CAED,KAAM,CAAAU,yBAAyB,CAAI5I,CAAC,EAAK,CACvC;AACA1E,cAAc,CAAC,KAAK,CAAC,CACvB,CAAC,CAEDtE,SAAS,CAAC,IAAM,CACd,GAAI4D,WAAW,CAAE,CACfK,WAAW,CAAC4N,CAAC,EAAArF,aAAA,IACRqF,CAAC,CACJ,CAAC,CACL,CACF,CAAC,CAAE,CAACjO,WAAW,CAAC,CAAC,CAEjB5D,SAAS,CAAC,IAAM,CACd8R,QAAQ,CAACC,KAAK,CAAG,iBAAiB,CAClC;AACA,KAAM,CAAAC,SAAS,CAAG,iBAAiB,CACnC,GAAI,CAAAC,IAAI,CAAGH,QAAQ,CAACI,aAAa,uBAAAvH,MAAA,CAAqBqH,SAAS,CAAE,CAAC,CAClE,GAAI,CAACC,IAAI,CAAE,CACTA,IAAI,CAAGH,QAAQ,CAACK,aAAa,CAAC,MAAM,CAAC,CACrCF,IAAI,CAACG,GAAG,CAAG,MAAM,CACjBH,IAAI,CAACpF,EAAE,CAAGmF,SAAS,CACnBF,QAAQ,CAACO,IAAI,CAACC,WAAW,CAACL,IAAI,CAAC,CACjC,CACA;AACAA,IAAI,CAAC1I,IAAI,CAAG,eAAe,CAC3B0I,IAAI,CAACM,IAAI,CACP,4HAA4H,CAC9H,MAAO,IAAM,CACX;AAAA,CACD,CACH,CAAC,CAAE,EAAE,CAAC,CAEN;AACAvS,SAAS,CAAC,IAAM,CACd,GAAIqF,UAAU,CAAE,CACd,GAAIA,UAAU,CAACkE,IAAI,CAACiJ,UAAU,CAAC,QAAQ,CAAC,EAAInN,UAAU,CAACkE,IAAI,CAACiJ,UAAU,CAAC,QAAQ,CAAC,CAAE,CAChF,KAAM,CAAArH,GAAG,CAAG3B,GAAG,CAACC,eAAe,CAACpE,UAAU,CAAC,CAC3CG,iBAAiB,CAAC2F,GAAG,CAAC,CACtB,MAAO,IAAM3B,GAAG,CAACiJ,eAAe,CAACtH,GAAG,CAAC,CACvC,CAAC,IAAM,CACL3F,iBAAiB,CAAC,IAAI,CAAC,CACzB,CACF,CAAC,IAAM,CACLA,iBAAiB,CAAC,IAAI,CAAC,CACzB,CACF,CAAC,CAAE,CAACH,UAAU,CAAC,CAAC,CAEhB;AACA,KAAM,CAAAqN,iBAAiB,CAAG,KAAO,CAAA3R,CAAC,EAAK,CACrCiF,QAAQ,CAACjF,CAAC,CAAC,CACX+E,iBAAiB,CAAC,KAAK,CAAC,CACxB,GAAI,CACF,KAAM,CAAA5F,KAAK,CAACuR,KAAK,IAAA9G,MAAA,CAAI/J,OAAO,aAAY,CAAEmF,KAAK,CAAE,CAAEiJ,MAAM,CAAEjO,CAAC,CAACiO,MAAM,CAAEC,MAAM,CAAElO,CAAC,CAACkO,MAAO,CAAE,CAAC,CAAE,CACzFrE,OAAO,CAAE,CAAEC,aAAa,WAAAF,MAAA,CAAY7J,KAAK,CAAG,CAC9C,CAAC,CAAC,CACF+C,cAAc,CAAE8O,CAAC,EAAKA,CAAC,CAAAnG,aAAA,CAAAA,aAAA,IAAQmG,CAAC,MAAE5M,KAAK,CAAE,CAAEiJ,MAAM,CAAEjO,CAAC,CAACiO,MAAM,CAAEC,MAAM,CAAElO,CAAC,CAACkO,MAAO,CAAC,GAAK0D,CAAC,CAAC,CACxF,CAAE,MAAAC,QAAA,CAAM,CACN;AAAA,CAEJ,CAAC,CAED;AACA,KAAM,CAAAC,eAAe,CAAArG,aAAA,CAAAA,aAAA,IAAQrM,UAAU,CAAC2S,IAAI,MAAEC,UAAU,CAAEhN,KAAK,CAACiJ,MAAM,EAAE,CACxE,KAAM,CAAAgE,kBAAkB,CAAAxG,aAAA,CAAAA,aAAA,IAAQrM,UAAU,CAAC8S,OAAO,MAAEF,UAAU,CAAEhN,KAAK,CAACkJ,MAAM,EAAE,CAE9E;AACAjP,SAAS,CAAC,IAAM,CACd,KAAM,CAAAkT,OAAO,CAAG,0BAA0B,CAC1C,GAAI,CAACpB,QAAQ,CAACqB,cAAc,CAACD,OAAO,CAAC,CAAE,CACrC,KAAM,CAAAE,KAAK,CAAGtB,QAAQ,CAACK,aAAa,CAAC,OAAO,CAAC,CAC7CiB,KAAK,CAACvG,EAAE,CAAGqG,OAAO,CAClBE,KAAK,CAACC,SAAS,CAAGlT,UAAU,CAACmT,UAAU,CACvCxB,QAAQ,CAACO,IAAI,CAACC,WAAW,CAACc,KAAK,CAAC,CAClC,CACF,CAAC,CAAE,EAAE,CAAC,CAEN;AACA,KAAM,CAACG,QAAQ,CAAEC,WAAW,CAAC,CAAGzT,QAAQ,CAACwI,MAAM,CAACkL,UAAU,EAAI,GAAG,CAAC,CAClEzT,SAAS,CAAC,IAAM,CACd,KAAM,CAAA0T,QAAQ,CAAGA,CAAA,GAAM,CACrB,KAAM,CAAAC,MAAM,CAAGpL,MAAM,CAACkL,UAAU,EAAI,GAAG,CACvCD,WAAW,CAACG,MAAM,CAAC,CACnB;AACA,GAAI,CAACA,MAAM,CAAE,CACX7M,iBAAiB,CAAC,KAAK,CAAC,CAC1B,CACF,CAAC,CACDyB,MAAM,CAACqL,gBAAgB,CAAC,QAAQ,CAAEF,QAAQ,CAAC,CAC3C,MAAO,IAAMnL,MAAM,CAACsL,mBAAmB,CAAC,QAAQ,CAAEH,QAAQ,CAAC,CAC7D,CAAC,CAAE,EAAE,CAAC,CAEN;AACA1T,SAAS,CAAC,IAAM,CACd,KAAM,CAAA8T,kBAAkB,CAAI9K,CAAC,EAAK,CAChC,GAAInC,cAAc,EAAI0M,QAAQ,CAAE,CAC9B;AACA,KAAM,CAAAQ,UAAU,CAAGjC,QAAQ,CAACI,aAAa,CAAC,0BAA0B,CAAC,CACrE,KAAM,CAAA8B,IAAI,CAAGlC,QAAQ,CAACI,aAAa,CAAC,sBAAsB,CAAC,CAE3D,GAAI6B,UAAU,EAAI,CAACA,UAAU,CAACE,QAAQ,CAACjL,CAAC,CAACkL,MAAM,CAAC,EAC5CF,IAAI,EAAI,CAACA,IAAI,CAACC,QAAQ,CAACjL,CAAC,CAACkL,MAAM,CAAC,CAAE,CACpCpN,iBAAiB,CAAC,KAAK,CAAC,CAC1B,CACF,CACF,CAAC,CAED,GAAIyM,QAAQ,EAAI1M,cAAc,CAAE,CAC9B;AACA,KAAM,CAAAsN,KAAK,CAAG1E,UAAU,CAAC,IAAM,CAC7BqC,QAAQ,CAAC8B,gBAAgB,CAAC,YAAY,CAAEE,kBAAkB,CAAC,CAC3DhC,QAAQ,CAAC8B,gBAAgB,CAAC,OAAO,CAAEE,kBAAkB,CAAC,CACxD,CAAC,CAAE,GAAG,CAAC,CAEP,MAAO,IAAM,CACXtE,YAAY,CAAC2E,KAAK,CAAC,CACnBrC,QAAQ,CAAC+B,mBAAmB,CAAC,YAAY,CAAEC,kBAAkB,CAAC,CAC9DhC,QAAQ,CAAC+B,mBAAmB,CAAC,OAAO,CAAEC,kBAAkB,CAAC,CAC3D,CAAC,CACH,CACF,CAAC,CAAE,CAACjN,cAAc,CAAE0M,QAAQ,CAAC,CAAC,CAE9B;AACA,KAAM,CAAAa,YAAY,cAChB3T,KAAA,QAAK2S,KAAK,CAAEjT,UAAU,CAACiU,YAAa,CAACC,SAAS,CAAC,uBAAuB,CAAAC,QAAA,eACpE/T,IAAA,WACE6S,KAAK,CAAEjT,UAAU,CAACoU,aAAc,CAChCF,SAAS,CAAC,yBAAyB,CACnCG,OAAO,CAAGxL,CAAC,EAAK,CACdA,CAAC,CAACyL,eAAe,CAAC,CAAC,CACnB3N,iBAAiB,CAAC,IAAI,CAAC,CACzB,CAAE,CACF,aAAW,0BAAM,CAAAwN,QAAA,cAEjB/T,IAAA,SAAM6S,KAAK,CAAE,CAAEsB,QAAQ,CAAE,EAAG,CAAE,CAAAJ,QAAA,CAAC,QAAC,CAAM,CAAC,CACjC,CAAC,cACT/T,IAAA,QAAK6S,KAAK,CAAE,CACVuB,UAAU,CAAE,GAAG,CACfD,QAAQ,CAAE,EAAE,CACZE,KAAK,CAAE,SAAS,CAChBC,aAAa,CAAE,CAAC,CAChBC,UAAU,CAAE,iBAAiB,CAC7BC,MAAM,CAAE,QACV,CAAE,CAAAT,QAAA,CAAC,+CAEH,CAAK,CAAC,EACH,CACN,CAED;AACA,KAAM,CAAAU,UAAU,CACdnO,cAAc,eACZtG,IAAA,QACE6S,KAAK,CAAEjT,UAAU,CAAC8U,iBAAkB,CACpCZ,SAAS,CAAC,6BAA6B,CACvCG,OAAO,CAAEA,CAAA,GAAM1N,iBAAiB,CAAC,KAAK,CAAE,CAAAwN,QAAA,cAExC7T,KAAA,QACE2S,KAAK,CAAEjT,UAAU,CAAC6U,UAAW,CAC7BX,SAAS,CAAC,qBAAqB,CAC/BG,OAAO,CAAExL,CAAC,EAAIA,CAAC,CAACyL,eAAe,CAAC,CAAE,CAAAH,QAAA,eAElC/T,IAAA,WACE6S,KAAK,CAAEjT,UAAU,CAAC+U,kBAAmB,CACrCV,OAAO,CAAEA,CAAA,GAAM1N,iBAAiB,CAAC,KAAK,CAAE,CACxC,aAAW,4CAAS,CAAAwN,QAAA,CACrB,QAAC,CAAQ,CAAC,cACX/T,IAAA,QAAK6S,KAAK,CAAEjT,UAAU,CAACgV,eAAgB,CAAAb,QAAA,CAAC,sCAAM,CAAK,CAAC,cACpD7T,KAAA,QAAK2S,KAAK,CAAEjT,UAAU,CAACiV,kBAAmB,CAAAd,QAAA,EACvChS,QAAQ,CAAC+S,MAAM,GAAK,CAAC,cACpB9U,IAAA,QAAK6S,KAAK,CAAE,CAAEwB,KAAK,CAAE,SAAS,CAAEU,YAAY,CAAE,CAAE,CAAE,CAAAhB,QAAA,CAAC,sHAEnD,CAAK,CAAC,CAENhS,QAAQ,CAACjB,GAAG,CAAEkU,EAAE,eACdhV,IAAA,QAEE6S,KAAK,CAAEjT,UAAU,CAACqV,WAAW,CAAChT,eAAe,GAAK+S,EAAE,CAAChF,GAAG,CAAE,CAC1DiE,OAAO,CAAGxL,CAAC,EAAK,CACdA,CAAC,CAACyL,eAAe,CAAC,CAAC,CACnBhS,kBAAkB,CAAC8S,EAAE,CAAChF,GAAG,CAAC,CAC1BzJ,iBAAiB,CAAC,KAAK,CAAC,CAC1B,CAAE,CAAAwN,QAAA,CAEDiB,EAAE,CAACnF,IAAI,EARHmF,EAAE,CAAChF,GASL,CACN,CACF,cAEDhQ,IAAA,WACE6S,KAAK,CAAEjT,UAAU,CAACsV,SAAU,CAC5BjB,OAAO,CAAGxL,CAAC,EAAK,CACdA,CAAC,CAACyL,eAAe,CAAC,CAAC,CACnBvR,aAAa,CAAEwS,CAAC,EAAK,CAACA,CAAC,CAAC,CAC1B,CAAE,CAAApB,QAAA,CAEDrR,UAAU,CAAG,iBAAiB,CAAG,eAAe,CAC3C,CAAC,CACRA,UAAU,eACTxC,KAAA,QAAK2S,KAAK,CAAE,CAAEuC,SAAS,CAAE,EAAG,CAAE,CAAArB,QAAA,eAC5B/T,IAAA,UACE6S,KAAK,CAAEjT,UAAU,CAACyC,KAAM,CACxBgT,WAAW,CAAC,uFAAiB,CAC7BlF,KAAK,CAAEvN,UAAW,CAClB0S,QAAQ,CAAE7M,CAAC,EAAI5F,aAAa,CAAC4F,CAAC,CAACkL,MAAM,CAACxD,KAAK,CAAE,CAC7C8D,OAAO,CAAExL,CAAC,EAAIA,CAAC,CAACyL,eAAe,CAAC,CAAE,CACnC,CAAC,cACFlU,IAAA,WACE6S,KAAK,CAAEjT,UAAU,CAACsV,SAAU,CAC5BjB,OAAO,CAAGxL,CAAC,EAAK,CACdA,CAAC,CAACyL,eAAe,CAAC,CAAC,CACnBvE,mBAAmB,CAAC,CAAC,CACrBpJ,iBAAiB,CAAC,KAAK,CAAC,CAC1B,CAAE,CAAAwN,QAAA,CACH,4CAED,CAAQ,CAAC,EACN,CACN,EACE,CAAC,cAEN7T,KAAA,QACE4T,SAAS,CAAC,gCAAgC,CAC1CjB,KAAK,CAAE,CACL0C,OAAO,CAAE,MAAM,CACfC,aAAa,CAAE,KAAK,CACpBC,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAAQ,CACxBC,GAAG,CAAE,EAAE,CACPnB,MAAM,CAAE,eACV,CAAE,CAAAT,QAAA,eAGF/T,IAAA,WACE6S,KAAK,CAAA5G,aAAA,CAAAA,aAAA,IACArM,UAAU,CAACgW,UAAU,MACxBC,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,EAAE,CACV3B,QAAQ,CAAE,EAAE,CACZqB,aAAa,CAAE,QAAQ,CACvBC,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAAQ,EACxB,CACFzB,OAAO,CAAGxL,CAAC,EAAK,CACdA,CAAC,CAACyL,eAAe,CAAC,CAAC,CACnBnQ,cAAc,CAAC,IAAI,CAAC,CACpBwC,iBAAiB,CAAC,KAAK,CAAC,CACxB/C,WAAW,CAAC,KAAK,CAAC,CACpB,CAAE,CACFgO,KAAK,CAAC,4CAAS,CAAAuC,QAAA,cAEf7T,KAAA,QAAK2V,KAAK,CAAC,IAAI,CAACC,MAAM,CAAC,IAAI,CAACC,OAAO,CAAC,WAAW,CAACC,IAAI,CAAC,MAAM,CAAAjC,QAAA,eACzD/T,IAAA,WAAQiW,EAAE,CAAC,IAAI,CAACC,EAAE,CAAC,IAAI,CAACC,CAAC,CAAC,IAAI,CAACH,IAAI,CAAC,SAAS,CAAE,CAAC,cAChDhW,IAAA,WAAQiW,EAAE,CAAC,IAAI,CAACC,EAAE,CAAC,IAAI,CAACC,CAAC,CAAC,GAAG,CAACH,IAAI,CAAC,MAAM,CAAE,CAAC,cAC5ChW,IAAA,YAASiW,EAAE,CAAC,IAAI,CAACC,EAAE,CAAC,IAAI,CAACE,EAAE,CAAC,GAAG,CAACC,EAAE,CAAC,GAAG,CAACL,IAAI,CAAC,MAAM,CAAE,CAAC,EAClD,CAAC,CACA,CAAC,cAEThW,IAAA,WACE6S,KAAK,CAAA5G,aAAA,CAAAA,aAAA,IACArM,UAAU,CAACgW,UAAU,MACxBC,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,EAAE,CACV3B,QAAQ,CAAE,EAAE,CACZqB,aAAa,CAAE,QAAQ,CACvBC,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAAQ,CACxBlD,UAAU,CAAE,MAAM,CAClB8D,MAAM,CAAE,MAAM,CACdC,WAAW,CAAE,CAAC,CACdC,UAAU,CAAE,CAAC,CACbC,SAAS,CAAE,qBAAqB,EAChC,CACFxC,OAAO,CAAGxL,CAAC,EAAK,CACdA,CAAC,CAACyL,eAAe,CAAC,CAAC,CACnB3O,iBAAiB,CAAC,IAAI,CAAC,CACvBgB,iBAAiB,CAAC,KAAK,CAAC,CAC1B,CAAE,CACFiL,KAAK,CAAC,0EAAc,CAAAuC,QAAA,cAEpB7T,KAAA,QAAK2V,KAAK,CAAC,IAAI,CAACC,MAAM,CAAC,IAAI,CAACC,OAAO,CAAC,WAAW,CAACC,IAAI,CAAC,MAAM,CAAAjC,QAAA,eACzD/T,IAAA,WAAQiW,EAAE,CAAC,IAAI,CAACC,EAAE,CAAC,IAAI,CAACC,CAAC,CAAC,IAAI,CAACH,IAAI,CAAC,SAAS,CAAE,CAAC,cAChDhW,IAAA,SAAMsR,CAAC,CAAC,2BAA2B,CAACoF,MAAM,CAAC,MAAM,CAACC,WAAW,CAAC,GAAG,CAAE,CAAC,cACpE3W,IAAA,SAAM4W,CAAC,CAAC,IAAI,CAACC,CAAC,CAAC,GAAG,CAAChB,KAAK,CAAC,GAAG,CAACC,MAAM,CAAC,GAAG,CAACM,EAAE,CAAC,GAAG,CAACJ,IAAI,CAAC,MAAM,CAACU,MAAM,CAAC,SAAS,CAACC,WAAW,CAAC,KAAK,CAAC,CAAC,cAC/F3W,IAAA,SAAM4W,CAAC,CAAC,GAAG,CAACC,CAAC,CAAC,IAAI,CAAChB,KAAK,CAAC,IAAI,CAACC,MAAM,CAAC,GAAG,CAACM,EAAE,CAAC,GAAG,CAACJ,IAAI,CAAC,SAAS,CAACU,MAAM,CAAC,MAAM,CAACC,WAAW,CAAC,KAAK,CAAC,CAAC,EAC7F,CAAC,CACA,CAAC,EACN,CAAC,cACN3W,IAAA,QAAK6S,KAAK,CAAEjT,UAAU,CAACkX,gBAAiB,CAEnC,CAAC,EACH,CAAC,CACH,CAER,CAED,mBACE5W,KAAA,QAAK2S,KAAK,CAAEP,eAAgB,CAACwB,SAAS,CAAC,cAAc,CAAAC,QAAA,EAElDf,QAAQ,EAAIa,YAAY,CAExBb,QAAQ,EAAIyB,UAAU,CAGtB3N,qBAAqB,eACpB9G,IAAA,QAAK6S,KAAK,CAAE,CACVkE,QAAQ,CAAE,OAAO,CACjBC,GAAG,CAAE,EAAE,CACPC,KAAK,CAAE,EAAE,CACTzE,UAAU,CAAE,OAAO,CACnB8D,MAAM,CAAE,gBAAgB,CACxBY,YAAY,CAAE,EAAE,CAChBT,SAAS,CAAE,gCAAgC,CAC3CU,OAAO,CAAE,EAAE,CACXC,QAAQ,CAAE,GAAG,CACbC,MAAM,CAAE,IAAI,CACZC,SAAS,CAAE,uBACb,CAAE,CAAAvD,QAAA,cACA7T,KAAA,QAAK2S,KAAK,CAAE,CACV0C,OAAO,CAAE,MAAM,CACfC,aAAa,CAAE,QAAQ,CACvBG,GAAG,CAAE,EACP,CAAE,CAAA5B,QAAA,eACA/T,IAAA,QAAK6S,KAAK,CAAE,CACVwB,KAAK,CAAE,SAAS,CAChBF,QAAQ,CAAE,EAAE,CACZoD,SAAS,CAAE,QACb,CAAE,CAAAxD,QAAA,CAAC,cAAE,CAAK,CAAC,cACX7T,KAAA,QAAK2S,KAAK,CAAE,CACV2E,SAAS,CAAE,QAAQ,CACnBnD,KAAK,CAAE,MACT,CAAE,CAAAN,QAAA,eACA/T,IAAA,WAAA+T,QAAA,CAASjN,qBAAqB,CAACwE,MAAM,CAAS,CAAC,4IAA2B,cAAApL,KAAA,WAAA6T,QAAA,EAAQ,GAAC,CAACjN,qBAAqB,CAAC4D,OAAO,EAAS,CAAC,EACxH,CAAC,cACNxK,KAAA,QAAK2S,KAAK,CAAE,CACV0C,OAAO,CAAE,MAAM,CACfI,GAAG,CAAE,EACP,CAAE,CAAA5B,QAAA,eACA/T,IAAA,WACE6S,KAAK,CAAE,CACL4E,IAAI,CAAE,CAAC,CACPjF,UAAU,CAAE,SAAS,CACrB6B,KAAK,CAAE,OAAO,CACdiC,MAAM,CAAE,MAAM,CACda,OAAO,CAAE,EAAE,CACXD,YAAY,CAAE,CAAC,CACfQ,MAAM,CAAE,SAAS,CACjBtD,UAAU,CAAE,MACd,CAAE,CACFH,OAAO,CAAE1I,aAAc,CACvBoM,YAAY,CAAGlP,CAAC,EAAKA,CAAC,CAACkL,MAAM,CAACd,KAAK,CAACL,UAAU,CAAG,SAAU,CAC3DoF,YAAY,CAAGnP,CAAC,EAAKA,CAAC,CAACkL,MAAM,CAACd,KAAK,CAACL,UAAU,CAAG,SAAU,CAAAuB,QAAA,CAC5D,sFAED,CAAQ,CAAC,cACT/T,IAAA,WACE6S,KAAK,CAAE,CACL4E,IAAI,CAAE,CAAC,CACPjF,UAAU,CAAE,SAAS,CACrB6B,KAAK,CAAE,OAAO,CACdiC,MAAM,CAAE,MAAM,CACda,OAAO,CAAE,EAAE,CACXD,YAAY,CAAE,CAAC,CACfQ,MAAM,CAAE,SACV,CAAE,CACFzD,OAAO,CAAExI,wBAAyB,CAClCkM,YAAY,CAAGlP,CAAC,EAAKA,CAAC,CAACkL,MAAM,CAACd,KAAK,CAACL,UAAU,CAAG,SAAU,CAC3DoF,YAAY,CAAGnP,CAAC,EAAKA,CAAC,CAACkL,MAAM,CAACd,KAAK,CAACL,UAAU,CAAG,SAAU,CAAAuB,QAAA,CAC5D,wDAED,CAAQ,CAAC,EACN,CAAC,EACH,CAAC,CACH,CACN,CAGAnN,eAAe,eACd5G,IAAA,QAAK6S,KAAK,CAAE,CACVkE,QAAQ,CAAE,OAAO,CACjBC,GAAG,CAAE,CAAC,CACNa,IAAI,CAAE,CAAC,CACPZ,KAAK,CAAE,CAAC,CACRa,MAAM,CAAE,CAAC,CACTtF,UAAU,CAAE,oBAAoB,CAChC6E,MAAM,CAAE,IAAI,CACZ9B,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAClB,CAAE,CAAA3B,QAAA,cACA7T,KAAA,QAAK2S,KAAK,CAAE,CACVgD,KAAK,CAAE,MAAM,CACbC,MAAM,CAAE,MAAM,CACdtD,UAAU,CAAE,SAAS,CACrB0E,YAAY,CAAE,EAAE,CAChBa,QAAQ,CAAE,QAAQ,CAClBxC,OAAO,CAAE,MAAM,CACfC,aAAa,CAAE,QACjB,CAAE,CAAAzB,QAAA,eACA7T,KAAA,QAAK2S,KAAK,CAAE,CACV0C,OAAO,CAAE,MAAM,CACfG,cAAc,CAAE,eAAe,CAC/BD,UAAU,CAAE,QAAQ,CACpB0B,OAAO,CAAE,MAAM,CACf3E,UAAU,CAAE,SAAS,CACrB6B,KAAK,CAAE,OACT,CAAE,CAAAN,QAAA,eACA7T,KAAA,OAAA6T,QAAA,EAAI,sEAAa,CAAC9R,eAAe,EAAK,CAAC,cACvCjC,IAAA,WACE6S,KAAK,CAAE,CACLL,UAAU,CAAE,MAAM,CAClB8D,MAAM,CAAE,MAAM,CACdjC,KAAK,CAAE,OAAO,CACdF,QAAQ,CAAE,EAAE,CACZuD,MAAM,CAAE,SACV,CAAE,CACFzD,OAAO,CAAEzI,YAAa,CAAAuI,QAAA,CACvB,MAAC,CAAQ,CAAC,EACR,CAAC,cAEN7T,KAAA,QAAK2S,KAAK,CAAE,CACV4E,IAAI,CAAE,CAAC,CACPV,QAAQ,CAAE,UAAU,CACpBvE,UAAU,CAAE,MAAM,CAClB+C,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAClB,CAAE,CAAA3B,QAAA,EAEC/M,qBAAqB,CAAC8N,MAAM,CAAG,CAAC,cAC/B9U,IAAA,QAAK6S,KAAK,CAAE,CACV0C,OAAO,CAAE,MAAM,CACfyC,mBAAmB,CAAEhR,qBAAqB,CAAC8N,MAAM,GAAK,CAAC,CAAG,KAAK,CAAG,sCAAsC,CACxGa,GAAG,CAAE,EAAE,CACPE,KAAK,CAAE,MAAM,CACbC,MAAM,CAAE,MAAM,CACdqB,OAAO,CAAE,EACX,CAAE,CAAApD,QAAA,CACC/M,qBAAqB,CAAClG,GAAG,CAAEmX,WAAW,eACrC/X,KAAA,QAA0B2S,KAAK,CAAE,CAC/BkE,QAAQ,CAAE,UAAU,CACpBvE,UAAU,CAAE,MAAM,CAClB0E,YAAY,CAAE,EAAE,CAChBa,QAAQ,CAAE,QAAQ,CAClBxC,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAAQ,CACxBwC,SAAS,CAAE,GACb,CAAE,CAAAnE,QAAA,EACC3M,aAAa,CAAC6Q,WAAW,CAAC3L,EAAE,CAAC,cAC5BtM,IAAA,UACEmY,GAAG,CAAEC,EAAE,EAAI,CACT,GAAIA,EAAE,EAAIhR,aAAa,CAAC6Q,WAAW,CAAC3L,EAAE,CAAC,CAAE,CACvC8L,EAAE,CAAClN,SAAS,CAAG9D,aAAa,CAAC6Q,WAAW,CAAC3L,EAAE,CAAC,CAC9C,CACF,CAAE,CACF+L,QAAQ,MACRxF,KAAK,CAAE,CACLgD,KAAK,CAAE,MAAM,CACbC,MAAM,CAAE,MAAM,CACdwC,SAAS,CAAE,OACb,CAAE,CACH,CAAC,cAEFpY,KAAA,QAAK2S,KAAK,CAAE,CACV0C,OAAO,CAAE,MAAM,CACfC,aAAa,CAAE,QAAQ,CACvBC,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAAQ,CACxBrB,KAAK,CAAE,MACT,CAAE,CAAAN,QAAA,eACA/T,IAAA,QAAK6S,KAAK,CAAE,CAAEsB,QAAQ,CAAE,EAAE,CAAEY,YAAY,CAAE,EAAG,CAAE,CAAAhB,QAAA,CAAC,cAAE,CAAK,CAAC,cACxD/T,IAAA,QAAA+T,QAAA,CAAK,6EAAe,CAAK,CAAC,EACvB,CACN,cACD/T,IAAA,SAAM6S,KAAK,CAAE,CACXkE,QAAQ,CAAE,UAAU,CACpBe,MAAM,CAAE,EAAE,CACVD,IAAI,CAAE,EAAE,CACRrF,UAAU,CAAE,oBAAoB,CAChC6B,KAAK,CAAE,OAAO,CACd8C,OAAO,CAAE,UAAU,CACnBD,YAAY,CAAE,CAAC,CACf/C,QAAQ,CAAE,EACZ,CAAE,CAAAJ,QAAA,CACCkE,WAAW,CAAC3W,QAAQ,CACjB,CAAC,GA/CC2W,WAAW,CAAC3L,EAgDjB,CACN,CAAC,CACC,CAAC,cAENpM,KAAA,QAAK2S,KAAK,CAAE,CACVwB,KAAK,CAAE,MAAM,CACbF,QAAQ,CAAE,EAAE,CACZqD,SAAS,CAAE,QACb,CAAE,CAAAzD,QAAA,eACA/T,IAAA,QAAK6S,KAAK,CAAE,CAAEsB,QAAQ,CAAE,EAAE,CAAEY,YAAY,CAAE,EAAG,CAAE,CAAAhB,QAAA,CAAC,cAAE,CAAK,CAAC,cACxD/T,IAAA,QAAA+T,QAAA,CAAK,kHAAsB,CAAK,CAAC,cACjC/T,IAAA,QAAK6S,KAAK,CAAE,CAAEsB,QAAQ,CAAE,EAAE,CAAEiB,SAAS,CAAE,EAAG,CAAE,CAAArB,QAAA,CAAC,iVAE7C,CAAK,CAAC,EACH,CACN,cAGD7T,KAAA,QAAK2S,KAAK,CAAE,CACVkE,QAAQ,CAAE,UAAU,CACpBC,GAAG,CAAE,EAAE,CACPC,KAAK,CAAE,EAAE,CACTpB,KAAK,CAAE,GAAG,CACVC,MAAM,CAAE,GAAG,CACXtD,UAAU,CAAE,MAAM,CAClB0E,YAAY,CAAE,EAAE,CAChBa,QAAQ,CAAE,QAAQ,CAClBzB,MAAM,CAAE,mBAAmB,CAC3Be,MAAM,CAAE,EACV,CAAE,CAAAtD,QAAA,eACA/T,IAAA,UACEmY,GAAG,CAAEzQ,aAAc,CACnB2Q,QAAQ,MACRE,KAAK,MACL1F,KAAK,CAAE,CACLgD,KAAK,CAAE,MAAM,CACbC,MAAM,CAAE,MAAM,CACdwC,SAAS,CAAE,OACb,CAAE,CACH,CAAC,cACFtY,IAAA,SAAM6S,KAAK,CAAE,CACXkE,QAAQ,CAAE,UAAU,CACpBe,MAAM,CAAE,CAAC,CACTD,IAAI,CAAE,CAAC,CACPrF,UAAU,CAAE,oBAAoB,CAChC6B,KAAK,CAAE,OAAO,CACd8C,OAAO,CAAE,SAAS,CAClBD,YAAY,CAAE,CAAC,CACf/C,QAAQ,CAAE,EACZ,CAAE,CAAAJ,QAAA,CAAC,cAEH,CAAM,CAAC,EACJ,CAAC,EACH,CAAC,cAEN7T,KAAA,QAAK2S,KAAK,CAAE,CACV0C,OAAO,CAAE,MAAM,CACfG,cAAc,CAAE,QAAQ,CACxBC,GAAG,CAAE,EAAE,CACPwB,OAAO,CAAE,EAAE,CACX3E,UAAU,CAAE,SACd,CAAE,CAAAuB,QAAA,eACA/T,IAAA,WACE6S,KAAK,CAAE,CACLgD,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,EAAE,CACVoB,YAAY,CAAE,KAAK,CACnBZ,MAAM,CAAE,MAAM,CACdjC,KAAK,CAAE,OAAO,CACdF,QAAQ,CAAE,EAAE,CACZuD,MAAM,CAAE,SAAS,CACjBlF,UAAU,CAAElL,OAAO,CAAG,SAAS,CAAG,SAAS,CAC3CkR,UAAU,CAAE,uBACd,CAAE,CACFvE,OAAO,CAAEvI,UAAW,CACpBiM,YAAY,CAAGlP,CAAC,EAAKA,CAAC,CAACkL,MAAM,CAACd,KAAK,CAACL,UAAU,CAAGlL,OAAO,CAAG,SAAS,CAAG,SAAU,CACjFsQ,YAAY,CAAGnP,CAAC,EAAKA,CAAC,CAACkL,MAAM,CAACd,KAAK,CAACL,UAAU,CAAGlL,OAAO,CAAG,SAAS,CAAG,SAAU,CAAAyM,QAAA,CAEhFzM,OAAO,CAAG,IAAI,CAAG,IAAI,CAChB,CAAC,cAETtH,IAAA,WACE6S,KAAK,CAAE,CACLgD,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,EAAE,CACVoB,YAAY,CAAE,KAAK,CACnBZ,MAAM,CAAE,MAAM,CACdjC,KAAK,CAAE,OAAO,CACdF,QAAQ,CAAE,EAAE,CACZuD,MAAM,CAAE,SAAS,CACjBlF,UAAU,CAAEhL,UAAU,CAAG,SAAS,CAAG,SAAS,CAC9CgR,UAAU,CAAE,uBACd,CAAE,CACFvE,OAAO,CAAEpI,WAAY,CACrB8L,YAAY,CAAGlP,CAAC,EAAKA,CAAC,CAACkL,MAAM,CAACd,KAAK,CAACL,UAAU,CAAGhL,UAAU,CAAG,SAAS,CAAG,SAAU,CACpFoQ,YAAY,CAAGnP,CAAC,EAAKA,CAAC,CAACkL,MAAM,CAACd,KAAK,CAACL,UAAU,CAAGhL,UAAU,CAAG,SAAS,CAAG,SAAU,CAAAuM,QAAA,CAEnFvM,UAAU,CAAG,IAAI,CAAG,IAAI,CACnB,CAAC,cAETxH,IAAA,WACE6S,KAAK,CAAE,CACLgD,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,EAAE,CACVoB,YAAY,CAAE,KAAK,CACnBZ,MAAM,CAAE,MAAM,CACdjC,KAAK,CAAE,OAAO,CACdF,QAAQ,CAAE,EAAE,CACZuD,MAAM,CAAE,SAAS,CACjBlF,UAAU,CAAE,SAAS,CACrBgG,UAAU,CAAE,uBACd,CAAE,CACFvE,OAAO,CAAEzI,YAAa,CACtBmM,YAAY,CAAGlP,CAAC,EAAKA,CAAC,CAACkL,MAAM,CAACd,KAAK,CAACL,UAAU,CAAG,SAAU,CAC3DoF,YAAY,CAAGnP,CAAC,EAAKA,CAAC,CAACkL,MAAM,CAACd,KAAK,CAACL,UAAU,CAAG,SAAU,CAAAuB,QAAA,CAC5D,cAED,CAAQ,CAAC,EACN,CAAC,EACH,CAAC,CACH,CACN,CAGA,CAACf,QAAQ,eACR9S,KAAA,QAAK2S,KAAK,CAAEjT,UAAU,CAAC6Y,OAAQ,CAAC3E,SAAS,CAAC,iBAAiB,CAAAC,QAAA,eACzD/T,IAAA,QAAK6S,KAAK,CAAEjT,UAAU,CAAC8Y,YAAa,CAAA3E,QAAA,CAAC,+CAAe,CAAK,CAAC,cAC1D7T,KAAA,QAAK2S,KAAK,CAAEjT,UAAU,CAAC+Y,WAAY,CAAC7E,SAAS,CAAC,sBAAsB,CAAAC,QAAA,eAClE/T,IAAA,QAAK6S,KAAK,CAAE,CAAEuB,UAAU,CAAE,GAAG,CAAEC,KAAK,CAAE,MAAM,CAAEU,YAAY,CAAE,EAAG,CAAE,CAAAhB,QAAA,CAAC,sCAAM,CAAK,CAAC,CAC7EhS,QAAQ,CAAC+S,MAAM,GAAK,CAAC,cACpB9U,IAAA,QAAK6S,KAAK,CAAE,CAAEwB,KAAK,CAAE,SAAS,CAAEU,YAAY,CAAE,CAAE,CAAE,CAAAhB,QAAA,CAAC,sHAEnD,CAAK,CAAC,cAEN/T,IAAA,CAAAI,SAAA,EAAA2T,QAAA,CACGhS,QAAQ,CAACjB,GAAG,CAAEkU,EAAE,eACfhV,IAAA,QAEE6S,KAAK,CAAEjT,UAAU,CAACqV,WAAW,CAAChT,eAAe,GAAK+S,EAAE,CAAChF,GAAG,CAAE,CAC1DiE,OAAO,CAAEA,CAAA,GAAM/R,kBAAkB,CAAC8S,EAAE,CAAChF,GAAG,CAAE,CAAA+D,QAAA,CAEzCiB,EAAE,CAACnF,IAAI,EAJHmF,EAAE,CAAChF,GAKL,CACN,CAAC,CACF,CACH,cACDhQ,IAAA,WACE6S,KAAK,CAAEjT,UAAU,CAACsV,SAAU,CAC5BjB,OAAO,CAAEA,CAAA,GAAMtR,aAAa,CAAEwS,CAAC,EAAK,CAACA,CAAC,CAAE,CAAApB,QAAA,CAEvCrR,UAAU,CAAG,iBAAiB,CAAG,eAAe,CAC3C,CAAC,CACRA,UAAU,eACTxC,KAAA,QAAK2S,KAAK,CAAE,CAAEuC,SAAS,CAAE,EAAG,CAAE,CAAArB,QAAA,eAC5B/T,IAAA,UACE6S,KAAK,CAAEjT,UAAU,CAACyC,KAAM,CACxBgT,WAAW,CAAC,uFAAiB,CAC7BlF,KAAK,CAAEvN,UAAW,CAClB0S,QAAQ,CAAE7M,CAAC,EAAI5F,aAAa,CAAC4F,CAAC,CAACkL,MAAM,CAACxD,KAAK,CAAE,CAC9C,CAAC,cACFnQ,IAAA,WAAQ6S,KAAK,CAAEjT,UAAU,CAACsV,SAAU,CAACjB,OAAO,CAAEtE,mBAAoB,CAAAoE,QAAA,CAAC,4CAEnE,CAAQ,CAAC,EACN,CACN,EACE,CAAC,cAEN7T,KAAA,QAAK2S,KAAK,CAAA5G,aAAA,CAAAA,aAAA,IACLrM,UAAU,CAACgZ,aAAa,MAC3Bf,IAAI,CAAE,MAAM,CACZZ,KAAK,CAAE,GAAG,CACVa,MAAM,CAAE,EAAE,CACVvC,OAAO,CAAE,MAAM,CACfC,aAAa,CAAE,KAAK,CACpBC,UAAU,CAAE,QAAQ,CACpBE,GAAG,CAAE,EAAE,CACP0B,MAAM,CAAE,EAAE,EACV,CAAAtD,QAAA,eAEA/T,IAAA,WACE6S,KAAK,CAAEjT,UAAU,CAACgW,UAAW,CAC7B3B,OAAO,CAAEA,CAAA,GAAM,CACblQ,cAAc,CAACoR,CAAC,EAAI,CAACA,CAAC,CAAC,CACvB3R,WAAW,CAAC,KAAK,CAAC,CACpB,CAAE,CACFgO,KAAK,CAAC,4CAAS,CAAAuC,QAAA,cAEf7T,KAAA,QAAK2V,KAAK,CAAC,IAAI,CAACC,MAAM,CAAC,IAAI,CAACC,OAAO,CAAC,WAAW,CAACC,IAAI,CAAC,MAAM,CAAAjC,QAAA,eACzD/T,IAAA,WAAQiW,EAAE,CAAC,IAAI,CAACC,EAAE,CAAC,IAAI,CAACC,CAAC,CAAC,IAAI,CAACH,IAAI,CAAC,SAAS,CAAE,CAAC,cAChDhW,IAAA,WAAQiW,EAAE,CAAC,IAAI,CAACC,EAAE,CAAC,IAAI,CAACC,CAAC,CAAC,GAAG,CAACH,IAAI,CAAC,MAAM,CAAE,CAAC,cAC5ChW,IAAA,YAASiW,EAAE,CAAC,IAAI,CAACC,EAAE,CAAC,IAAI,CAACE,EAAE,CAAC,GAAG,CAACC,EAAE,CAAC,GAAG,CAACL,IAAI,CAAC,MAAM,CAAE,CAAC,EAClD,CAAC,CACA,CAAC,cAEThW,IAAA,WACE6S,KAAK,CAAA5G,aAAA,CAAAA,aAAA,IACArM,UAAU,CAACgW,UAAU,MACxBpD,UAAU,CAAE,MAAM,CAClB8D,MAAM,CAAE,MAAM,CACdC,WAAW,CAAE,CAAC,CACdC,UAAU,CAAE,CAAC,CACbC,SAAS,CAAE,qBAAqB,EAChC,CACFxC,OAAO,CAAEA,CAAA,GAAM1O,iBAAiB,CAAC4P,CAAC,EAAI,CAACA,CAAC,CAAE,CAC1C3D,KAAK,CAAC,0EAAc,CAAAuC,QAAA,cAEpB7T,KAAA,QAAK2V,KAAK,CAAC,IAAI,CAACC,MAAM,CAAC,IAAI,CAACC,OAAO,CAAC,WAAW,CAACC,IAAI,CAAC,MAAM,CAAAjC,QAAA,eACzD/T,IAAA,WAAQiW,EAAE,CAAC,IAAI,CAACC,EAAE,CAAC,IAAI,CAACC,CAAC,CAAC,IAAI,CAACH,IAAI,CAAC,SAAS,CAAE,CAAC,cAChDhW,IAAA,SAAMsR,CAAC,CAAC,2BAA2B,CAACoF,MAAM,CAAC,MAAM,CAACC,WAAW,CAAC,GAAG,CAAE,CAAC,cACpE3W,IAAA,SAAM4W,CAAC,CAAC,IAAI,CAACC,CAAC,CAAC,GAAG,CAAChB,KAAK,CAAC,GAAG,CAACC,MAAM,CAAC,GAAG,CAACM,EAAE,CAAC,GAAG,CAACJ,IAAI,CAAC,MAAM,CAACU,MAAM,CAAC,SAAS,CAACC,WAAW,CAAC,KAAK,CAAC,CAAC,cAC/F3W,IAAA,SAAM4W,CAAC,CAAC,GAAG,CAACC,CAAC,CAAC,IAAI,CAAChB,KAAK,CAAC,IAAI,CAACC,MAAM,CAAC,GAAG,CAACM,EAAE,CAAC,GAAG,CAACJ,IAAI,CAAC,SAAS,CAACU,MAAM,CAAC,MAAM,CAACC,WAAW,CAAC,KAAK,CAAC,CAAC,EAC7F,CAAC,CACA,CAAC,EACN,CAAC,EACH,CACN,cAEDzW,KAAA,QACE2S,KAAK,CAAA5G,aAAA,CAAAA,aAAA,IACArM,UAAU,CAACiZ,aAAa,EACvB7F,QAAQ,CACR,CACE8F,UAAU,CAAE,EAAE,CACdhD,MAAM,CAAE,oBAAoB,CAC5BiD,SAAS,CAAE,oBACb,CAAC,CACD,CAAC,CAAC,CACN,CACFjF,SAAS,CAAC,wBAAwB,CAAAC,QAAA,eAGlC7T,KAAA,QAAK2S,KAAK,CAAE,CACV0C,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAAQ,CACxBG,KAAK,CAAE,MAAM,CACbd,YAAY,CAAE,EAAE,CAChBmD,SAAS,CAAE,EAAE,CACb9C,SAAS,CAAEpC,QAAQ,CAAG,EAAE,CAAG,CAAC,CAC5B+D,QAAQ,CAAE,UACZ,CAAE,CAAAhD,QAAA,eACA/T,IAAA,QAAK6S,KAAK,CAAEjT,UAAU,CAACoZ,SAAU,CAAAjF,QAAA,CAAC,oBAAG,CAAK,CAAC,CAC1C9R,eAAe,eACdjC,IAAA,WACE6S,KAAK,CAAE,CACLkE,QAAQ,CAAE,UAAU,CACpBE,KAAK,CAAEjE,QAAQ,CAAG,EAAE,CAAG,CAAC,CACxBR,UAAU,CAAE,SAAS,CACrB6B,KAAK,CAAE,OAAO,CACdiC,MAAM,CAAE,MAAM,CACdY,YAAY,CAAE,KAAK,CACnBrB,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,EAAE,CACVP,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAAQ,CACxBgC,MAAM,CAAE,SAAS,CACjBc,UAAU,CAAE,uBAAuB,CACnCrE,QAAQ,CAAE,EAAE,CACZsC,SAAS,CAAE,kCACb,CAAE,CACFxC,OAAO,CAAE5I,cAAe,CACxBmG,KAAK,CAAC,yGAAoB,CAC1BmG,YAAY,CAAGlP,CAAC,EAAKA,CAAC,CAACkL,MAAM,CAACd,KAAK,CAACL,UAAU,CAAG,SAAU,CAC3DoF,YAAY,CAAGnP,CAAC,EAAKA,CAAC,CAACkL,MAAM,CAACd,KAAK,CAACL,UAAU,CAAG,SAAU,CAAAuB,QAAA,CAErB,cAExC,CAAQ,CACT,EACE,CAAC,cAEN7T,KAAA,QACE4T,SAAS,CAAC,kBAAkB,CAC5BjB,KAAK,CAAEJ,kBAAmB,CAAAsB,QAAA,EAEzB5R,QAAQ,CAACrB,GAAG,CAAEyJ,GAAG,EAAK,CACrB,KAAM,CAAA0O,MAAM,CAAG1O,GAAG,CAACE,MAAM,GAAKnJ,QAAQ,CACtC;AACA,KAAM,CAAA4X,IAAI,CAAG3O,GAAG,CAAC4O,SAAS,CAAG,GAAI,CAAAvU,IAAI,CAAC2F,GAAG,CAAC4O,SAAS,CAAC,CAACC,kBAAkB,CAAC,EAAE,CAAE,CAAEC,IAAI,CAAE,SAAS,CAAEC,MAAM,CAAE,SAAU,CAAC,CAAC,CAAG,EAAE,CACxH,mBACEtZ,IAAA,QAAmB6S,KAAK,CAAEjT,UAAU,CAAC2Z,UAAU,CAACN,MAAM,CAAE,CAAAlF,QAAA,cACtD7T,KAAA,QAAK2S,KAAK,CAAEjT,UAAU,CAAC+Q,OAAO,CAACsI,MAAM,CAAE,CAAAlF,QAAA,EAEpC,CAACkF,MAAM,eACN/Y,KAAA,SAAM2S,KAAK,CAAEjT,UAAU,CAAC4Z,aAAc,CAAAzF,QAAA,EACnCxJ,GAAG,CAACE,MAAM,CAAC,GACd,EAAM,CACP,CACAF,GAAG,CAACC,IAAI,CAERD,GAAG,CAACI,OAAO,EAAIJ,GAAG,CAACM,QAAQ,eAC1B7K,IAAA,SAAM6S,KAAK,CAAE,CAAE0C,OAAO,CAAE,OAAO,CAAEH,SAAS,CAAE,CAAE,CAAE,CAAArB,QAAA,CAC7CxJ,GAAG,CAACM,QAAQ,CAACoH,UAAU,CAAC,QAAQ,CAAC,cAChCjS,IAAA,UAAOyZ,GAAG,CAAElP,GAAG,CAACI,OAAQ,CAAC+O,QAAQ,MAAC7G,KAAK,CAAE,CAAEuE,QAAQ,CAAE,GAAG,CAAEF,YAAY,CAAE,CAAC,CAAE1E,UAAU,CAAE,SAAU,CAAE,CAAE,CAAC,CACpGjI,GAAG,CAACM,QAAQ,CAACoH,UAAU,CAAC,QAAQ,CAAC,cACnCjS,IAAA,QACEyZ,GAAG,CAAElP,GAAG,CAACI,OAAQ,CACjBgP,GAAG,CAAEpP,GAAG,CAACO,YAAY,EAAI,OAAQ,CACjC+H,KAAK,CAAE,CAAEuE,QAAQ,CAAE,GAAG,CAAE2B,SAAS,CAAE,GAAG,CAAE7B,YAAY,CAAE,CAAC,CAAEQ,MAAM,CAAE,SAAS,CAAEjB,SAAS,CAAE,qBAAsB,CAAE,CAC/GxC,OAAO,CAAEA,CAAA,GAAM9O,aAAa,CAAC,CAAE6D,IAAI,CAAE,OAAO,CAAE4B,GAAG,CAAEL,GAAG,CAACI,OAAO,CAAEkF,IAAI,CAAEtF,GAAG,CAACO,YAAa,CAAC,CAAE,CAC3F,CAAC,CACAP,GAAG,CAACM,QAAQ,CAACoH,UAAU,CAAC,QAAQ,CAAC,cACnCjS,IAAA,UACEyZ,GAAG,CAAElP,GAAG,CAACI,OAAQ,CACjB+O,QAAQ,CAAE,KAAM,CAChB7G,KAAK,CAAE,CAAEuE,QAAQ,CAAE,GAAG,CAAE2B,SAAS,CAAE,GAAG,CAAE7B,YAAY,CAAE,CAAC,CAAEQ,MAAM,CAAE,SAAS,CAAEjB,SAAS,CAAE,qBAAsB,CAAE,CAC/GxC,OAAO,CAAEA,CAAA,GAAM9O,aAAa,CAAC,CAAE6D,IAAI,CAAE,OAAO,CAAE4B,GAAG,CAAEL,GAAG,CAACI,OAAO,CAAEkF,IAAI,CAAEtF,GAAG,CAACO,YAAa,CAAC,CAAE,CAAAiJ,QAAA,CAC3F,qLAED,CAAO,CAAC,cAER;AACA7T,KAAA,SACE2S,KAAK,CAAE,CACL0C,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBE,GAAG,CAAE,CAAC,CACN+B,MAAM,CAAE,SAAS,CACjBlF,UAAU,CAAE,SAAS,CACrB0E,YAAY,CAAE,CAAC,CACfC,OAAO,CAAE,UAAU,CACnBV,SAAS,CAAE,qBAAqB,CAChCW,QAAQ,CAAE,GAAG,CACbwC,QAAQ,CAAE,CAAC,CACXvF,KAAK,CAAE,MACT,CAAE,CACFJ,OAAO,CAAEA,CAAA,GAAM,CACb;AACA,KAAM,CAAA4F,GAAG,CAAG,CAACtP,GAAG,CAACO,YAAY,EAAI,EAAE,EAAErK,KAAK,CAAC,GAAG,CAAC,CAACqZ,GAAG,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CACnE,GAAIxP,GAAG,CAACM,QAAQ,GAAK,iBAAiB,CAAE,CACtC1F,aAAa,CAAC,CAAE6D,IAAI,CAAE,KAAK,CAAE4B,GAAG,CAAEL,GAAG,CAACI,OAAO,CAAEkF,IAAI,CAAEtF,GAAG,CAACO,YAAa,CAAC,CAAC,CAC1E,CAAC,IAAM,CACL3F,aAAa,CAAC,CAAE6D,IAAI,CAAE,KAAK,CAAE4B,GAAG,CAAEL,GAAG,CAACI,OAAO,CAAEkF,IAAI,CAAEtF,GAAG,CAACO,YAAY,CAAE+O,GAAI,CAAC,CAAC,CAC/E,CACF,CAAE,CACFrI,KAAK,CAAEjH,GAAG,CAACO,YAAa,CAAAiJ,QAAA,eAGxB/T,IAAA,SAAM6S,KAAK,CAAE,CAAEsB,QAAQ,CAAE,EAAG,CAAE,CAAAJ,QAAA,CAC3B,CAAC,IAAM,CACN,KAAM,CAAA8F,GAAG,CAAG,CAACtP,GAAG,CAACO,YAAY,EAAI,EAAE,EAAErK,KAAK,CAAC,GAAG,CAAC,CAACqZ,GAAG,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CACnE,GAAIF,GAAG,GAAK,KAAK,CAAE,MAAO,IAAI,CAC9B,GAAI,CAAC,KAAK,CAAE,MAAM,CAAC,CAACG,QAAQ,CAACH,GAAG,CAAC,CAAE,MAAO,IAAI,CAC9C,GAAI,CAAC,KAAK,CAAE,MAAM,CAAC,CAACG,QAAQ,CAACH,GAAG,CAAC,CAAE,MAAO,IAAI,CAC9C,GAAI,CAAC,KAAK,CAAE,MAAM,CAAC,CAACG,QAAQ,CAACH,GAAG,CAAC,CAAE,MAAO,IAAI,CAC9C,GAAI,CAAC,KAAK,CAAE,KAAK,CAAC,CAACG,QAAQ,CAACH,GAAG,CAAC,CAAE,MAAO,IAAI,CAC7C,MAAO,IAAI,CACb,CAAC,EAAE,CAAC,CACA,CAAC,cACP7Z,IAAA,SAAM6S,KAAK,CAAE,CACXsB,QAAQ,CAAE,EAAE,CACZE,KAAK,CAAE,MAAM,CACb4F,SAAS,CAAE,WAAW,CACtBxC,IAAI,CAAE,CAAC,CACPmC,QAAQ,CAAE,CACZ,CAAE,CAAA7F,QAAA,CACCxJ,GAAG,CAACO,YAAY,CACb,CAAC,EACH,CACP,CAEG,CACP,cAED9K,IAAA,QAAK6S,KAAK,CAAE,CAAEwB,KAAK,CAAE,SAAS,CAAEF,QAAQ,CAAE,EAAE,CAAEiB,SAAS,CAAE,CAAC,CAAEoC,SAAS,CAAEyB,MAAM,CAAG,OAAO,CAAG,MAAO,CAAE,CAAAlF,QAAA,CAChGmF,IAAI,CACF,CAAC,EACH,CAAC,EAvFE3O,GAAG,CAACyF,GAwFT,CAAC,CAEV,CAAC,CAAC,cACFhQ,IAAA,QAAKmY,GAAG,CAAE5T,cAAe,CAAE,CAAC,EACzB,CAAC,cAENvE,IAAA,QAAK6S,KAAK,CAAE,CAAEqF,SAAS,CAAE,EAAE,CAAE3C,OAAO,CAAE,MAAM,CAAEE,UAAU,CAAE,UAAU,CAAEV,YAAY,CAAE,CAAE,CAAE,CAAAhB,QAAA,CACrFxR,MAAM,eACLvC,IAAA,QAAK6S,KAAK,CAAA5G,aAAA,CAAAA,aAAA,IACLrM,UAAU,CAAC2C,MAAM,MACpBiS,MAAM,CAAE,CAAC,CACT0F,WAAW,CAAE,CAAC,CACdC,YAAY,CAAE,CAAC,CACf3H,UAAU,CAAE,MAAM,CAClB0E,YAAY,CAAE,CAAC,CACfH,QAAQ,CAAE,UAAU,CACpBM,MAAM,CAAE,CAAC,CACTxB,KAAK,CAAE,aAAa,CACpBuB,QAAQ,CAAE,KAAK,CACfG,SAAS,CAAE,YAAY,CACvBd,SAAS,CAAE,MAAM,EACjB,CAAA1C,QAAA,CACCxR,MAAM,CACJ,CACN,CACE,CAAC,CAELuC,UAAU,eACT5E,KAAA,QACE2S,KAAK,CAAA5G,aAAA,CAAAA,aAAA,IACC+G,QAAQ,CACR,CACE+D,QAAQ,CAAE,OAAO,CACjBc,IAAI,CAAE,CAAC,CACPZ,KAAK,CAAE,CAAC,CACRa,MAAM,CAAE,EAAE,CACVT,MAAM,CAAE,IAAI,CACZ7E,UAAU,CAAE,SAAS,CACrB0E,YAAY,CAAE,eAAe,CAC7BC,OAAO,CAAE,iBAAiB,CAAE;AAC5BC,QAAQ,CAAE,OAAO,CACjBvB,KAAK,CAAE,OAAO,CACdN,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBE,GAAG,CAAE,EAAE,CAAE;AACTc,SAAS,CAAE,mBAAmB,CAC9Bf,cAAc,CAAE,YAAY,CAC5BwC,SAAS,CAAE,EAAI;AACjB,CAAC,CACD,CACE1D,MAAM,CAAE,WAAW,CACnB2C,OAAO,CAAE,UAAU,CACnB3E,UAAU,CAAE,SAAS,CACrB0E,YAAY,CAAE,CAAC,CACf3B,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBE,GAAG,CAAE,EAAE,CACPyB,QAAQ,CAAE,GACZ,CAAC,MACLL,QAAQ,CAAE/D,QAAQ,CAAG,OAAO,CAAGoH,SAAS,EACxC,CAAArG,QAAA,EAGDf,QAAQ,eACPhT,IAAA,WACE6S,KAAK,CAAE,CACLkE,QAAQ,CAAE,UAAU,CACpBc,IAAI,CAAE,CAAC,CACPb,GAAG,CAAE,KAAK,CACVqD,SAAS,CAAE,kBAAkB,CAC7B7H,UAAU,CAAE,MAAM,CAClB8D,MAAM,CAAE,MAAM,CACdjC,KAAK,CAAE,SAAS,CAChBD,UAAU,CAAE,GAAG,CACfD,QAAQ,CAAE,EAAE,CACZuD,MAAM,CAAE,SAAS,CACjBP,OAAO,CAAE,CAAC,CACVE,MAAM,CAAE,CACV,CAAE,CACF7F,KAAK,CAAC,qEAAc,CACpByC,OAAO,CAAEA,CAAA,GAAM,CACblP,aAAa,CAAC,IAAI,CAAC,CACnBE,iBAAiB,CAAC,IAAI,CAAC,CACvB,GAAIT,gBAAgB,CAAC+E,OAAO,CAAE/E,gBAAgB,CAAC+E,OAAO,CAAC4G,KAAK,CAAG,EAAE,CACnE,CAAE,CAAA4D,QAAA,CACH,QAED,CAAQ,CACT,cAED7T,KAAA,QAAK2S,KAAK,CAAE,CACV0C,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBE,GAAG,CAAE,EAAE,CACPE,KAAK,CAAE,MAAM,CACbW,UAAU,CAAExD,QAAQ,CAAG,EAAE,CAAG,CAAG;AACjC,CAAE,CAAAe,QAAA,EACCjP,UAAU,CAACkE,IAAI,CAACiJ,UAAU,CAAC,QAAQ,CAAC,EAAIjN,cAAc,eACrDhF,IAAA,QACEyZ,GAAG,CAAEzU,cAAe,CACpB2U,GAAG,CAAC,SAAS,CACb9G,KAAK,CAAE,CACLuE,QAAQ,CAAEpE,QAAQ,CAAG,EAAE,CAAG,EAAE,CAAE;AAC9B+F,SAAS,CAAE/F,QAAQ,CAAG,EAAE,CAAG,EAAE,CAC7BkE,YAAY,CAAE,CAAC,CACfoB,SAAS,CAAE,OACb,CAAE,CACH,CACF,CACAxT,UAAU,CAACkE,IAAI,CAACiJ,UAAU,CAAC,QAAQ,CAAC,EAAIjN,cAAc,eACrDhF,IAAA,UACEyZ,GAAG,CAAEzU,cAAe,CACpB6N,KAAK,CAAE,CACLuE,QAAQ,CAAEpE,QAAQ,CAAG,EAAE,CAAG,EAAE,CAC5B+F,SAAS,CAAE/F,QAAQ,CAAG,EAAE,CAAG,EAAE,CAC7BkE,YAAY,CAAE,CAAC,CACfoB,SAAS,CAAE,OACb,CAAE,CACFoB,QAAQ,MACT,CACF,CACA,CAAC5U,UAAU,CAACkE,IAAI,CAACiJ,UAAU,CAAC,QAAQ,CAAC,EAAI,CAACnN,UAAU,CAACkE,IAAI,CAACiJ,UAAU,CAAC,QAAQ,CAAC,eAC7EjS,IAAA,SAAMsa,IAAI,CAAC,KAAK,CAAC,aAAW,MAAM,CAACzH,KAAK,CAAE,CAAEsB,QAAQ,CAAEnB,QAAQ,CAAG,EAAE,CAAG,EAAG,CAAE,CAAAe,QAAA,CAAC,cAAE,CAAM,CACrF,cACD/T,IAAA,SACE6S,KAAK,CAAE,CACLwB,KAAK,CAAE,MAAM,CACbF,QAAQ,CAAEnB,QAAQ,CAAG,EAAE,CAAG,EAAE,CAC5BiH,SAAS,CAAE,WAAW,CACtBxC,IAAI,CAAE,CAAC,CACPmC,QAAQ,CAAE,CACZ,CAAE,CAAA7F,QAAA,CAEDjP,UAAU,CAAC+K,IAAI,CACZ,CAAC,CAEN,CAACmD,QAAQ,eACRhT,IAAA,WACE6S,KAAK,CAAE,CACL2D,UAAU,CAAE,MAAM,CAClBhE,UAAU,CAAE,MAAM,CAClB8D,MAAM,CAAE,MAAM,CACdjC,KAAK,CAAE,SAAS,CAChBD,UAAU,CAAE,GAAG,CACfD,QAAQ,CAAE,EAAE,CACZuD,MAAM,CAAE,SAAS,CACjBP,OAAO,CAAE,CACX,CAAE,CACF3F,KAAK,CAAC,qEAAc,CACpByC,OAAO,CAAEA,CAAA,GAAM,CACblP,aAAa,CAAC,IAAI,CAAC,CACnBE,iBAAiB,CAAC,IAAI,CAAC,CACvB,GAAIT,gBAAgB,CAAC+E,OAAO,CAAE/E,gBAAgB,CAAC+E,OAAO,CAAC4G,KAAK,CAAG,EAAE,CACnE,CAAE,CAAA4D,QAAA,CACH,QAED,CAAQ,CACT,EACE,CAAC,EACH,CACN,CAGA9N,SAAS,EAAIE,QAAQ,GACpB6M,QAAQ,cACN9S,KAAA,QAAK2S,KAAK,CAAE,CACVkE,QAAQ,CAAE,OAAO,CACjBc,IAAI,CAAE,CAAC,CACPZ,KAAK,CAAE,CAAC,CACRa,MAAM,CAAE,EAAE,CAAE;AACZT,MAAM,CAAE,IAAI,CACZ7E,UAAU,CAAE,SAAS,CACrB0E,YAAY,CAAE,eAAe,CAC7BC,OAAO,CAAE,qBAAqB,CAC9BC,QAAQ,CAAE,OAAO,CACjBvB,KAAK,CAAE,OAAO,CACdN,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBE,GAAG,CAAE,EAAE,CACPc,SAAS,CAAE,mBAAmB,CAC9Bf,cAAc,CAAE,QAAQ,CACxBwC,SAAS,CAAE,EACb,CAAE,CAAAnE,QAAA,eACA/T,IAAA,UAAOyZ,GAAG,CAAEtT,QAAS,CAACuT,QAAQ,MAAC7G,KAAK,CAAE,CAAEiD,MAAM,CAAE,EAAE,CAAEsB,QAAQ,CAAE,GAAG,CAAEF,YAAY,CAAE,CAAC,CAAE1E,UAAU,CAAE,SAAU,CAAE,CAAE,CAAC,cAC/GxS,IAAA,WACE6S,KAAK,CAAE,CACLL,UAAU,CAAE,SAAS,CACrB6B,KAAK,CAAE,MAAM,CACbiC,MAAM,CAAE,MAAM,CACdY,YAAY,CAAE,CAAC,CACfC,OAAO,CAAE,UAAU,CACnB/C,UAAU,CAAE,GAAG,CACfD,QAAQ,CAAE,EAAE,CACZuD,MAAM,CAAE,SAAS,CACjBlB,UAAU,CAAE,CACd,CAAE,CACFvC,OAAO,CAAEnK,gBAAiB,CAC1B0H,KAAK,CAAC,+GAAqB,CAAAuC,QAAA,CAC5B,QAED,CAAQ,CAAC,cACT/T,IAAA,WACE6S,KAAK,CAAE,CACLL,UAAU,CAAE,MAAM,CAClB6B,KAAK,CAAE,SAAS,CAChBiC,MAAM,CAAE,MAAM,CACdlC,UAAU,CAAE,GAAG,CACfD,QAAQ,CAAE,EAAE,CACZuD,MAAM,CAAE,SACV,CAAE,CACFlG,KAAK,CAAC,iFAAgB,CACtByC,OAAO,CAAEA,CAAA,GAAM,CACb/N,YAAY,CAAC,IAAI,CAAC,CAClBE,WAAW,CAAC,IAAI,CAAC,CACnB,CAAE,CAAA2N,QAAA,CACH,QAED,CAAQ,CAAC,EACN,CAAC,cAEN7T,KAAA,QAAK2S,KAAK,CAAE,CACV0C,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBE,GAAG,CAAE,CAAC,CACNnB,MAAM,CAAE,WAAW,CACnBhC,UAAU,CAAE,SAAS,CACrB0E,YAAY,CAAE,CAAC,CACfC,OAAO,CAAE,UAAU,CACnBC,QAAQ,CAAE,GACZ,CAAE,CAAArD,QAAA,eACA/T,IAAA,UAAOyZ,GAAG,CAAEtT,QAAS,CAACuT,QAAQ,MAAC7G,KAAK,CAAE,CAAEiD,MAAM,CAAE,EAAE,CAAEsB,QAAQ,CAAE,GAAG,CAAEF,YAAY,CAAE,CAAE,CAAE,CAAE,CAAC,cACxFlX,IAAA,WACE6S,KAAK,CAAE,CACLL,UAAU,CAAE,SAAS,CACrB6B,KAAK,CAAE,MAAM,CACbiC,MAAM,CAAE,MAAM,CACdY,YAAY,CAAE,CAAC,CACfC,OAAO,CAAE,UAAU,CACnB/C,UAAU,CAAE,GAAG,CACfD,QAAQ,CAAE,EAAE,CACZuD,MAAM,CAAE,SAAS,CACjBlB,UAAU,CAAE,CACd,CAAE,CACFvC,OAAO,CAAEnK,gBAAiB,CAC1B0H,KAAK,CAAC,+GAAqB,CAAAuC,QAAA,CAC5B,wDAED,CAAQ,CAAC,cACT/T,IAAA,WACE6S,KAAK,CAAE,CACLL,UAAU,CAAE,MAAM,CAClB6B,KAAK,CAAE,SAAS,CAChBiC,MAAM,CAAE,MAAM,CACdlC,UAAU,CAAE,GAAG,CACfD,QAAQ,CAAE,EAAE,CACZuD,MAAM,CAAE,SACV,CAAE,CACFlG,KAAK,CAAC,iFAAgB,CACtByC,OAAO,CAAEA,CAAA,GAAM,CACb/N,YAAY,CAAC,IAAI,CAAC,CAClBE,WAAW,CAAC,IAAI,CAAC,CACnB,CAAE,CAAA2N,QAAA,CACH,QAED,CAAQ,CAAC,EACN,CACN,CACF,cACD7T,KAAA,QACE2S,KAAK,CAAA5G,aAAA,CAAAA,aAAA,IACArM,UAAU,CAAC2a,QAAQ,EAClBvH,QAAQ,CAAG,CAAEmE,OAAO,CAAE,iBAAkB,CAAC,CAAG,CAAC,CAAC,CAClD,CACFrD,SAAS,CAAC,mBAAmB,CAAAC,QAAA,eAG7B/T,IAAA,WACE6S,KAAK,CAAA5G,aAAA,CAAAA,aAAA,IACC7G,cAAc,CAAA6G,aAAA,CAAAA,aAAA,IACTrM,UAAU,CAAC4a,SAAS,EAAK5a,UAAU,CAACwF,cAAc,EACvDxF,UAAU,CAAC4a,SAAS,EACpBxH,QAAQ,CACR,CACE6C,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,EAAE,CACV8D,QAAQ,CAAE,EAAE,CACZ1B,SAAS,CAAE,EAAE,CACb/D,QAAQ,CAAE,EAAE,CACZoC,WAAW,CAAE,CACf,CAAC,CACD,CAAC,CAAC,CACN,CACFvN,IAAI,CAAC,QAAQ,CACbiL,OAAO,CAAEA,CAAA,GAAMzP,gBAAgB,CAAC+E,OAAO,EAAI/E,gBAAgB,CAAC+E,OAAO,CAACkR,KAAK,CAAC,CAAE,CAC5EjJ,KAAK,CAAC,uFAAiB,CACvBkJ,QAAQ,CAAE,CAAC,CAAE,CACb/C,YAAY,CAAEA,CAAA,GAAMtS,iBAAiB,CAAC,IAAI,CAAE,CAC5CuS,YAAY,CAAEA,CAAA,GAAMvS,iBAAiB,CAAC,KAAK,CAAE,CAC7CsV,QAAQ,CAAE,KAAM,CAAA5G,QAAA,cAEhB/T,IAAA,SAAM6S,KAAK,CAAE,CACXwB,KAAK,CAAE,MAAM,CACbF,QAAQ,CAAEnB,QAAQ,CAAG,EAAE,CAAG,EAAE,CAC5BuC,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QACd,CAAE,CAAA1B,QAAA,CAAC,cAAE,CAAM,CAAC,CACN,CAAC,cACT/T,IAAA,UACEmY,GAAG,CAAE3T,gBAAiB,CACtBwE,IAAI,CAAC,MAAM,CACX6J,KAAK,CAAE,CAAE0C,OAAO,CAAE,MAAO,CAAE,CAC3BD,QAAQ,CAAE7M,CAAC,EAAI,KAAAmS,eAAA,CACb,IAAAA,eAAA,CAAInS,CAAC,CAACkL,MAAM,CAACkH,KAAK,UAAAD,eAAA,WAAdA,eAAA,CAAiB,CAAC,CAAC,CAAE7V,aAAa,CAAC0D,CAAC,CAACkL,MAAM,CAACkH,KAAK,CAAC,CAAC,CAAC,CAAC,CAC3D,CAAE,CACH,CAAC,cAEF7a,IAAA,WACE6S,KAAK,CAAA5G,aAAA,CAAAA,aAAA,IACArM,UAAU,CAAC4a,SAAS,MACvBhI,UAAU,CAAE7M,SAAS,CAAG,SAAS,CAAG,MAAM,CAC1C0O,KAAK,CAAE1O,SAAS,CAAG,MAAM,CAAG,MAAM,CAClC4Q,WAAW,CAAE,CAAC,CACdC,UAAU,CAAE,CAAC,CACbF,MAAM,CAAE3Q,SAAS,CAAG,mBAAmB,CAAG,MAAM,EAC5CqN,QAAQ,CACR,CACE6C,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,EAAE,CACV8D,QAAQ,CAAE,EAAE,CACZ1B,SAAS,CAAE,EAAE,CACb/D,QAAQ,CAAE,EACZ,CAAC,CACD,CAAC,CAAC,CACN,CACFnL,IAAI,CAAC,QAAQ,CACbiL,OAAO,CAAEA,CAAA,GAAM,CACb,GAAI,CAACtO,SAAS,CAAEkC,cAAc,CAAC,CAAC,CAAC,IAC5B,CAAA+B,aAAa,CAAC,CAAC,CACtB,CAAE,CACF4H,KAAK,CAAE7L,SAAS,CAAG,mBAAmB,CAAG,oBAAqB,CAC9DgV,QAAQ,CAAE7V,UAAU,EAAImB,SAAU,CAAA8N,QAAA,CAEjCpO,SAAS,cACR3F,IAAA,SAAM6S,KAAK,CAAE,CACXwB,KAAK,CAAE,MAAM,CACbF,QAAQ,CAAEnB,QAAQ,CAAG,EAAE,CAAG,EAAE,CAC5BuC,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QACd,CAAE,CAAA1B,QAAA,CAAC,QAAC,CAAM,CAAC,cAEX/T,IAAA,SAAM6S,KAAK,CAAE,CACXwB,KAAK,CAAE,MAAM,CACbF,QAAQ,CAAEnB,QAAQ,CAAG,EAAE,CAAG,EAAE,CAC5BuC,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QACd,CAAE,CAAA1B,QAAA,CAAC,cAAE,CAAM,CACZ,CACK,CAAC,CAERpO,SAAS,eACR3F,IAAA,SAAM6S,KAAK,CAAE,CACXwB,KAAK,CAAE,SAAS,CAChBD,UAAU,CAAE,GAAG,CACfwF,QAAQ,CAAE5G,QAAQ,CAAG,EAAE,CAAG,EAAE,CAC5BmB,QAAQ,CAAEnB,QAAQ,CAAG,EAAE,CAAG,EAC5B,CAAE,CAAAe,QAAA,IAAA3J,MAAA,CACI0Q,IAAI,CAACC,KAAK,CAAClV,UAAU,CAAG,EAAE,CAAC,CAC5B5E,QAAQ,CAAC,CAAC,CACV+Z,QAAQ,CAAC,CAAC,CAAE,GAAG,CAAC,MAAA5Q,MAAA,CAAI,CAACvE,UAAU,CAAG,EAAE,EAAE5E,QAAQ,CAAC,CAAC,CAAC+Z,QAAQ,CAAC,CAAC,CAAE,GAAG,CAAC,EAChE,CACP,cAEDhb,IAAA,UACE6S,KAAK,CAAA5G,aAAA,CAAAA,aAAA,IACArM,UAAU,CAACyC,KAAK,EACf2Q,QAAQ,CAAG,CAAEmB,QAAQ,CAAE,EAAE,CAAEgD,OAAO,CAAE,UAAW,CAAC,CAAG,CAAC,CAAC,CACzD,CACFhH,KAAK,CAAE9N,KAAM,CACbiT,QAAQ,CAAE7M,CAAC,EAAInG,QAAQ,CAACmG,CAAC,CAACkL,MAAM,CAACxD,KAAK,CAAE,CACxC8K,SAAS,CAAExS,CAAC,EAAI,CACd,GAAIxG,eAAe,CAAE,CACnBqC,SAAS,CAACiF,OAAO,CAACwB,IAAI,CAAC,QAAQ,CAAE,CAAEL,OAAO,CAAEzI,eAAgB,CAAC,CAAC,CAC9D,GAAIwG,CAAC,CAACyS,GAAG,GAAK,OAAO,CAAEhL,UAAU,CAAC,CAAC,CACrC,CACF,CAAE,CACFyK,QAAQ,CAAE,CAAC1Y,eAAgB,CAC3BoT,WAAW,CACTpT,eAAe,CACX,sBAAsB,CACtB,gBACL,CACF,CAAC,cAEFjC,IAAA,WACE6S,KAAK,CAAA5G,aAAA,IACC+G,QAAQ,CACR,CACER,UAAU,CAAE,wCAAwC,CACpD6B,KAAK,CAAE,MAAM,CACbiC,MAAM,CAAE,MAAM,CACdY,YAAY,CAAE,CAAC,CACfrB,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,EAAE,CACV8D,QAAQ,CAAE,EAAE,CACZ1B,SAAS,CAAE,EAAE,CACbf,OAAO,CAAE,CAAC,CACVhD,QAAQ,CAAE,EAAE,CACZoB,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAAQ,CACxBe,SAAS,CAAE,qBAAqB,CAChCD,UAAU,CAAE,CACd,CAAC,CACD5W,UAAU,CAACub,OAAO,CACtB,CACFlH,OAAO,CAAE/D,UAAW,CACpByK,QAAQ,CAAE,CAAC1Y,eAAe,EAAK,CAACI,KAAK,CAACuN,IAAI,CAAC,CAAC,EAAI,CAAC9K,UAAY,CAC7D0M,KAAK,CAAC,wDAAW,CAAAuC,QAAA,CAEhBf,QAAQ,cACLhT,IAAA,SAAM6S,KAAK,CAAE,CAAEsB,QAAQ,CAAE,EAAE,CAAEE,KAAK,CAAE,MAAO,CAAE,CAAAN,QAAA,CAAC,QAAC,CAAM,CAAC,CACtD,WAAW,CACT,CAAC,EACN,CAAC,CAEL7O,UAAU,eACTlF,IAAA,QACE6S,KAAK,CAAE,CACLkE,QAAQ,CAAE,OAAO,CACjBc,IAAI,CAAE,CAAC,CACPb,GAAG,CAAE,CAAC,CACNnB,KAAK,CAAE,OAAO,CACdC,MAAM,CAAE,OAAO,CACftD,UAAU,CAAE,iBAAiB,CAC7B6E,MAAM,CAAE,IAAI,CACZ9B,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAClB,CAAE,CACFzB,OAAO,CAAEA,CAAA,GAAM9O,aAAa,CAAC,IAAI,CAAE,CAAA4O,QAAA,cAEnC7T,KAAA,QACE2S,KAAK,CAAE,CACLL,UAAU,CAAE,SAAS,CACrB0E,YAAY,CAAE,EAAE,CAChBC,OAAO,CAAE,EAAE,CACXC,QAAQ,CAAE,MAAM,CAChB2B,SAAS,CAAE,MAAM,CACjBtC,SAAS,CAAE,kBAAkB,CAC7BlB,OAAO,CAAE,MAAM,CACfC,aAAa,CAAE,QAAQ,CACvBC,UAAU,CAAE,QAAQ,CACpBsB,QAAQ,CAAE,UACZ,CAAE,CACF9C,OAAO,CAAExL,CAAC,EAAIA,CAAC,CAACyL,eAAe,CAAC,CAAE,CAAAH,QAAA,eAElC/T,IAAA,WACE6S,KAAK,CAAE,CACLkE,QAAQ,CAAE,UAAU,CACpBC,GAAG,CAAE,CAAC,CACNC,KAAK,CAAE,EAAE,CACTzE,UAAU,CAAE,MAAM,CAClB8D,MAAM,CAAE,MAAM,CACdjC,KAAK,CAAE,MAAM,CACbF,QAAQ,CAAE,EAAE,CACZC,UAAU,CAAE,GAAG,CACfsD,MAAM,CAAE,SAAS,CACjBL,MAAM,CAAE,CACV,CAAE,CACFpD,OAAO,CAAEA,CAAA,GAAM9O,aAAa,CAAC,IAAI,CAAE,CACnCqM,KAAK,CAAC,4CAAS,CAAAuC,QAAA,CAChB,QAAC,CAAQ,CAAC,CACV7O,UAAU,CAAC8D,IAAI,GAAK,OAAO,cAC1B9I,KAAA,CAAAE,SAAA,EAAA2T,QAAA,eACE/T,IAAA,QACEyZ,GAAG,CAAEvU,UAAU,CAAC0F,GAAI,CACpB+O,GAAG,CAAEzU,UAAU,CAAC2K,IAAK,CACrBgD,KAAK,CAAE,CAAEuE,QAAQ,CAAE,MAAM,CAAE2B,SAAS,CAAE,MAAM,CAAE7B,YAAY,CAAE,EAAE,CAAEnC,YAAY,CAAE,EAAG,CAAE,CACpF,CAAC,CAED7P,UAAU,CAAC2K,IAAI,eACd7P,IAAA,QAAK6S,KAAK,CAAE,CACVwB,KAAK,CAAE,MAAM,CACbF,QAAQ,CAAE,EAAE,CACZY,YAAY,CAAE,EAAE,CAChBkF,SAAS,CAAE,WAAW,CACtBzC,SAAS,CAAE,QAAQ,CACnBJ,QAAQ,CAAE,MACZ,CAAE,CAAArD,QAAA,CACC7O,UAAU,CAAC2K,IAAI,CACb,CACN,EACD,CAAC,CACD3K,UAAU,CAAC8D,IAAI,GAAK,OAAO,cAC7BhJ,IAAA,UACEyZ,GAAG,CAAEvU,UAAU,CAAC0F,GAAI,CACpB8O,QAAQ,MACRrB,QAAQ,MACRxF,KAAK,CAAE,CAAEuE,QAAQ,CAAE,MAAM,CAAE2B,SAAS,CAAE,MAAM,CAAE7B,YAAY,CAAE,EAAE,CAAEnC,YAAY,CAAE,EAAE,CAAEvC,UAAU,CAAE,MAAO,CAAE,CACxG,CAAC,CACAtN,UAAU,CAAC8D,IAAI,GAAK,KAAK,cAC3BhJ,IAAA,WACEyZ,GAAG,CAAEvU,UAAU,CAAC0F,GAAI,CACpB4G,KAAK,CAAEtM,UAAU,CAAC2K,IAAK,CACvBgD,KAAK,CAAE,CACLgD,KAAK,CAAE,MAAM,CACbC,MAAM,CAAE,MAAM,CACdQ,MAAM,CAAE,MAAM,CACdY,YAAY,CAAE,EAAE,CAChB1E,UAAU,CAAE,MAAM,CAClBuC,YAAY,CAAE,EAChB,CAAE,CACH,CAAC,CACA7P,UAAU,CAAC8D,IAAI,GAAK,KAAK,cAC3B9I,KAAA,QAAK2S,KAAK,CAAE,CACV0C,OAAO,CAAE,MAAM,CACfC,aAAa,CAAE,QAAQ,CACvBC,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAAQ,CACxBwC,SAAS,CAAE,GAAG,CACd0B,QAAQ,CAAE,GAAG,CACb7E,YAAY,CAAE,EAChB,CAAE,CAAAhB,QAAA,eACA/T,IAAA,SAAM6S,KAAK,CAAE,CAAEsB,QAAQ,CAAE,EAAE,CAAEY,YAAY,CAAE,EAAG,CAAE,CAAAhB,QAAA,CAC7C,CAAC,IAAM,CACN,KAAM,CAAA8F,GAAG,CAAG,CAAC3U,UAAU,CAAC2U,GAAG,EAAI,EAAE,EAAEE,WAAW,CAAC,CAAC,CAChD,GAAIF,GAAG,GAAK,KAAK,CAAE,MAAO,IAAI,CAC9B,GAAI,CAAC,KAAK,CAAE,MAAM,CAAC,CAACG,QAAQ,CAACH,GAAG,CAAC,CAAE,MAAO,IAAI,CAC9C,GAAI,CAAC,KAAK,CAAE,MAAM,CAAC,CAACG,QAAQ,CAACH,GAAG,CAAC,CAAE,MAAO,IAAI,CAC9C,GAAI,CAAC,KAAK,CAAE,MAAM,CAAC,CAACG,QAAQ,CAACH,GAAG,CAAC,CAAE,MAAO,IAAI,CAC9C,GAAI,CAAC,KAAK,CAAE,KAAK,CAAC,CAACG,QAAQ,CAACH,GAAG,CAAC,CAAE,MAAO,IAAI,CAC7C,MAAO,IAAI,CACb,CAAC,EAAE,CAAC,CACA,CAAC,cACP7Z,IAAA,QAAK6S,KAAK,CAAE,CAAEwB,KAAK,CAAE,MAAM,CAAEF,QAAQ,CAAE,EAAE,CAAEY,YAAY,CAAE,CAAC,CAAEkF,SAAS,CAAE,WAAW,CAAEzC,SAAS,CAAE,QAAS,CAAE,CAAAzD,QAAA,CACvG7O,UAAU,CAAC2K,IAAI,CACb,CAAC,cACN7P,IAAA,QAAK6S,KAAK,CAAE,CAAEwB,KAAK,CAAE,SAAS,CAAEF,QAAQ,CAAE,EAAE,CAAEY,YAAY,CAAE,EAAG,CAAE,CAAAhB,QAAA,CAAC,iPAElE,CAAK,CAAC,EACH,CAAC,CACJ,IAAI,cACR/T,IAAA,WACE6S,KAAK,CAAE,CACLL,UAAU,CAAE,wCAAwC,CACpD6B,KAAK,CAAE,MAAM,CACbiC,MAAM,CAAE,MAAM,CACdY,YAAY,CAAE,CAAC,CACfC,OAAO,CAAE,WAAW,CACpB/C,UAAU,CAAE,GAAG,CACfD,QAAQ,CAAE,EAAE,CACZuD,MAAM,CAAE,SAAS,CACjBjB,SAAS,CAAE,qBAAqB,CAChC2E,cAAc,CAAE,MAClB,CAAE,CACFnH,OAAO,CAAE,KAAM,CAAAxL,CAAC,EAAI,CAClBA,CAAC,CAACyL,eAAe,CAAC,CAAC,CACnB,GAAI,CACF,KAAM,CAAAxD,QAAQ,CAAG,KAAM,CAAA2K,KAAK,CAACnW,UAAU,CAAC0F,GAAG,CAAE,CAAE0Q,WAAW,CAAE,aAAc,CAAC,CAAC,CAC5E,KAAM,CAAAxS,IAAI,CAAG,KAAM,CAAA4H,QAAQ,CAAC5H,IAAI,CAAC,CAAC,CAClC,KAAM,CAAA8B,GAAG,CAAG5C,MAAM,CAACiB,GAAG,CAACC,eAAe,CAACJ,IAAI,CAAC,CAC5C,KAAM,CAAAyS,CAAC,CAAGhK,QAAQ,CAACK,aAAa,CAAC,GAAG,CAAC,CACrC2J,CAAC,CAACvJ,IAAI,CAAGpH,GAAG,CACZ2Q,CAAC,CAACC,QAAQ,CAAGtW,UAAU,CAAC2K,IAAI,EAAI,MAAM,CACtC0B,QAAQ,CAACkK,IAAI,CAAC1J,WAAW,CAACwJ,CAAC,CAAC,CAC5BA,CAAC,CAACd,KAAK,CAAC,CAAC,CACTvL,UAAU,CAAC,IAAM,CACflH,MAAM,CAACiB,GAAG,CAACiJ,eAAe,CAACtH,GAAG,CAAC,CAC/B2Q,CAAC,CAACG,MAAM,CAAC,CAAC,CACZ,CAAC,CAAE,GAAG,CAAC,CACT,CAAE,MAAO/R,GAAG,CAAE,CACZzB,KAAK,CAAC,yBAAyB,CAAC,CAClC,CACF,CAAE,CAAA6L,QAAA,CACH,4CAED,CAAQ,CAAC,EACN,CAAC,CACH,CACN,EACE,CAAC,CAELjQ,WAAW,eACV9D,IAAA,QACE6S,KAAK,CAAE,CACLkE,QAAQ,CAAE,OAAO,CACjBc,IAAI,CAAE,CAAC,CACPb,GAAG,CAAE,CAAC,CACNnB,KAAK,CAAE,OAAO,CACdC,MAAM,CAAE,OAAO,CACftD,UAAU,CAAE,kBAAkB,CAC9B6E,MAAM,CAAE,EAAE,CACVmB,UAAU,CAAE,iBAAiB,CAC7BjD,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAClB,CAAE,CACFzB,OAAO,CAAE5C,yBAA0B,CAAA0C,QAAA,cAEnC7T,KAAA,QACE2S,KAAK,CAAA5G,aAAA,CAAAA,aAAA,CAAAA,aAAA,IACArM,UAAU,CAAC+b,YAAY,EACtB3I,QAAQ,CACR,CACE+D,QAAQ,CAAE,OAAO,CACjBc,IAAI,CAAE,KAAK,CACXb,GAAG,CAAE,KAAK,CACVqD,SAAS,CAAE,uBAAuB,CAClCxE,KAAK,CAAE,MAAM,CACbuB,QAAQ,CAAE,GAAG,CACbwC,QAAQ,CAAE,CAAC,CACX9D,MAAM,CAAE,MAAM,CACdiD,SAAS,CAAE,MAAM,CACjBb,SAAS,CAAE,GAAG,CACdhB,YAAY,CAAE,EAAE,CAChBC,OAAO,CAAE,kBAAkB,CAC3BV,SAAS,CAAE,sBAAsB,CACjCtC,QAAQ,CAAE,EAAE,CACZoB,OAAO,CAAE,MAAM,CACfC,aAAa,CAAE,QAAQ,CACvBC,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,YAClB,CAAC,CACD,CACE2E,SAAS,CAAEvW,WAAW,CAAG,eAAe,CAAG,kBAAkB,CAC7D8X,OAAO,CAAE9X,WAAW,CAAG,CAAC,CAAG,CAAC,CAC5B+X,aAAa,CAAE/X,WAAW,CAAG,MAAM,CAAG,MACxC,CAAC,MACL0U,UAAU,CAAE,0DAA0D,EACtE,CACF1E,SAAS,CAAC,uBAAuB,CACjCG,OAAO,CAAExL,CAAC,EAAIA,CAAC,CAACyL,eAAe,CAAC,CAAE,CAAAH,QAAA,EAGjCf,QAAQ,eACP9S,KAAA,QAAK2S,KAAK,CAAE,CACVkE,QAAQ,CAAE,QAAQ,CAClBC,GAAG,CAAE,CAAC,CACNa,IAAI,CAAE,CAAC,CACPhC,KAAK,CAAE,MAAM,CACbrD,UAAU,CAAE,SAAS,CACrB6E,MAAM,CAAE,CAAC,CACT9B,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAAQ,CACxByB,OAAO,CAAE,WAAW,CACpBe,SAAS,CAAE,EAAE,CACbnD,YAAY,CAAE,CAChB,CAAE,CAAAhB,QAAA,eACA/T,IAAA,QAAK6S,KAAK,CAAE,CAAEuB,UAAU,CAAE,GAAG,CAAED,QAAQ,CAAE,EAAE,CAAEE,KAAK,CAAE,SAAS,CAAEoD,IAAI,CAAE,CAAC,CAAED,SAAS,CAAE,QAAS,CAAE,CAAAzD,QAAA,CAAC,4CAAO,CAAK,CAAC,cAE5G/T,IAAA,WACE6S,KAAK,CAAA5G,aAAA,CAAAA,aAAA,IACArM,UAAU,CAACkc,eAAe,MAC7B/E,QAAQ,CAAE,QAAQ,CAClBE,KAAK,CAAE,CAAC,CACRD,GAAG,CAAE,CAAC,CACNnB,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,EAAE,CACV3B,QAAQ,CAAE,EAAE,CACZoC,WAAW,CAAE,CAAC,CACdnB,SAAS,CAAE,CAAC,CACZL,YAAY,CAAE,CAAC,CACfvC,UAAU,CAAE,MAAM,CAClB6B,KAAK,CAAE,SAAS,CAChBoC,SAAS,CAAE,MAAM,EACjB,CACFxC,OAAO,CAAEA,CAAA,GAAMlQ,cAAc,CAAC,KAAK,CAAE,CACrCyN,KAAK,CAAC,4CAAS,CAAAuC,QAAA,CAChB,QAAC,CAAQ,CAAC,EAER,CACN,cAED/T,IAAA,QACE6S,KAAK,CAAA5G,aAAA,CAAAA,aAAA,IACArM,UAAU,CAACmc,aAAa,EACvB/I,QAAQ,CACR,CAAE6C,KAAK,CAAE,EAAE,CAAEC,MAAM,CAAE,EAAE,CAAEtB,MAAM,CAAE,mBAAmB,CAAEL,QAAQ,CAAE,EAAG,CAAC,CACpE,CAAC,CAAC,CACN,CACFL,SAAS,CAAC,wBAAwB,CAAAC,QAAA,cAElC7T,KAAA,QACE2S,KAAK,CAAE,CACLkE,QAAQ,CAAE,UAAU,CACpBlB,KAAK,CAAE7C,QAAQ,CAAG,EAAE,CAAG,EAAE,CACzB8C,MAAM,CAAE9C,QAAQ,CAAG,EAAE,CAAG,EAAE,CAC1BkE,YAAY,CAAE,KAAK,CACnBa,QAAQ,CAAE,QAAQ,CAClBL,MAAM,CAAE,SAAS,CACjBpB,MAAM,CAAE,mBAAmB,CAC3B9B,MAAM,CAAE,QAAQ,CAChBhC,UAAU,CAAE,SAAS,CACrB+C,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAClB,CAAE,CACFzB,OAAO,CAAEA,CAAA,GAAMxP,kBAAkB,CAAC8E,OAAO,EAAI9E,kBAAkB,CAAC8E,OAAO,CAACkR,KAAK,CAAC,CAAE,CAChFjJ,KAAK,CAAC,2EAAe,CAAAuC,QAAA,EAGpB1Q,WAAW,SAAXA,WAAW,WAAXA,WAAW,CAAE2Y,SAAS,EACrB3Y,WAAW,CAAC2Y,SAAS,GAAK,6BAA6B,cACvDhc,IAAA,QAEEyZ,GAAG,CACDpW,WAAW,CAAC2Y,SAAS,CACjB3Y,WAAW,CAAC2Y,SAAS,CAAG,KAAK,CAAGtX,aAAa,CAC7C,6BACL,CACDiV,GAAG,CAAC,QAAQ,CACZ9G,KAAK,CAAE,CACLgD,KAAK,CAAE7C,QAAQ,CAAG,EAAE,CAAG,EAAE,CACzB8C,MAAM,CAAE9C,QAAQ,CAAG,EAAE,CAAG,EAAE,CAC1BkE,YAAY,CAAE,KAAK,CACnBoB,SAAS,CAAE,OAAO,CAClB/C,OAAO,CAAE,OACX,CAAE,CACF0G,OAAO,CAAExT,CAAC,EAAI,CACZA,CAAC,CAACkL,MAAM,CAACuI,OAAO,CAAG,IAAI,CACvBzT,CAAC,CAACkL,MAAM,CAAC8F,GAAG,IAAArP,MAAA,CACPpC,MAAM,CAACmU,QAAQ,CAACC,QAAQ,OAAAhS,MAAA,CAAKpC,MAAM,CAACmU,QAAQ,CAACE,QAAQ,oCAAkC,CAC9F,CAAE,EAlBGhZ,WAAW,CAAC2Y,SAAS,CAAGtX,aAmB9B,CAAC,cAEF;AACA1E,IAAA,QACEyZ,GAAG,CAAE,6BAA8B,CACnCE,GAAG,CAAC,QAAQ,CACZ9G,KAAK,CAAE,CACLgD,KAAK,CAAE7C,QAAQ,CAAG,EAAE,CAAG,EAAE,CACzB8C,MAAM,CAAE9C,QAAQ,CAAG,EAAE,CAAG,EAAE,CAC1BkE,YAAY,CAAE,KAAK,CACnBoB,SAAS,CAAE,OAAO,CAClB/C,OAAO,CAAE,OACX,CAAE,CACF0G,OAAO,CAAExT,CAAC,EAAI,CACZA,CAAC,CAACkL,MAAM,CAACuI,OAAO,CAAG,IAAI,CACvBzT,CAAC,CAACkL,MAAM,CAAC8F,GAAG,CACV,mCAAmC,CACnC6C,kBAAkB,CAAC,CAAAjZ,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAE/B,QAAQ,GAAI,GAAG,CAAC,CAChD,sCAAsC,CAC1C,CAAE,CACH,CACF,cACDtB,IAAA,UACEmY,GAAG,CAAE1T,kBAAmB,CACxBuE,IAAI,CAAC,MAAM,CACXuT,MAAM,CAAC,SAAS,CAChB1J,KAAK,CAAE,CAAE0C,OAAO,CAAE,MAAO,CAAE,CAC3BD,QAAQ,CAAE,KAAM,CAAA7M,CAAC,EAAI,KAAA+T,gBAAA,CACnB,GAAI,GAAAA,gBAAA,CAAC/T,CAAC,CAACkL,MAAM,CAACkH,KAAK,UAAA2B,gBAAA,WAAdA,gBAAA,CAAiB,CAAC,CAAC,EAAE,OAC1B,KAAM,CAAAzS,QAAQ,CAAG,GAAI,CAAAC,QAAQ,CAAC,CAAC,CAC/BD,QAAQ,CAACE,MAAM,CAAC,MAAM,CAAExB,CAAC,CAACkL,MAAM,CAACkH,KAAK,CAAC,CAAC,CAAC,CAAC,CAC1C,KAAM,CAAA3Q,SAAS,CAAG,KAAM,CAAAvK,KAAK,CAACwK,IAAI,IAAAC,MAAA,CAC7B/J,OAAO,qBACV0J,QAAQ,CACR,CACEM,OAAO,CAAE,CAAEC,aAAa,WAAAF,MAAA,CAAY7J,KAAK,CAAG,CAC9C,CACF,CAAC,CACD,KAAM,CAAAZ,KAAK,CAACuR,KAAK,IAAA9G,MAAA,CACZ/J,OAAO,aACV,CAAE2b,SAAS,CAAE9R,SAAS,CAACxB,IAAI,CAACkC,GAAI,CAAC,CACjC,CAAEP,OAAO,CAAE,CAAEC,aAAa,WAAAF,MAAA,CAAY7J,KAAK,CAAG,CAAE,CAClD,CAAC,CACD,KAAM,CAAAkc,UAAU,CAAG,KAAM,CAAA9c,KAAK,CAAC6O,GAAG,IAAApE,MAAA,CAAI/J,OAAO,aAAY,CACvDgK,OAAO,CAAE,CAAEC,aAAa,WAAAF,MAAA,CAAY7J,KAAK,CAAG,CAC9C,CAAC,CAAC,CACF+C,cAAc,CAACmZ,UAAU,CAAC/T,IAAI,CAAC,CAC/B/D,gBAAgB,CAACC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAC,CAC9B,CAAE,CACH,CAAC,EACC,CAAC,CACH,CAAC,cAEN3E,KAAA,QAAK2S,KAAK,CAAA5G,aAAA,EACRwL,IAAI,CAAE,CAAC,CACPiF,SAAS,CAAE,MAAM,CACjBxE,SAAS,CAAE,CAAC,CACZnD,YAAY,CAAE,EAAE,CAChBQ,OAAO,CAAE,MAAM,CACfC,aAAa,CAAE,QAAQ,CACvBE,cAAc,CAAE,YAAY,EACxB1C,QAAQ,CAAG,CAAEmE,OAAO,CAAE,OAAQ,CAAC,CAAG,CAAC,CAAC,CACxC,CAAApD,QAAA,EACC1Q,WAAW,EAAI,CAACE,QAAQ,eACvBrD,KAAA,CAAAE,SAAA,EAAA2T,QAAA,EACG,CAACf,QAAQ,eACRhT,IAAA,QAAK6S,KAAK,CAAEjT,UAAU,CAAC+c,YAAa,CAAC7I,SAAS,CAAC,uBAAuB,CAAAC,QAAA,CAAC,4CAAO,CAAK,CACpF,cACD7T,KAAA,QAAK2S,KAAK,CAAEjT,UAAU,CAACgd,YAAa,CAAA7I,QAAA,eAClC/T,IAAA,SAAM6S,KAAK,CAAEjT,UAAU,CAACid,YAAa,CAAA9I,QAAA,CAAC,qBAAI,CAAM,CAAC,IAAC,CAAC1Q,WAAW,CAAC/B,QAAQ,EACpE,CAAC,cACNpB,KAAA,QAAK2S,KAAK,CAAEjT,UAAU,CAACgd,YAAa,CAAA7I,QAAA,eAClC/T,IAAA,SAAM6S,KAAK,CAAEjT,UAAU,CAACid,YAAa,CAAA9I,QAAA,CAAC,6CAAQ,CAAM,CAAC,IAAC,EAAAtS,gBAAA,CAAC4B,WAAW,CAACQ,GAAG,UAAApC,gBAAA,UAAAA,gBAAA,CAAI,GAAG,EAC1E,CAAC,cACNvB,KAAA,QAAK2S,KAAK,CAAEjT,UAAU,CAACgd,YAAa,CAAA7I,QAAA,eAClC/T,IAAA,SAAM6S,KAAK,CAAEjT,UAAU,CAACid,YAAa,CAAA9I,QAAA,CAAC,iCAAM,CAAM,CAAC,IAAC,EAAArS,iBAAA,CAAC2B,WAAW,CAACM,IAAI,UAAAjC,iBAAA,UAAAA,iBAAA,CAAI,GAAG,EACzE,CAAC,cACNxB,KAAA,QAAK2S,KAAK,CAAEjT,UAAU,CAACgd,YAAa,CAAA7I,QAAA,eAClC/T,IAAA,SAAM6S,KAAK,CAAEjT,UAAU,CAACid,YAAa,CAAA9I,QAAA,CAAC,wFAAgB,CAAM,CAAC,IAAC,EAAApS,mBAAA,CAAC0B,WAAW,CAACO,MAAM,UAAAjC,mBAAA,UAAAA,mBAAA,CAAI,GAAG,EACrF,CAAC,cAENzB,KAAA,QAAK2S,KAAK,CAAE,CACV0C,OAAO,CAAE,MAAM,CACfI,GAAG,CAAE,CAAC,CACNP,SAAS,CAAE,EAAE,CACbM,cAAc,CAAE,UAAU,CAC1BoH,QAAQ,CAAE9J,QAAQ,CAAG,MAAM,CAAG,QAChC,CAAE,CAAAe,QAAA,eACA/T,IAAA,WACE6S,KAAK,CAAA5G,aAAA,CAAAA,aAAA,IACArM,UAAU,CAACmd,cAAc,EACxB/J,QAAQ,CAAG,CAAEmB,QAAQ,CAAE,EAAE,CAAEgD,OAAO,CAAE,UAAW,CAAC,CAAG,CAAC,CAAC,CACzD,CACFlD,OAAO,CAAEA,CAAA,GAAM,CACbvQ,WAAW,CAAC,CACVpC,QAAQ,CAAE+B,WAAW,CAAC/B,QAAQ,EAAI,EAAE,CACpC2B,QAAQ,CAAE,EAAE,CACZU,IAAI,CAAEN,WAAW,CAACM,IAAI,EAAI,EAAE,CAC5BC,MAAM,CAAEP,WAAW,CAACO,MAAM,EAAI,EAAE,CAChCC,GAAG,CAAER,WAAW,CAACQ,GAAG,EAAI,EAC1B,CAAC,CAAC,CACFL,WAAW,CAAC,IAAI,CAAC,CACnB,CAAE,CAAAuQ,QAAA,CACH,gFAED,CAAQ,CAAC,cACT/T,IAAA,WACE6S,KAAK,CAAA5G,aAAA,CAAAA,aAAA,IACArM,UAAU,CAACod,gBAAgB,EAC1BhK,QAAQ,CAAG,CAAEmB,QAAQ,CAAE,EAAE,CAAEgD,OAAO,CAAE,UAAW,CAAC,CAAG,CAAC,CAAC,CACzD,CACFlD,OAAO,CAAEA,CAAA,GAAM,CACbpS,YAAY,CAACob,UAAU,CAAC,OAAO,CAAC,CAChCjV,MAAM,CAACmU,QAAQ,CAACe,MAAM,CAAC,CAAC,CAC1B,CAAE,CAAAnJ,QAAA,CACH,gCAED,CAAQ,CAAC,EACN,CAAC,EACN,CACH,CACA1Q,WAAW,EAAIE,QAAQ,eACtBrD,KAAA,CAAAE,SAAA,EAAA2T,QAAA,EACG,CAACf,QAAQ,eACRhT,IAAA,QAAK6S,KAAK,CAAEjT,UAAU,CAAC+c,YAAa,CAAA5I,QAAA,CAAC,iIAAsB,CAAK,CACjE,cACD7T,KAAA,QAAK2S,KAAK,CAAEjT,UAAU,CAACgd,YAAa,CAAA7I,QAAA,eAClC/T,IAAA,SAAM6S,KAAK,CAAEjT,UAAU,CAACid,YAAa,CAAA9I,QAAA,CAAC,qBAAI,CAAM,CAAC,cACjD/T,IAAA,UACE6S,KAAK,CAAA5G,aAAA,CAAAA,aAAA,IACArM,UAAU,CAACud,YAAY,EACtBnK,QAAQ,CAAG,CAAEmB,QAAQ,CAAE,EAAE,CAAEgD,OAAO,CAAE,SAAU,CAAC,CAAG,CAAC,CAAC,CACxD,CACFhH,KAAK,CAAE1M,QAAQ,CAACnC,QAAS,CACzBgU,QAAQ,CAAE7M,CAAC,EAAI/E,WAAW,CAAC4N,CAAC,EAAArF,aAAA,CAAAA,aAAA,IAAUqF,CAAC,MAAEhQ,QAAQ,CAAEmH,CAAC,CAACkL,MAAM,CAACxD,KAAK,EAAG,CAAE,CACvE,CAAC,EACC,CAAC,cACNjQ,KAAA,QAAK2S,KAAK,CAAEjT,UAAU,CAACgd,YAAa,CAAA7I,QAAA,eAClC/T,IAAA,SAAM6S,KAAK,CAAEjT,UAAU,CAACid,YAAa,CAAA9I,QAAA,CAAC,uCAAO,CAAM,CAAC,cACpD/T,IAAA,UACE6S,KAAK,CAAA5G,aAAA,CAAAA,aAAA,IACArM,UAAU,CAACud,YAAY,EACtBnK,QAAQ,CAAG,CAAEmB,QAAQ,CAAE,EAAE,CAAEgD,OAAO,CAAE,SAAU,CAAC,CAAG,CAAC,CAAC,CACxD,CACFnO,IAAI,CAAC,UAAU,CACfmH,KAAK,CAAE1M,QAAQ,CAACR,QAAS,CACzBoS,WAAW,CAAC,qEAAc,CAC1BC,QAAQ,CAAE7M,CAAC,EAAI/E,WAAW,CAAC4N,CAAC,EAAArF,aAAA,CAAAA,aAAA,IAAUqF,CAAC,MAAErO,QAAQ,CAAEwF,CAAC,CAACkL,MAAM,CAACxD,KAAK,EAAG,CAAE,CACvE,CAAC,EACC,CAAC,cACNjQ,KAAA,QAAK2S,KAAK,CAAEjT,UAAU,CAACgd,YAAa,CAAA7I,QAAA,eAClC/T,IAAA,SAAM6S,KAAK,CAAEjT,UAAU,CAACid,YAAa,CAAA9I,QAAA,CAAC,6CAAQ,CAAM,CAAC,cACrD/T,IAAA,UACE6S,KAAK,CAAA5G,aAAA,CAAAA,aAAA,IACArM,UAAU,CAACud,YAAY,EACtBnK,QAAQ,CAAG,CAAEmB,QAAQ,CAAE,EAAE,CAAEgD,OAAO,CAAE,SAAU,CAAC,CAAG,CAAC,CAAC,CACxD,CACFnO,IAAI,CAAC,QAAQ,CACboU,GAAG,CAAE,CAAE,CACPjN,KAAK,CAAE1M,QAAQ,CAACI,GAAI,CACpByR,QAAQ,CAAE7M,CAAC,EAAI/E,WAAW,CAAC4N,CAAC,EAAArF,aAAA,CAAAA,aAAA,IAAUqF,CAAC,MAAEzN,GAAG,CAAE4E,CAAC,CAACkL,MAAM,CAACxD,KAAK,EAAG,CAAE,CAClE,CAAC,EACC,CAAC,cACNjQ,KAAA,QAAK2S,KAAK,CAAEjT,UAAU,CAACgd,YAAa,CAAA7I,QAAA,eAClC/T,IAAA,SAAM6S,KAAK,CAAEjT,UAAU,CAACid,YAAa,CAAA9I,QAAA,CAAC,iCAAM,CAAM,CAAC,cACnD/T,IAAA,UACE6S,KAAK,CAAA5G,aAAA,CAAAA,aAAA,IACArM,UAAU,CAACud,YAAY,EACtBnK,QAAQ,CAAG,CAAEmB,QAAQ,CAAE,EAAE,CAAEgD,OAAO,CAAE,SAAU,CAAC,CAAG,CAAC,CAAC,CACxD,CACFhH,KAAK,CAAE1M,QAAQ,CAACE,IAAK,CACrB2R,QAAQ,CAAE7M,CAAC,EAAI/E,WAAW,CAAC4N,CAAC,EAAArF,aAAA,CAAAA,aAAA,IAAUqF,CAAC,MAAE3N,IAAI,CAAE8E,CAAC,CAACkL,MAAM,CAACxD,KAAK,EAAG,CAAE,CACnE,CAAC,EACC,CAAC,cACNjQ,KAAA,QAAK2S,KAAK,CAAEjT,UAAU,CAACgd,YAAa,CAAA7I,QAAA,eAClC/T,IAAA,SAAM6S,KAAK,CAAEjT,UAAU,CAACid,YAAa,CAAA9I,QAAA,CAAC,wFAAgB,CAAM,CAAC,cAC7D/T,IAAA,UACE6S,KAAK,CAAA5G,aAAA,CAAAA,aAAA,IACArM,UAAU,CAACud,YAAY,EACtBnK,QAAQ,CAAG,CAAEmB,QAAQ,CAAE,EAAE,CAAEgD,OAAO,CAAE,SAAU,CAAC,CAAG,CAAC,CAAC,CACxD,CACFhH,KAAK,CAAE1M,QAAQ,CAACG,MAAO,CACvB0R,QAAQ,CAAE7M,CAAC,EAAI/E,WAAW,CAAC4N,CAAC,EAAArF,aAAA,CAAAA,aAAA,IAAUqF,CAAC,MAAE1N,MAAM,CAAE6E,CAAC,CAACkL,MAAM,CAACxD,KAAK,EAAG,CAAE,CACrE,CAAC,EACC,CAAC,cAENjQ,KAAA,QAAK2S,KAAK,CAAE,CACV0C,OAAO,CAAE,MAAM,CACfI,GAAG,CAAE,CAAC,CACNP,SAAS,CAAE,EAAE,CACbM,cAAc,CAAE,UAAU,CAC1BoH,QAAQ,CAAE9J,QAAQ,CAAG,MAAM,CAAG,QAChC,CAAE,CAAAe,QAAA,eACA/T,IAAA,WACE6S,KAAK,CAAA5G,aAAA,CAAAA,aAAA,IACArM,UAAU,CAACmd,cAAc,EACxB/J,QAAQ,CAAG,CAAEmB,QAAQ,CAAE,EAAE,CAAEgD,OAAO,CAAE,UAAW,CAAC,CAAG,CAAC,CAAC,CACzD,CACFlD,OAAO,CAAElD,iBAAkB,CAAAgD,QAAA,CAC5B,wDAED,CAAQ,CAAC,cACT/T,IAAA,WACE6S,KAAK,CAAA5G,aAAA,CAAAA,aAAA,IACArM,UAAU,CAACkc,eAAe,MAC7B/E,QAAQ,CAAE,QAAQ,CAClBlB,KAAK,CAAE,MAAM,CACbC,MAAM,CAAE,MAAM,CACd3B,QAAQ,CAAEnB,QAAQ,CAAG,EAAE,CAAG,EAAE,CAC5BwD,UAAU,CAAE,CAAC,CACbpB,SAAS,CAAE,CAAC,CACZL,YAAY,CAAE,CAAC,CACfvC,UAAU,CAAE,SAAS,CACrB6B,KAAK,CAAE,SAAS,CAChBoC,SAAS,CAAE,iBAAiB,EACxBzD,QAAQ,CAAG,CAAEmE,OAAO,CAAE,UAAW,CAAC,CAAG,CAAC,CAAC,CAC3C,CACFlD,OAAO,CAAEA,CAAA,GAAMzQ,WAAW,CAAC,KAAK,CAAE,CAAAuQ,QAAA,CACnC,sCAED,CAAQ,CAAC,EACN,CAAC,EACN,CACH,CACA,CAAC1Q,WAAW,eACXrD,IAAA,QAAK6S,KAAK,CAAE,CAAEwB,KAAK,CAAE,SAAS,CAAEU,YAAY,CAAE,CAAE,CAAE,CAAAhB,QAAA,CAAC,qDAAW,CAAK,CACpE,EACE,CAAC,EAEH,CAAC,CACH,CACN,CAEAzO,cAAc,eACbtF,IAAA,QACE6S,KAAK,CAAE,CACLkE,QAAQ,CAAE,OAAO,CACjBc,IAAI,CAAE,CAAC,CACPb,GAAG,CAAE,CAAC,CACNnB,KAAK,CAAE,OAAO,CACdC,MAAM,CAAE,OAAO,CACftD,UAAU,CAAE,kBAAkB,CAC9B6E,MAAM,CAAE,GAAG,CACX9B,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAClB,CAAE,CACFzB,OAAO,CAAEA,CAAA,GAAM1O,iBAAiB,CAAC,KAAK,CAAE,CAAAwO,QAAA,cAExC7T,KAAA,QACE2S,KAAK,CAAE,CACLL,UAAU,CAAE,SAAS,CACrB0E,YAAY,CAAE,EAAE,CAChBT,SAAS,CAAE,sBAAsB,CACjCU,OAAO,CAAE,qBAAqB,CAC9ByC,QAAQ,CAAE,GAAG,CACbxC,QAAQ,CAAE,GAAG,CACbC,MAAM,CAAE,GAAG,CACX9B,OAAO,CAAE,MAAM,CACfC,aAAa,CAAE,QAAQ,CACvBC,UAAU,CAAE,QAAQ,CACpBsB,QAAQ,CAAE,UACZ,CAAE,CACF9C,OAAO,CAAExL,CAAC,EAAIA,CAAC,CAACyL,eAAe,CAAC,CAAE,CAAAH,QAAA,eAElC/T,IAAA,WACE6S,KAAK,CAAE,CACLkE,QAAQ,CAAE,UAAU,CACpBC,GAAG,CAAE,EAAE,CACPC,KAAK,CAAE,EAAE,CACTzE,UAAU,CAAE,MAAM,CAClB6B,KAAK,CAAE,SAAS,CAChBiC,MAAM,CAAE,MAAM,CACdY,YAAY,CAAE,KAAK,CACnBrB,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,EAAE,CACV3B,QAAQ,CAAE,EAAE,CACZC,UAAU,CAAE,GAAG,CACfsD,MAAM,CAAE,SAAS,CACjBnC,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAAQ,CACxB8C,UAAU,CAAE,6BAA6B,CACzCnB,MAAM,CAAE,GACV,CAAE,CACFpD,OAAO,CAAEA,CAAA,GAAM1O,iBAAiB,CAAC,KAAK,CAAE,CACxCiM,KAAK,CAAC,4CAAS,CAAAuC,QAAA,CAChB,QAAC,CAAQ,CAAC,cACX/T,IAAA,QAAK6S,KAAK,CAAE,CAAEuB,UAAU,CAAE,GAAG,CAAED,QAAQ,CAAE,EAAE,CAAEE,KAAK,CAAE,SAAS,CAAEU,YAAY,CAAE,EAAG,CAAE,CAAAhB,QAAA,CAAC,uIAGnF,CAAK,CAAC,cACN/T,IAAA,QAAK6S,KAAK,CAAE,CAAE0C,OAAO,CAAE,MAAM,CAAEC,aAAa,CAAE,QAAQ,CAAEG,GAAG,CAAE,EAAE,CAAEE,KAAK,CAAE,MAAO,CAAE,CAAA9B,QAAA,CAC9EnU,UAAU,CAAC8F,MAAM,CAAC5E,GAAG,CAAC,CAACN,CAAC,CAAE6c,GAAG,gBAC5Bnd,KAAA,WAEE2S,KAAK,CAAE,CACL0C,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBE,GAAG,CAAE,EAAE,CACPE,KAAK,CAAE,MAAM,CACbrD,UAAU,CAAEhS,CAAC,CAACiO,MAAM,CACpB6H,MAAM,CAAE9Q,KAAK,CAACqK,IAAI,GAAKrP,CAAC,CAACqP,IAAI,CAAG,mBAAmB,CAAG,uBAAuB,CAC7EqH,YAAY,CAAE,EAAE,CAChBC,OAAO,CAAE,WAAW,CACpBO,MAAM,CAAE,SAAS,CACjBrD,KAAK,CAAE,MAAM,CACbD,UAAU,CAAE,GAAG,CACfD,QAAQ,CAAE,EAAE,CACZsC,SAAS,CAAEjR,KAAK,CAACqK,IAAI,GAAKrP,CAAC,CAACqP,IAAI,CAAG,sBAAsB,CAAG,iBAAiB,CAC7E2I,UAAU,CAAE,8BACd,CAAE,CACFvE,OAAO,CAAEA,CAAA,GAAM9B,iBAAiB,CAAC3R,CAAC,CAAE,CAAAuT,QAAA,eAEpC/T,IAAA,SAAM6S,KAAK,CAAE,CACXgD,KAAK,CAAE,EAAE,CAAEC,MAAM,CAAE,EAAE,CAAEoB,YAAY,CAAE,CAAC,CAAE1E,UAAU,CAAEhS,CAAC,CAACkO,MAAM,CAC5D4H,MAAM,CAAE,kBAAkB,CAAEf,OAAO,CAAE,cAAc,CAAEgB,WAAW,CAAE,CACpE,CAAE,CAAE,CAAC,cACLvW,IAAA,SAAM6S,KAAK,CAAE,CAAEwB,KAAK,CAAE,MAAM,CAAEE,UAAU,CAAE,iBAAkB,CAAE,CAAAR,QAAA,CAAEvT,CAAC,CAACqP,IAAI,CAAO,CAAC,CAC7ErK,KAAK,CAACqK,IAAI,GAAKrP,CAAC,CAACqP,IAAI,eACpB7P,IAAA,SAAM6S,KAAK,CAAE,CAAE2D,UAAU,CAAE,MAAM,CAAEnC,KAAK,CAAE,SAAS,CAAEF,QAAQ,CAAE,EAAG,CAAE,CAAAJ,QAAA,CAAC,QAAC,CAAM,CAC7E,GA1BIvT,CAAC,CAACqP,IA2BD,CACT,CAAC,CACC,CAAC,EACH,CAAC,CACH,CACN,EACE,CAAC,CAEV,CAEA,cAAe,CAAArO,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}