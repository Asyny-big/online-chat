{"ast":null,"code":"import _objectSpread from\"C:/Users/larak/AppData/Local/npm-cache/_npx/cd53aabf71f3f793/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef}from\"react\";import axios from\"axios\";import*as chatStyles from\"./styles/chatStyles\";import io from\"socket.io-client\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const API_URL=\"http://localhost:5000/api\";function parseToken(token){if(!token)return\"\";try{const t=token.split(\".\")[1].replace(/-/g,\"+\").replace(/_/g,\"/\");const n=decodeURIComponent(atob(t).split(\"\").map(c=>\"%\"+(\"00\"+c.charCodeAt(0).toString(16)).slice(-2)).join(\"\"));return JSON.parse(n).username||\"\";}catch(_unused){return\"\";}}function App(){var _userProfile$age,_userProfile$city,_userProfile$status;const[token,setToken]=useState(localStorage.getItem(\"token\"));const[channels,setChannels]=useState([]);const[selectedChannel,setSelectedChannel]=useState(null);const[messages,setMessages]=useState([]);const[input,setInput]=useState(\"\");const[typing,setTyping]=useState(\"\");const typingTimeoutRef=useRef(null);const[showCreate,setShowCreate]=useState(false);const[newChannel,setNewChannel]=useState(\"\");const[authMode,setAuthMode]=useState(\"login\");const[username,setUsername]=useState(\"\");const[password,setPassword]=useState(\"\");const[error,setError]=useState(\"\");const[userProfile,setUserProfile]=useState(null);const[editMode,setEditMode]=useState(false);const[editData,setEditData]=useState({username:\"\",password:\"\",city:\"\",status:\"\",age:\"\"});const[showProfile,setShowProfile]=useState(false);const[showProfileModal,setShowProfileModal]=useState(false);const[profileModalData,setProfileModalData]=useState({city:\"\",status:\"\",age:\"\"});const[registering,setRegistering]=useState(false);const socketRef=useRef(null);const messagesEndRef=useRef(null);const fileInputRef=React.useRef(null);const[avatarVersion,setAvatarVersion]=useState(Date.now());const[fileToSend,setFileToSend]=useState(null);const[filePreview,setFilePreview]=useState(null);const fileSendInputRef=React.useRef(null);const[imageModal,setImageModal]=useState({open:false,url:\"\",name:\"\"});const[fileModal,setFileModal]=useState({open:false,url:\"\",name:\"\",type:\"\"});useEffect(()=>{setUsername(parseToken(token));},[token]);useEffect(()=>{if(!token)return;const fetchProfile=async()=>{try{const res=await axios.get(\"\".concat(API_URL,\"/profile\"),{headers:{Authorization:\"Bearer \".concat(token)}});setUserProfile(res.data);}catch(_unused2){setUserProfile(null);}};fetchProfile();},[token]);useEffect(()=>{if(!token)return;axios.get(\"\".concat(API_URL,\"/channels\"),{headers:{Authorization:\"Bearer \".concat(token)}}).then(res=>setChannels(res.data)).catch(()=>setChannels([]));socketRef.current=io(\"http://localhost:5000\",{auth:{token}});socketRef.current.on(\"message\",msg=>{setMessages(prev=>msg.channel===selectedChannel?[...prev,msg]:prev);});socketRef.current.on(\"typing\",e=>{setTyping(\"\".concat(e.user,\" \\u043F\\u0435\\u0447\\u0430\\u0442\\u0430\\u0435\\u0442...\"));if(typingTimeoutRef.current)clearTimeout(typingTimeoutRef.current);typingTimeoutRef.current=setTimeout(()=>setTyping(\"\"),2000);});const handleNewChannel=()=>window.location.reload();socketRef.current.on(\"new-channel\",handleNewChannel);return()=>{socketRef.current&&socketRef.current.disconnect();socketRef.current&&socketRef.current.off(\"new-channel\",handleNewChannel);if(typingTimeoutRef.current)clearTimeout(typingTimeoutRef.current);};// eslint-disable-next-line\n},[token]);useEffect(()=>{if(token&&selectedChannel){axios.get(\"\".concat(API_URL,\"/messages/\").concat(selectedChannel),{headers:{Authorization:\"Bearer \".concat(token)}}).then(res=>setMessages(res.data));socketRef.current&&socketRef.current.emit(\"join\",selectedChannel);}},[token,selectedChannel]);useEffect(()=>{messagesEndRef.current&&messagesEndRef.current.scrollIntoView({behavior:\"smooth\"});},[messages]);useEffect(()=>{if(!socketRef.current)return;const handler=msg=>{if(msg.channel===selectedChannel)setMessages(prev=>[...prev,msg]);};socketRef.current.on(\"message\",handler);return()=>socketRef.current.off(\"message\",handler);},[selectedChannel]);const handleCreateChannel=async()=>{if(!newChannel.trim())return;try{const t=parseToken(token);const res=await axios.post(\"\".concat(API_URL,\"/channels\"),{name:newChannel,members:[t]},{headers:{Authorization:\"Bearer \".concat(token)}});setShowCreate(false);setNewChannel(\"\");const chs=await axios.get(\"\".concat(API_URL,\"/channels\"),{headers:{Authorization:\"Bearer \".concat(token)}});setChannels(chs.data);setSelectedChannel(res.data._id);socketRef.current&&socketRef.current.emit(\"join\",res.data._id);socketRef.current&&socketRef.current.emit(\"new-channel\");}catch(_unused3){alert(\"–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞–Ω–∞–ª–∞\");}};const handleSend=async()=>{if(!input.trim()&&!fileToSend||!selectedChannel)return;const t=parseToken(token);let msg={text:input,sender:t,channel:selectedChannel};// –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω —Ñ–∞–π–ª, —Å–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∂–∞–µ–º –µ–≥–æ\nif(fileToSend){const formData=new FormData();formData.append(\"file\",fileToSend);const uploadRes=await axios.post(\"\".concat(API_URL,\"/upload\"),formData,{headers:{Authorization:\"Bearer \".concat(token)}});msg.fileUrl=uploadRes.data.url.startsWith(\"http\")?uploadRes.data.url:\"\".concat(window.location.protocol,\"//\").concat(window.location.hostname,\":5000\").concat(uploadRes.data.url);msg.fileType=uploadRes.data.fileType;msg.fileName=uploadRes.data.originalName;}socketRef.current&&socketRef.current.emit(\"join\",selectedChannel);socketRef.current.emit(\"message\",msg);setInput(\"\");setFileToSend(null);setFilePreview(null);};// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏\nconst handleRegister=async e=>{e.preventDefault();setError(\"\");setRegistering(true);try{await axios.post(\"\".concat(API_URL,\"/register\"),{username,password});// –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å—Ä–∞–∑—É –ª–æ–≥–∏–Ω–∏–º\nconst res=await axios.post(\"\".concat(API_URL,\"/login\"),{username,password});localStorage.setItem(\"token\",res.data.token);setToken(res.data.token);}catch(e){var _e$response,_e$response$data;setError((e===null||e===void 0?void 0:(_e$response=e.response)===null||_e$response===void 0?void 0:(_e$response$data=_e$response.data)===null||_e$response$data===void 0?void 0:_e$response$data.error)||\"–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏–ª–∏ –ª–æ–≥–∏–Ω–∞\");}setRegistering(false);};// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—Ö–æ–¥–∞\nconst handleLogin=async e=>{e.preventDefault();setError(\"\");setRegistering(true);try{const res=await axios.post(\"\".concat(API_URL,\"/login\"),{username,password});localStorage.setItem(\"token\",res.data.token);setToken(res.data.token);}catch(e){var _e$response2,_e$response2$data;setError((e===null||e===void 0?void 0:(_e$response2=e.response)===null||_e$response2===void 0?void 0:(_e$response2$data=_e$response2.data)===null||_e$response2$data===void 0?void 0:_e$response2$data.error)||\"–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å\");}setRegistering(false);};// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–æ—Ñ–∏–ª—è\nconst handleProfileSave=async()=>{try{const payload={username:editData.username,password:editData.password,city:editData.city,status:editData.status,age:editData.age};Object.keys(payload).forEach(k=>{if(payload[k]===\"\"||payload[k]===null)delete payload[k];});const res=await axios.patch(\"\".concat(API_URL,\"/profile\"),payload,{headers:{Authorization:\"Bearer \".concat(token)}});setUserProfile(res.data);setEditMode(false);if(payload.username&&payload.username!==userProfile.username&&res.data.token){localStorage.setItem(\"token\",res.data.token);setToken(res.data.token);}}catch(e){var _e$response3,_e$response3$data;alert((e===null||e===void 0?void 0:(_e$response3=e.response)===null||_e$response3===void 0?void 0:(_e$response3$data=_e$response3.data)===null||_e$response3$data===void 0?void 0:_e$response3$data.error)||(e===null||e===void 0?void 0:e.message)||\"–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è\");}};const handleProfilePopupBgClick=e=>{// –ï—Å–ª–∏ –∫–ª–∏–∫ –ø–æ —Ñ–æ–Ω—É (–∞ –Ω–µ –ø–æ —Å–∞–º–æ–º—É popup), –∑–∞–∫—Ä—ã–≤–∞–µ–º\nsetShowProfile(false);};useEffect(()=>{if(userProfile){setEditData(d=>_objectSpread({},d));}},[userProfile]);useEffect(()=>{document.title=\"–ì–æ–í–ß–∞—Ç 2.1 Beta\";// –î–æ–±–∞–≤–ª—è–µ–º/–∑–∞–º–µ–Ω—è–µ–º favicon\nconst faviconId=\"govchat-favicon\";let link=document.querySelector(\"link[rel=\\\"icon\\\"]#\".concat(faviconId));if(!link){link=document.createElement(\"link\");link.rel=\"icon\";link.id=faviconId;document.head.appendChild(link);}// SVG-—ç–º–æ–¥–∑–∏-–∏–∫–æ–Ω–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, ü¶Ü)\nlink.type=\"image/svg+xml\";link.href='data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 64 64\"><text y=\"52\" font-size=\"52\">ü¶Ü</text></svg>';return()=>{// –ù–µ —É–¥–∞–ª—è–µ–º favicon –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏\n};},[]);if(!token){return/*#__PURE__*/_jsx(\"div\",{style:chatStyles.page,children:/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.authContainer,children:[/*#__PURE__*/_jsx(\"div\",{style:chatStyles.authTitle,children:authMode===\"register\"?\"–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è\":\"–í—Ö–æ–¥\"}),error&&/*#__PURE__*/_jsx(\"div\",{style:chatStyles.error,children:error}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:authMode===\"register\"?handleRegister:handleLogin,style:{width:\"100%\"},children:[/*#__PURE__*/_jsx(\"input\",{style:chatStyles.authInput,placeholder:\"\\u0418\\u043C\\u044F\",value:username,onChange:e=>setUsername(e.target.value),required:true,autoComplete:\"username\"}),/*#__PURE__*/_jsx(\"input\",{style:chatStyles.authInput,placeholder:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\",type:\"password\",value:password,onChange:e=>setPassword(e.target.value),required:true,autoComplete:\"current-password\"}),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.authBtn,type:\"submit\",disabled:registering,children:authMode===\"register\"?\"–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è\":\"–í–æ–π—Ç–∏\"})]}),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.switchBtn,type:\"button\",onClick:()=>{setAuthMode(authMode===\"register\"?\"login\":\"register\");setError(\"\");},children:authMode===\"register\"?\"–í–æ–π—Ç–∏\":\"–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.page,children:[/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.sidebar,children:[/*#__PURE__*/_jsx(\"div\",{style:chatStyles.sidebarTitle,children:\"\\u0413\\u043E\\u0412\\u0427\\u0430\\u0442 2.1 Beta\"}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.channelList,children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:600,color:\"#fff\",marginBottom:10},children:\"\\u041A\\u0430\\u043D\\u0430\\u043B\\u044B\"}),channels.length===0?/*#__PURE__*/_jsx(\"div\",{style:{color:\"#b2bec3\",marginBottom:8},children:\"\\u041D\\u0435\\u0442 \\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u044B\\u0445 \\u043A\\u0430\\u043D\\u0430\\u043B\\u043E\\u0432\"}):/*#__PURE__*/_jsx(_Fragment,{children:channels.map(ch=>/*#__PURE__*/_jsx(\"div\",{style:chatStyles.channelItem(selectedChannel===ch._id),onClick:()=>setSelectedChannel(ch._id),children:ch.name},ch._id))}),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.createBtn,onClick:()=>setShowCreate(v=>!v),children:showCreate?\"–°–∫—Ä—ã—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ\":\"–°–æ–∑–¥–∞—Ç—å –∫–∞–Ω–∞–ª\"}),showCreate&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:10},children:[/*#__PURE__*/_jsx(\"input\",{style:chatStyles.input,placeholder:\"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u043A\\u0430\\u043D\\u0430\\u043B\\u0430\",value:newChannel,onChange:e=>setNewChannel(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.createBtn,onClick:handleCreateChannel,children:\"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C\"})]})]}),/*#__PURE__*/_jsx(\"div\",{style:{flex:1}}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileBtnBox,children:[/*#__PURE__*/_jsx(\"button\",{style:chatStyles.profileBtn,onClick:()=>{setShowProfile(v=>!v);setEditMode(false);},title:\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\",children:/*#__PURE__*/_jsxs(\"svg\",{width:\"26\",height:\"26\",viewBox:\"0 0 26 26\",fill:\"none\",children:[/*#__PURE__*/_jsx(\"circle\",{cx:\"13\",cy:\"13\",r:\"13\",fill:\"#00c3ff\"}),/*#__PURE__*/_jsx(\"circle\",{cx:\"13\",cy:\"10\",r:\"4\",fill:\"#fff\"}),/*#__PURE__*/_jsx(\"ellipse\",{cx:\"13\",cy:\"19\",rx:\"7\",ry:\"4\",fill:\"#fff\"})]})}),showProfile&&/*#__PURE__*/_jsx(\"div\",{style:{position:\"fixed\",left:0,top:0,width:\"100vw\",height:\"100vh\",background:\"rgba(0,0,0,0.12)\",zIndex:99,transition:\"background 0.2s\"},onClick:handleProfilePopupBgClick,children:/*#__PURE__*/_jsxs(\"div\",{style:_objectSpread(_objectSpread({},chatStyles.profilePopup),{},{transform:showProfile?\"translateY(0)\":\"translateY(120%)\",opacity:showProfile?1:0,pointerEvents:showProfile?\"auto\":\"none\",transition:\"transform 0.32s cubic-bezier(.4,1.4,.6,1), opacity 0.22s\",display:\"flex\",flexDirection:\"column\",justifyContent:\"flex-start\"}),onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"div\",{style:chatStyles.profileAvatar,children:/*#__PURE__*/_jsxs(\"div\",{style:{position:\"relative\",width:90,height:90,borderRadius:\"50%\",overflow:\"hidden\",cursor:\"pointer\",border:\"2px solid #00c3ff\",margin:\"0 auto\",background:\"#35363a\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\"},onClick:()=>fileInputRef.current&&fileInputRef.current.click(),title:\"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C \\u0444\\u043E\\u0442\\u043E\",children:[userProfile!==null&&userProfile!==void 0&&userProfile.avatarUrl&&userProfile.avatarUrl!==\"/uploads/avatar-default.png\"?/*#__PURE__*/_jsx(\"img\",{src:userProfile.avatarUrl.startsWith(\"http\")?userProfile.avatarUrl+\"?t=\"+avatarVersion:\"\".concat(window.location.protocol,\"//\").concat(window.location.hostname,\":5000\").concat(userProfile.avatarUrl,\"?t=\").concat(avatarVersion),alt:\"avatar\",style:{width:90,height:90,borderRadius:\"50%\",objectFit:\"cover\",display:\"block\"},onError:e=>{e.target.onerror=null;e.target.src=\"\".concat(window.location.protocol,\"//\").concat(window.location.hostname,\":5000/uploads/avatar-default.png\");}},userProfile.avatarUrl+avatarVersion):/*#__PURE__*/// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—É—é –∫–∞—Ä—Ç–∏–Ω–∫—É, –µ—Å–ª–∏ –Ω–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π\n_jsx(\"img\",{src:\"\".concat(window.location.protocol,\"//\").concat(window.location.hostname,\":5000/uploads/avatar-default.png\"),alt:\"avatar\",style:{width:90,height:90,borderRadius:\"50%\",objectFit:\"cover\",display:\"block\"},onError:e=>{e.target.onerror=null;e.target.src=\"https://ui-avatars.com/api/?name=\"+encodeURIComponent((userProfile===null||userProfile===void 0?void 0:userProfile.username)||\"U\")+\"&background=00c3ff&color=fff&size=90\";}}),/*#__PURE__*/_jsx(\"input\",{ref:fileInputRef,type:\"file\",accept:\"image/*\",style:{display:\"none\"},onChange:async e=>{var _e$target$files;if(!((_e$target$files=e.target.files)!==null&&_e$target$files!==void 0&&_e$target$files[0]))return;const formData=new FormData();formData.append(\"file\",e.target.files[0]);// –ü–æ–ª—É—á–∞–µ–º –∞–±—Å–æ–ª—é—Ç–Ω—ã–π URL –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞\nconst uploadRes=await axios.post(\"\".concat(API_URL,\"/upload?avatar=1\"),formData,{headers:{Authorization:\"Bearer \".concat(token)}});// –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º avatarUrl –≤ –ø—Ä–æ—Ñ–∏–ª–µ (–ø–∞—Ç—á–∏–º –ø—Ä–æ—Ñ–∏–ª—å)\nawait axios.patch(\"\".concat(API_URL,\"/profile\"),{avatarUrl:uploadRes.data.url},{headers:{Authorization:\"Bearer \".concat(token)}});// –ü–æ–ª—É—á–∞–µ–º —Å–≤–µ–∂–∏–π –ø—Ä–æ—Ñ–∏–ª—å\nconst profileRes=await axios.get(\"\".concat(API_URL,\"/profile\"),{headers:{Authorization:\"Bearer \".concat(token)}});setUserProfile(profileRes.data);setAvatarVersion(Date.now());}})]})}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1,overflowY:\"auto\",minHeight:0,marginBottom:10,display:\"flex\",flexDirection:\"column\",justifyContent:\"flex-start\"},children:[userProfile&&!editMode&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{style:chatStyles.profileTitle,children:\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\"}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u041D\\u0438\\u043A:\"}),\" \",userProfile.username]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u0412\\u043E\\u0437\\u0440\\u0430\\u0441\\u0442:\"}),\" \",(_userProfile$age=userProfile.age)!==null&&_userProfile$age!==void 0?_userProfile$age:\"‚Äî\"]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u0413\\u043E\\u0440\\u043E\\u0434:\"}),\" \",(_userProfile$city=userProfile.city)!==null&&_userProfile$city!==void 0?_userProfile$city:\"‚Äî\"]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u0421\\u0435\\u043C\\u0435\\u0439\\u043D\\u044B\\u0439 \\u0441\\u0442\\u0430\\u0442\\u0443\\u0441:\"}),\" \",(_userProfile$status=userProfile.status)!==null&&_userProfile$status!==void 0?_userProfile$status:\"‚Äî\"]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:8,marginTop:18,justifyContent:\"flex-end\"},children:[/*#__PURE__*/_jsx(\"button\",{style:chatStyles.profileEditBtn,onClick:()=>{setEditData({username:userProfile.username||\"\",password:\"\",city:userProfile.city||\"\",status:userProfile.status||\"\",age:userProfile.age||\"\"});setEditMode(true);},children:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.profileLogoutBtn,onClick:()=>{localStorage.removeItem(\"token\");window.location.reload();},children:\"\\u0412\\u044B\\u0439\\u0442\\u0438\"})]})]}),userProfile&&editMode&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{style:chatStyles.profileTitle,children:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435 \\u043F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044F\"}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u041D\\u0438\\u043A:\"}),/*#__PURE__*/_jsx(\"input\",{style:chatStyles.profileInput,value:editData.username,onChange:e=>setEditData(d=>_objectSpread(_objectSpread({},d),{},{username:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C:\"}),/*#__PURE__*/_jsx(\"input\",{style:chatStyles.profileInput,type:\"password\",value:editData.password,placeholder:\"\\u041D\\u043E\\u0432\\u044B\\u0439 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\",onChange:e=>setEditData(d=>_objectSpread(_objectSpread({},d),{},{password:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u0412\\u043E\\u0437\\u0440\\u0430\\u0441\\u0442:\"}),/*#__PURE__*/_jsx(\"input\",{style:chatStyles.profileInput,type:\"number\",min:0,value:editData.age,onChange:e=>setEditData(d=>_objectSpread(_objectSpread({},d),{},{age:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u0413\\u043E\\u0440\\u043E\\u0434:\"}),/*#__PURE__*/_jsx(\"input\",{style:chatStyles.profileInput,value:editData.city,onChange:e=>setEditData(d=>_objectSpread(_objectSpread({},d),{},{city:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.profileField,children:[/*#__PURE__*/_jsx(\"span\",{style:chatStyles.profileLabel,children:\"\\u0421\\u0435\\u043C\\u0435\\u0439\\u043D\\u044B\\u0439 \\u0441\\u0442\\u0430\\u0442\\u0443\\u0441:\"}),/*#__PURE__*/_jsx(\"input\",{style:chatStyles.profileInput,value:editData.status,onChange:e=>setEditData(d=>_objectSpread(_objectSpread({},d),{},{status:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:8,marginTop:10,justifyContent:\"flex-end\",flexWrap:\"wrap\"},children:[/*#__PURE__*/_jsx(\"button\",{style:chatStyles.profileEditBtn,onClick:handleProfileSave,children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{style:_objectSpread(_objectSpread({},chatStyles.profileCloseBtn),{},{position:\"static\",width:\"auto\",height:\"auto\",fontSize:15,marginLeft:0,marginTop:0,marginBottom:0,background:\"#35363a\",color:\"#b2bec3\",boxShadow:\"0 2px 8px #0002\"}),onClick:()=>setEditMode(false),children:\"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\"})]})]}),!userProfile&&/*#__PURE__*/_jsx(\"div\",{style:{color:\"#b2bec3\",marginBottom:8},children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"})]})]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.chatContainer,children:[/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",alignItems:\"center\",justifyContent:\"center\",width:\"100%\",marginBottom:10,minHeight:32},children:/*#__PURE__*/_jsx(\"div\",{style:chatStyles.chatTitle,children:\"\\u0427\\u0430\\u0442\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-box\",style:chatStyles.chatBox,children:[messages.map(msg=>{var _msg$fileType,_msg$fileType2;const isMine=msg.sender===username;const time=msg.createdAt?new Date(msg.createdAt).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'}):'';return/*#__PURE__*/_jsx(\"div\",{style:chatStyles.messageRow(isMine),children:/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.message(isMine),children:[!isMine&&/*#__PURE__*/_jsxs(\"span\",{style:chatStyles.messageSender,children:[msg.sender,\":\"]}),msg.text,msg.fileUrl&&/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.messageFileBox,children:[/*#__PURE__*/_jsxs(\"div\",{style:{position:\"relative\",display:\"inline-block\",cursor:\"pointer\",maxWidth:180},onClick:()=>setFileModal({open:true,url:msg.fileUrl,name:msg.fileName||\"file\",type:msg.fileType||\"\"}),title:\"\\u041E\\u0442\\u043A\\u0440\\u044B\\u0442\\u044C \\u0444\\u0430\\u0439\\u043B\",children:[(_msg$fileType=msg.fileType)!==null&&_msg$fileType!==void 0&&_msg$fileType.startsWith(\"image/\")?/*#__PURE__*/_jsx(\"img\",{src:msg.fileUrl,alt:msg.fileName||\"—Ñ–∞–π–ª\",style:chatStyles.messageFileImg}):(_msg$fileType2=msg.fileType)!==null&&_msg$fileType2!==void 0&&_msg$fileType2.startsWith(\"video/\")?/*#__PURE__*/_jsx(\"video\",{src:msg.fileUrl,style:chatStyles.messageFileImg,muted:true,preload:\"metadata\"}):/*#__PURE__*/_jsx(\"div\",{style:chatStyles.filePreviewDoc,children:/*#__PURE__*/_jsx(\"span\",{role:\"img\",\"aria-label\":\"file\",style:{fontSize:38},children:\"\\uD83D\\uDCC4\"})}),/*#__PURE__*/_jsx(\"a\",{href:msg.fileUrl,download:msg.fileName||\"file\",style:_objectSpread(_objectSpread({},chatStyles.downloadBtn),{},{position:\"absolute\",right:4,bottom:4,background:\"rgba(0,0,0,0.45)\",borderRadius:\"50%\",padding:4,zIndex:2}),title:\"\\u0421\\u043A\\u0430\\u0447\\u0430\\u0442\\u044C\",onClick:e=>e.stopPropagation(),children:/*#__PURE__*/_jsx(\"svg\",{width:\"20\",height:\"20\",viewBox:\"0 0 20 20\",fill:\"none\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M10 3v10m0 0l-4-4m4 4l4-4M4 17h12\",stroke:\"#00c3ff\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\"})})})]}),/*#__PURE__*/_jsx(\"div\",{style:{color:\"#b2bec3\",fontSize:13,marginTop:2,wordBreak:\"break-all\"},children:msg.fileName})]}),/*#__PURE__*/_jsx(\"div\",{style:{color:\"#b2bec3\",fontSize:11,marginTop:4,textAlign:isMine?\"right\":\"left\"},children:time})]})},msg._id);}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsx(\"div\",{style:{minHeight:22,display:\"flex\",alignItems:\"flex-end\",marginBottom:2},children:typing&&/*#__PURE__*/_jsx(\"div\",{style:_objectSpread(_objectSpread({},chatStyles.typing),{},{margin:0,paddingLeft:8,paddingRight:8,background:\"none\",borderRadius:0,position:\"relative\",zIndex:2,width:\"fit-content\",maxWidth:\"80%\",alignSelf:\"flex-start\",boxShadow:\"none\"}),children:typing})}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.inputRow,children:[/*#__PURE__*/_jsxs(\"button\",{style:_objectSpread(_objectSpread({},chatStyles.sendBtn),{},{padding:\"10px 12px\",minWidth:0,width:44,display:\"flex\",alignItems:\"center\",justifyContent:\"center\",marginRight:2}),type:\"button\",onClick:()=>fileSendInputRef.current&&fileSendInputRef.current.click(),title:\"\\u041F\\u0440\\u0438\\u043A\\u0440\\u0435\\u043F\\u0438\\u0442\\u044C \\u0444\\u0430\\u0439\\u043B\",disabled:!selectedChannel,children:[/*#__PURE__*/_jsxs(\"svg\",{width:\"22\",height:\"22\",viewBox:\"0 0 24 24\",fill:\"none\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M17.657 6.343a8 8 0 1 0-11.314 11.314 8 8 0 0 0 11.314-11.314zm-9.9 9.9a6 6 0 1 1 8.486-8.486 6 6 0 0 1-8.486 8.486z\",fill:\"#fff\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M12 8v5a1 1 0 0 0 2 0V8a3 3 0 1 0-6 0v8a5 5 0 0 0 10 0v-3a1 1 0 1 0-2 0v3a3 3 0 0 1-6 0V8a1 1 0 1 1 2 0z\",fill:\"#fff\"})]}),/*#__PURE__*/_jsx(\"input\",{ref:fileSendInputRef,type:\"file\",style:{display:\"none\"},onChange:e=>{var _e$target$files2;const file=(_e$target$files2=e.target.files)===null||_e$target$files2===void 0?void 0:_e$target$files2[0];if(!file)return;setFileToSend(file);// –î–ª—è –ø—Ä–µ–≤—å—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π/–≤–∏–¥–µ–æ\nif(file.type.startsWith(\"image/\")||file.type.startsWith(\"video/\")){setFilePreview(URL.createObjectURL(file));}else{setFilePreview(null);}}})]}),/*#__PURE__*/_jsx(\"input\",{style:chatStyles.input,value:input,onChange:e=>setInput(e.target.value),onKeyDown:e=>{if(selectedChannel){socketRef.current.emit(\"typing\",{channel:selectedChannel});if(e.key===\"Enter\")handleSend();}},disabled:!selectedChannel,placeholder:selectedChannel?\"–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...\":\"–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞–Ω–∞–ª\"}),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.sendBtn,onClick:handleSend,disabled:!selectedChannel||!input.trim()&&!fileToSend,children:\"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\"})]}),fileToSend&&/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.filePreviewBox,children:[filePreview&&fileToSend.type.startsWith(\"image/\")&&/*#__PURE__*/_jsx(\"img\",{src:filePreview,alt:\"preview\",style:chatStyles.filePreviewImg}),filePreview&&fileToSend.type.startsWith(\"video/\")&&/*#__PURE__*/_jsx(\"video\",{src:filePreview,controls:true,style:chatStyles.filePreviewVideo}),!filePreview&&/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.filePreviewDoc,children:[\"\\uD83D\\uDCCE \",fileToSend.name]}),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.filePreviewRemoveBtn,onClick:()=>{setFileToSend(null);setFilePreview(null);},title:\"\\u0423\\u0431\\u0440\\u0430\\u0442\\u044C \\u0444\\u0430\\u0439\\u043B\",children:\"\\xD7\"})]})]}),imageModal.open&&/*#__PURE__*/_jsx(\"div\",{style:chatStyles.modalOverlay,onClick:()=>setImageModal({open:false,url:\"\",name:\"\"}),children:/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.modalContent,onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"img\",{src:imageModal.url,alt:imageModal.name,style:chatStyles.modalImg}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.modalActions,children:[/*#__PURE__*/_jsxs(\"a\",{href:imageModal.url,download:imageModal.name,style:chatStyles.downloadBtn,title:\"\\u0421\\u043A\\u0430\\u0447\\u0430\\u0442\\u044C\",children:[/*#__PURE__*/_jsx(\"svg\",{width:\"28\",height:\"28\",viewBox:\"0 0 20 20\",fill:\"none\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M10 3v10m0 0l-4-4m4 4l4-4M4 17h12\",stroke:\"#00c3ff\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\"})}),/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:6},children:\"\\u0421\\u043A\\u0430\\u0447\\u0430\\u0442\\u044C\"})]}),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.modalCloseBtn,onClick:()=>setImageModal({open:false,url:\"\",name:\"\"}),title:\"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\",children:\"\\xD7\"})]})]})}),fileModal.open&&/*#__PURE__*/_jsx(\"div\",{style:chatStyles.modalOverlay,onClick:()=>setFileModal({open:false,url:\"\",name:\"\",type:\"\"}),children:/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.modalContent,onClick:e=>e.stopPropagation(),children:[fileModal.type.startsWith(\"image/\")?/*#__PURE__*/_jsx(\"img\",{src:fileModal.url,alt:fileModal.name,style:chatStyles.modalImg}):fileModal.type.startsWith(\"video/\")?/*#__PURE__*/_jsx(\"video\",{src:fileModal.url,controls:true,autoPlay:true,style:chatStyles.modalImg}):/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:\"center\",width:320,padding:24},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:80,marginBottom:16},children:\"\\uD83D\\uDCC4\"}),/*#__PURE__*/_jsx(\"div\",{style:{color:\"#fff\",fontSize:18,marginBottom:16,wordBreak:\"break-all\"},children:fileModal.name})]}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.modalActions,children:[/*#__PURE__*/_jsxs(\"a\",{href:fileModal.url,download:fileModal.name,style:chatStyles.downloadBtn,title:\"\\u0421\\u043A\\u0430\\u0447\\u0430\\u0442\\u044C\",children:[/*#__PURE__*/_jsx(\"svg\",{width:\"28\",height:\"28\",viewBox:\"0 0 20 20\",fill:\"none\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M10 3v10m0 0l-4-4m4 4l4-4M4 17h12\",stroke:\"#00c3ff\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\"})}),/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:6},children:\"\\u0421\\u043A\\u0430\\u0447\\u0430\\u0442\\u044C\"})]}),/*#__PURE__*/_jsx(\"button\",{style:chatStyles.modalCloseBtn,onClick:()=>setFileModal({open:false,url:\"\",name:\"\",type:\"\"}),title:\"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\",children:\"\\xD7\"})]})]})})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","useRef","axios","chatStyles","io","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","API_URL","parseToken","token","t","split","replace","n","decodeURIComponent","atob","map","c","charCodeAt","toString","slice","join","JSON","parse","username","_unused","App","_userProfile$age","_userProfile$city","_userProfile$status","setToken","localStorage","getItem","channels","setChannels","selectedChannel","setSelectedChannel","messages","setMessages","input","setInput","typing","setTyping","typingTimeoutRef","showCreate","setShowCreate","newChannel","setNewChannel","authMode","setAuthMode","setUsername","password","setPassword","error","setError","userProfile","setUserProfile","editMode","setEditMode","editData","setEditData","city","status","age","showProfile","setShowProfile","showProfileModal","setShowProfileModal","profileModalData","setProfileModalData","registering","setRegistering","socketRef","messagesEndRef","fileInputRef","avatarVersion","setAvatarVersion","Date","now","fileToSend","setFileToSend","filePreview","setFilePreview","fileSendInputRef","imageModal","setImageModal","open","url","name","fileModal","setFileModal","type","fetchProfile","res","get","concat","headers","Authorization","data","_unused2","then","catch","current","auth","on","msg","prev","channel","e","user","clearTimeout","setTimeout","handleNewChannel","window","location","reload","disconnect","off","emit","scrollIntoView","behavior","handler","handleCreateChannel","trim","post","members","chs","_id","_unused3","alert","handleSend","text","sender","formData","FormData","append","uploadRes","fileUrl","startsWith","protocol","hostname","fileType","fileName","originalName","handleRegister","preventDefault","setItem","_e$response","_e$response$data","response","handleLogin","_e$response2","_e$response2$data","handleProfileSave","payload","Object","keys","forEach","k","patch","_e$response3","_e$response3$data","message","handleProfilePopupBgClick","d","_objectSpread","document","title","faviconId","link","querySelector","createElement","rel","id","head","appendChild","href","style","page","children","authContainer","authTitle","onSubmit","width","authInput","placeholder","value","onChange","target","required","autoComplete","authBtn","disabled","switchBtn","onClick","sidebar","sidebarTitle","channelList","fontWeight","color","marginBottom","length","ch","channelItem","createBtn","v","marginTop","flex","profileBtnBox","profileBtn","height","viewBox","fill","cx","cy","r","rx","ry","position","left","top","background","zIndex","transition","profilePopup","transform","opacity","pointerEvents","display","flexDirection","justifyContent","stopPropagation","profileAvatar","borderRadius","overflow","cursor","border","margin","alignItems","click","avatarUrl","src","alt","objectFit","onError","onerror","encodeURIComponent","ref","accept","_e$target$files","files","profileRes","overflowY","minHeight","profileTitle","profileField","profileLabel","gap","profileEditBtn","profileLogoutBtn","removeItem","profileInput","min","flexWrap","profileCloseBtn","fontSize","marginLeft","boxShadow","chatContainer","chatTitle","className","chatBox","_msg$fileType","_msg$fileType2","isMine","time","createdAt","toLocaleTimeString","hour","minute","messageRow","messageSender","messageFileBox","maxWidth","messageFileImg","muted","preload","filePreviewDoc","role","download","downloadBtn","right","bottom","padding","stroke","strokeWidth","strokeLinecap","strokeLinejoin","wordBreak","textAlign","paddingLeft","paddingRight","alignSelf","inputRow","sendBtn","minWidth","marginRight","_e$target$files2","file","URL","createObjectURL","onKeyDown","key","filePreviewBox","filePreviewImg","controls","filePreviewVideo","filePreviewRemoveBtn","modalOverlay","modalContent","modalImg","modalActions","modalCloseBtn","autoPlay"],"sources":["D:/prr/prr/semak4/driver/frontend/src/App.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\nimport axios from \"axios\";\r\nimport * as chatStyles from \"./styles/chatStyles\";\r\nimport io from \"socket.io-client\";\r\n\r\nconst API_URL = \"http://localhost:5000/api\";\r\n\r\nfunction parseToken(token) {\r\n  if (!token) return \"\";\r\n  try {\r\n    const t = token.split(\".\")[1].replace(/-/g, \"+\").replace(/_/g, \"/\");\r\n    const n = decodeURIComponent(\r\n      atob(t)\r\n        .split(\"\")\r\n        .map((c) => \"%\" + (\"00\" + c.charCodeAt(0).toString(16)).slice(-2))\r\n        .join(\"\")\r\n    );\r\n    return JSON.parse(n).username || \"\";\r\n  } catch {\r\n    return \"\";\r\n  }\r\n}\r\n\r\nfunction App() {\r\n  const [token, setToken] = useState(localStorage.getItem(\"token\"));\r\n  const [channels, setChannels] = useState([]);\r\n  const [selectedChannel, setSelectedChannel] = useState(null);\r\n  const [messages, setMessages] = useState([]);\r\n  const [input, setInput] = useState(\"\");\r\n  const [typing, setTyping] = useState(\"\");\r\n  const typingTimeoutRef = useRef(null);\r\n  const [showCreate, setShowCreate] = useState(false);\r\n  const [newChannel, setNewChannel] = useState(\"\");\r\n  const [authMode, setAuthMode] = useState(\"login\");\r\n  const [username, setUsername] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [error, setError] = useState(\"\");\r\n  const [userProfile, setUserProfile] = useState(null);\r\n  const [editMode, setEditMode] = useState(false);\r\n  const [editData, setEditData] = useState({\r\n    username: \"\",\r\n    password: \"\",\r\n    city: \"\",\r\n    status: \"\",\r\n    age: \"\",\r\n  });\r\n  const [showProfile, setShowProfile] = useState(false);\r\n  const [showProfileModal, setShowProfileModal] = useState(false);\r\n  const [profileModalData, setProfileModalData] = useState({\r\n    city: \"\",\r\n    status: \"\",\r\n    age: \"\",\r\n  });\r\n  const [registering, setRegistering] = useState(false);\r\n  const socketRef = useRef(null);\r\n  const messagesEndRef = useRef(null);\r\n  const fileInputRef = React.useRef(null);\r\n  const [avatarVersion, setAvatarVersion] = useState(Date.now());\r\n  const [fileToSend, setFileToSend] = useState(null);\r\n  const [filePreview, setFilePreview] = useState(null);\r\n  const fileSendInputRef = React.useRef(null);\r\n  const [imageModal, setImageModal] = useState({ open: false, url: \"\", name: \"\" });\r\n  const [fileModal, setFileModal] = useState({ open: false, url: \"\", name: \"\", type: \"\" });\r\n\r\n  useEffect(() => {\r\n    setUsername(parseToken(token));\r\n  }, [token]);\r\n\r\n  useEffect(() => {\r\n    if (!token) return;\r\n    const fetchProfile = async () => {\r\n      try {\r\n        const res = await axios.get(`${API_URL}/profile`, {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        });\r\n        setUserProfile(res.data);\r\n      } catch {\r\n        setUserProfile(null);\r\n      }\r\n    };\r\n    fetchProfile();\r\n  }, [token]);\r\n\r\n  useEffect(() => {\r\n    if (!token) return;\r\n    axios\r\n      .get(`${API_URL}/channels`, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      })\r\n      .then((res) => setChannels(res.data))\r\n      .catch(() => setChannels([]));\r\n\r\n    socketRef.current = io(\"http://localhost:5000\", {\r\n      auth: { token },\r\n    });\r\n\r\n    socketRef.current.on(\"message\", (msg) => {\r\n      setMessages((prev) =>\r\n        msg.channel === selectedChannel ? [...prev, msg] : prev\r\n      );\r\n    });\r\n\r\n    socketRef.current.on(\"typing\", (e) => {\r\n      setTyping(`${e.user} –ø–µ—á–∞—Ç–∞–µ—Ç...`);\r\n      if (typingTimeoutRef.current) clearTimeout(typingTimeoutRef.current);\r\n      typingTimeoutRef.current = setTimeout(() => setTyping(\"\"), 2000);\r\n    });\r\n\r\n    const handleNewChannel = () => window.location.reload();\r\n    socketRef.current.on(\"new-channel\", handleNewChannel);\r\n\r\n    return () => {\r\n      socketRef.current && socketRef.current.disconnect();\r\n      socketRef.current && socketRef.current.off(\"new-channel\", handleNewChannel);\r\n      if (typingTimeoutRef.current) clearTimeout(typingTimeoutRef.current);\r\n    };\r\n    // eslint-disable-next-line\r\n  }, [token]);\r\n\r\n  useEffect(() => {\r\n    if (token && selectedChannel) {\r\n      axios\r\n        .get(`${API_URL}/messages/${selectedChannel}`, {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        })\r\n        .then((res) => setMessages(res.data));\r\n      socketRef.current && socketRef.current.emit(\"join\", selectedChannel);\r\n    }\r\n  }, [token, selectedChannel]);\r\n\r\n  useEffect(() => {\r\n    messagesEndRef.current && messagesEndRef.current.scrollIntoView({ behavior: \"smooth\" });\r\n  }, [messages]);\r\n\r\n  useEffect(() => {\r\n    if (!socketRef.current) return;\r\n    const handler = (msg) => {\r\n      if (msg.channel === selectedChannel) setMessages((prev) => [...prev, msg]);\r\n    };\r\n    socketRef.current.on(\"message\", handler);\r\n    return () => socketRef.current.off(\"message\", handler);\r\n  }, [selectedChannel]);\r\n\r\n  const handleCreateChannel = async () => {\r\n    if (!newChannel.trim()) return;\r\n    try {\r\n      const t = parseToken(token);\r\n      const res = await axios.post(\r\n        `${API_URL}/channels`,\r\n        { name: newChannel, members: [t] },\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n      setShowCreate(false);\r\n      setNewChannel(\"\");\r\n      const chs = await axios.get(`${API_URL}/channels`, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      setChannels(chs.data);\r\n      setSelectedChannel(res.data._id);\r\n      socketRef.current && socketRef.current.emit(\"join\", res.data._id);\r\n      socketRef.current && socketRef.current.emit(\"new-channel\");\r\n    } catch {\r\n      alert(\"–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞–Ω–∞–ª–∞\");\r\n    }\r\n  };\r\n\r\n  const handleSend = async () => {\r\n    if ((!input.trim() && !fileToSend) || !selectedChannel) return;\r\n    const t = parseToken(token);\r\n    let msg = { text: input, sender: t, channel: selectedChannel };\r\n    // –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω —Ñ–∞–π–ª, —Å–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∂–∞–µ–º –µ–≥–æ\r\n    if (fileToSend) {\r\n      const formData = new FormData();\r\n      formData.append(\"file\", fileToSend);\r\n      const uploadRes = await axios.post(\r\n        `${API_URL}/upload`,\r\n        formData,\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n      msg.fileUrl = uploadRes.data.url.startsWith(\"http\")\r\n        ? uploadRes.data.url\r\n        : `${window.location.protocol}//${window.location.hostname}:5000${uploadRes.data.url}`;\r\n      msg.fileType = uploadRes.data.fileType;\r\n      msg.fileName = uploadRes.data.originalName;\r\n    }\r\n    socketRef.current && socketRef.current.emit(\"join\", selectedChannel);\r\n    socketRef.current.emit(\"message\", msg);\r\n    setInput(\"\");\r\n    setFileToSend(null);\r\n    setFilePreview(null);\r\n  };\r\n\r\n  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏\r\n  const handleRegister = async (e) => {\r\n    e.preventDefault();\r\n    setError(\"\");\r\n    setRegistering(true);\r\n    try {\r\n      await axios.post(`${API_URL}/register`, {\r\n        username,\r\n        password,\r\n      });\r\n      // –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å—Ä–∞–∑—É –ª–æ–≥–∏–Ω–∏–º\r\n      const res = await axios.post(`${API_URL}/login`, {\r\n        username,\r\n        password,\r\n      });\r\n      localStorage.setItem(\"token\", res.data.token);\r\n      setToken(res.data.token);\r\n    } catch (e) {\r\n      setError(\r\n        e?.response?.data?.error ||\r\n          \"–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏–ª–∏ –ª–æ–≥–∏–Ω–∞\"\r\n      );\r\n    }\r\n    setRegistering(false);\r\n  };\r\n\r\n  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—Ö–æ–¥–∞\r\n  const handleLogin = async (e) => {\r\n    e.preventDefault();\r\n    setError(\"\");\r\n    setRegistering(true);\r\n    try {\r\n      const res = await axios.post(`${API_URL}/login`, {\r\n        username,\r\n        password,\r\n      });\r\n      localStorage.setItem(\"token\", res.data.token);\r\n      setToken(res.data.token);\r\n    } catch (e) {\r\n      setError(\r\n        e?.response?.data?.error ||\r\n          \"–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å\"\r\n      );\r\n    }\r\n    setRegistering(false);\r\n  };\r\n\r\n  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–æ—Ñ–∏–ª—è\r\n  const handleProfileSave = async () => {\r\n    try {\r\n      const payload = {\r\n        username: editData.username,\r\n        password: editData.password,\r\n        city: editData.city,\r\n        status: editData.status,\r\n        age: editData.age,\r\n      };\r\n      Object.keys(payload).forEach(k => {\r\n        if (payload[k] === \"\" || payload[k] === null) delete payload[k];\r\n      });\r\n      const res = await axios.patch(`${API_URL}/profile`, payload, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      setUserProfile(res.data);\r\n      setEditMode(false);\r\n      if (payload.username && payload.username !== userProfile.username && res.data.token) {\r\n        localStorage.setItem(\"token\", res.data.token);\r\n        setToken(res.data.token);\r\n      }\r\n    } catch (e) {\r\n      alert(e?.response?.data?.error || e?.message || \"–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è\");\r\n    }\r\n  };\r\n\r\n  const handleProfilePopupBgClick = (e) => {\r\n    // –ï—Å–ª–∏ –∫–ª–∏–∫ –ø–æ —Ñ–æ–Ω—É (–∞ –Ω–µ –ø–æ —Å–∞–º–æ–º—É popup), –∑–∞–∫—Ä—ã–≤–∞–µ–º\r\n    setShowProfile(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (userProfile) {\r\n      setEditData(d => ({\r\n        ...d,\r\n      }));\r\n    }\r\n  }, [userProfile]);\r\n\r\n  useEffect(() => {\r\n    document.title = \"–ì–æ–í–ß–∞—Ç 2.1 Beta\";\r\n    // –î–æ–±–∞–≤–ª—è–µ–º/–∑–∞–º–µ–Ω—è–µ–º favicon\r\n    const faviconId = \"govchat-favicon\";\r\n    let link = document.querySelector(`link[rel=\"icon\"]#${faviconId}`);\r\n    if (!link) {\r\n      link = document.createElement(\"link\");\r\n      link.rel = \"icon\";\r\n      link.id = faviconId;\r\n      document.head.appendChild(link);\r\n    }\r\n    // SVG-—ç–º–æ–¥–∑–∏-–∏–∫–æ–Ω–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, ü¶Ü)\r\n    link.type = \"image/svg+xml\";\r\n    link.href =\r\n      'data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 64 64\"><text y=\"52\" font-size=\"52\">ü¶Ü</text></svg>';\r\n    return () => {\r\n      // –ù–µ —É–¥–∞–ª—è–µ–º favicon –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏\r\n    };\r\n  }, []);\r\n\r\n  if (!token) {\r\n    return (\r\n      <div style={chatStyles.page}>\r\n        <div style={chatStyles.authContainer}>\r\n          <div style={chatStyles.authTitle}>\r\n            {authMode === \"register\" ? \"–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è\" : \"–í—Ö–æ–¥\"}\r\n          </div>\r\n          {error && <div style={chatStyles.error}>{error}</div>}\r\n          <form\r\n            onSubmit={authMode === \"register\" ? handleRegister : handleLogin}\r\n            style={{ width: \"100%\" }}\r\n          >\r\n            <input\r\n              style={chatStyles.authInput}\r\n              placeholder=\"–ò–º—è\"\r\n              value={username}\r\n              onChange={e => setUsername(e.target.value)}\r\n              required\r\n              autoComplete=\"username\"\r\n            />\r\n            <input\r\n              style={chatStyles.authInput}\r\n              placeholder=\"–ü–∞—Ä–æ–ª—å\"\r\n              type=\"password\"\r\n              value={password}\r\n              onChange={e => setPassword(e.target.value)}\r\n              required\r\n              autoComplete=\"current-password\"\r\n            />\r\n            <button\r\n              style={chatStyles.authBtn}\r\n              type=\"submit\"\r\n              disabled={registering}\r\n            >\r\n              {authMode === \"register\" ? \"–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è\" : \"–í–æ–π—Ç–∏\"}\r\n            </button>\r\n          </form>\r\n          <button\r\n            style={chatStyles.switchBtn}\r\n            type=\"button\"\r\n            onClick={() => {\r\n              setAuthMode(authMode === \"register\" ? \"login\" : \"register\");\r\n              setError(\"\");\r\n            }}\r\n          >\r\n            {authMode === \"register\" ? \"–í–æ–π—Ç–∏\" : \"–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è\"}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div style={chatStyles.page}>\r\n      <div style={chatStyles.sidebar}>\r\n        <div style={chatStyles.sidebarTitle}>–ì–æ–í–ß–∞—Ç 2.1 Beta</div>\r\n        <div style={chatStyles.channelList}>\r\n          <div style={{ fontWeight: 600, color: \"#fff\", marginBottom: 10 }}>–ö–∞–Ω–∞–ª—ã</div>\r\n          {channels.length === 0 ? (\r\n            <div style={{ color: \"#b2bec3\", marginBottom: 8 }}>\r\n              –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤\r\n            </div>\r\n          ) : (\r\n            <>\r\n              {channels.map((ch) => (\r\n                <div\r\n                  key={ch._id}\r\n                  style={chatStyles.channelItem(selectedChannel === ch._id)}\r\n                  onClick={() => setSelectedChannel(ch._id)}\r\n                >\r\n                  {ch.name}\r\n                </div>\r\n              ))}\r\n            </>\r\n          )}\r\n          <button\r\n            style={chatStyles.createBtn}\r\n            onClick={() => setShowCreate((v) => !v)}\r\n          >\r\n            {showCreate ? \"–°–∫—Ä—ã—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ\" : \"–°–æ–∑–¥–∞—Ç—å –∫–∞–Ω–∞–ª\"}\r\n          </button>\r\n          {showCreate && (\r\n            <div style={{ marginTop: 10 }}>\r\n              <input\r\n                style={chatStyles.input}\r\n                placeholder=\"–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞\"\r\n                value={newChannel}\r\n                onChange={e => setNewChannel(e.target.value)}\r\n              />\r\n              <button style={chatStyles.createBtn} onClick={handleCreateChannel}>\r\n                –°–æ–∑–¥–∞—Ç—å\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n        <div style={{ flex: 1 }} />\r\n        <div style={chatStyles.profileBtnBox}>\r\n          <button\r\n            style={chatStyles.profileBtn}\r\n            onClick={() => {\r\n              setShowProfile(v => !v);\r\n              setEditMode(false);\r\n            }}\r\n            title=\"–ü—Ä–æ—Ñ–∏–ª—å\"\r\n          >\r\n            <svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" fill=\"none\">\r\n              <circle cx=\"13\" cy=\"13\" r=\"13\" fill=\"#00c3ff\" />\r\n              <circle cx=\"13\" cy=\"10\" r=\"4\" fill=\"#fff\" />\r\n              <ellipse cx=\"13\" cy=\"19\" rx=\"7\" ry=\"4\" fill=\"#fff\" />\r\n            </svg>\r\n          </button>\r\n          {showProfile && (\r\n            <div\r\n              style={{\r\n                position: \"fixed\",\r\n                left: 0,\r\n                top: 0,\r\n                width: \"100vw\",\r\n                height: \"100vh\",\r\n                background: \"rgba(0,0,0,0.12)\",\r\n                zIndex: 99,\r\n                transition: \"background 0.2s\",\r\n              }}\r\n              onClick={handleProfilePopupBgClick}\r\n            >\r\n              <div\r\n                style={{\r\n                  ...chatStyles.profilePopup,\r\n                  transform: showProfile ? \"translateY(0)\" : \"translateY(120%)\",\r\n                  opacity: showProfile ? 1 : 0,\r\n                  pointerEvents: showProfile ? \"auto\" : \"none\",\r\n                  transition: \"transform 0.32s cubic-bezier(.4,1.4,.6,1), opacity 0.22s\",\r\n                  display: \"flex\",\r\n                  flexDirection: \"column\",\r\n                  justifyContent: \"flex-start\",\r\n                }}\r\n                onClick={e => e.stopPropagation()}\r\n              >\r\n                {/* –ù–æ–≤—ã–π –∞–≤–∞—Ç–∞—Ä/–∑–Ω–∞—á–æ–∫ –ø—Ä–æ—Ñ–∏–ª—è */}\r\n                <div style={chatStyles.profileAvatar}>\r\n                  <div\r\n                    style={{\r\n                      position: \"relative\",\r\n                      width: 90,\r\n                      height: 90,\r\n                      borderRadius: \"50%\",\r\n                      overflow: \"hidden\",\r\n                      cursor: \"pointer\",\r\n                      border: \"2px solid #00c3ff\",\r\n                      margin: \"0 auto\",\r\n                      background: \"#35363a\",\r\n                      display: \"flex\",\r\n                      alignItems: \"center\",\r\n                      justifyContent: \"center\",\r\n                    }}\r\n                    onClick={() => fileInputRef.current && fileInputRef.current.click()}\r\n                    title=\"–ò–∑–º–µ–Ω–∏—Ç—å —Ñ–æ—Ç–æ\"\r\n                  >\r\n                    {/* –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–≤–∞—Ç–∞—Ä —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å –∏ –Ω–µ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π */}\r\n                    {userProfile?.avatarUrl &&\r\n                      userProfile.avatarUrl !== \"/uploads/avatar-default.png\" ? (\r\n                      <img\r\n                        key={userProfile.avatarUrl + avatarVersion}\r\n                        src={\r\n                          userProfile.avatarUrl.startsWith(\"http\")\r\n                            ? userProfile.avatarUrl + \"?t=\" + avatarVersion\r\n                            : `${window.location.protocol}//${window.location.hostname}:5000${userProfile.avatarUrl}?t=${avatarVersion}`\r\n                        }\r\n                        alt=\"avatar\"\r\n                        style={{\r\n                          width: 90,\r\n                          height: 90,\r\n                          borderRadius: \"50%\",\r\n                          objectFit: \"cover\",\r\n                          display: \"block\",\r\n                        }}\r\n                        onError={e => {\r\n                          e.target.onerror = null;\r\n                          e.target.src =\r\n                            `${window.location.protocol}//${window.location.hostname}:5000/uploads/avatar-default.png`;\r\n                        }}\r\n                      />\r\n                    ) : (\r\n                      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—É—é –∫–∞—Ä—Ç–∏–Ω–∫—É, –µ—Å–ª–∏ –Ω–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π\r\n                      <img\r\n                        src={`${window.location.protocol}//${window.location.hostname}:5000/uploads/avatar-default.png`}\r\n                        alt=\"avatar\"\r\n                        style={{\r\n                          width: 90,\r\n                          height: 90,\r\n                          borderRadius: \"50%\",\r\n                          objectFit: \"cover\",\r\n                          display: \"block\",\r\n                        }}\r\n                        onError={e => {\r\n                          e.target.onerror = null;\r\n                          e.target.src =\r\n                            \"https://ui-avatars.com/api/?name=\" +\r\n                            encodeURIComponent(userProfile?.username || \"U\") +\r\n                            \"&background=00c3ff&color=fff&size=90\";\r\n                        }}\r\n                      />\r\n                    )}\r\n                    <input\r\n                      ref={fileInputRef}\r\n                      type=\"file\"\r\n                      accept=\"image/*\"\r\n                      style={{ display: \"none\" }}\r\n                      onChange={async e => {\r\n                        if (!e.target.files?.[0]) return;\r\n                        const formData = new FormData();\r\n                        formData.append(\"file\", e.target.files[0]);\r\n                        // –ü–æ–ª—É—á–∞–µ–º –∞–±—Å–æ–ª—é—Ç–Ω—ã–π URL –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞\r\n                        const uploadRes = await axios.post(\r\n                          `${API_URL}/upload?avatar=1`,\r\n                          formData,\r\n                          {\r\n                            headers: { Authorization: `Bearer ${token}` },\r\n                          }\r\n                        );\r\n                        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º avatarUrl –≤ –ø—Ä–æ—Ñ–∏–ª–µ (–ø–∞—Ç—á–∏–º –ø—Ä–æ—Ñ–∏–ª—å)\r\n                        await axios.patch(\r\n                          `${API_URL}/profile`,\r\n                          { avatarUrl: uploadRes.data.url },\r\n                          { headers: { Authorization: `Bearer ${token}` } }\r\n                        );\r\n                        // –ü–æ–ª—É—á–∞–µ–º —Å–≤–µ–∂–∏–π –ø—Ä–æ—Ñ–∏–ª—å\r\n                        const profileRes = await axios.get(`${API_URL}/profile`, {\r\n                          headers: { Authorization: `Bearer ${token}` },\r\n                        });\r\n                        setUserProfile(profileRes.data);\r\n                        setAvatarVersion(Date.now());\r\n                      }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                {/* –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—Ä–æ—Ñ–∏–ª—è —Å –ø—Ä–æ–∫—Ä—É—Ç–∫–æ–π */}\r\n                <div style={{\r\n                  flex: 1,\r\n                  overflowY: \"auto\",\r\n                  minHeight: 0,\r\n                  marginBottom: 10,\r\n                  display: \"flex\",\r\n                  flexDirection: \"column\",\r\n                  justifyContent: \"flex-start\"\r\n                }}>\r\n                  {userProfile && !editMode && (\r\n                    <>\r\n                      <div style={chatStyles.profileTitle}>–ü—Ä–æ—Ñ–∏–ª—å</div>\r\n                      <div style={chatStyles.profileField}>\r\n                        <span style={chatStyles.profileLabel}>–ù–∏–∫:</span> {userProfile.username}\r\n                      </div>\r\n                      <div style={chatStyles.profileField}>\r\n                        <span style={chatStyles.profileLabel}>–í–æ–∑—Ä–∞—Å—Ç:</span> {userProfile.age ?? \"‚Äî\"}\r\n                      </div>\r\n                      <div style={chatStyles.profileField}>\r\n                        <span style={chatStyles.profileLabel}>–ì–æ—Ä–æ–¥:</span> {userProfile.city ?? \"‚Äî\"}\r\n                      </div>\r\n                      <div style={chatStyles.profileField}>\r\n                        <span style={chatStyles.profileLabel}>–°–µ–º–µ–π–Ω—ã–π —Å—Ç–∞—Ç—É—Å:</span> {userProfile.status ?? \"‚Äî\"}\r\n                      </div>\r\n                      {/* –ö–Ω–æ–ø–∫–∏ —Ç–µ–ø–µ—Ä—å –≤–Ω—É—Ç—Ä–∏ —Å–∫—Ä–æ–ª–ª–∏—Ä—É–µ–º–æ–π –æ–±–ª–∞—Å—Ç–∏, —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ */}\r\n                      <div style={{ display: \"flex\", gap: 8, marginTop: 18, justifyContent: \"flex-end\" }}>\r\n                        <button\r\n                          style={chatStyles.profileEditBtn}\r\n                          onClick={() => {\r\n                            setEditData({\r\n                              username: userProfile.username || \"\",\r\n                              password: \"\",\r\n                              city: userProfile.city || \"\",\r\n                              status: userProfile.status || \"\",\r\n                              age: userProfile.age || \"\",\r\n                            });\r\n                            setEditMode(true);\r\n                          }}\r\n                        >\r\n                          –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å\r\n                        </button>\r\n                        <button\r\n                          style={chatStyles.profileLogoutBtn}\r\n                          onClick={() => {\r\n                            localStorage.removeItem(\"token\");\r\n                            window.location.reload();\r\n                          }}\r\n                        >\r\n                          –í—ã–π—Ç–∏\r\n                        </button>\r\n                      </div>\r\n                    </>\r\n                  )}\r\n                  {userProfile && editMode && (\r\n                    <>\r\n                      <div style={chatStyles.profileTitle}>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è</div>\r\n                      <div style={chatStyles.profileField}>\r\n                        <span style={chatStyles.profileLabel}>–ù–∏–∫:</span>\r\n                        <input\r\n                          style={chatStyles.profileInput}\r\n                          value={editData.username}\r\n                          onChange={e => setEditData(d => ({ ...d, username: e.target.value }))}\r\n                        />\r\n                      </div>\r\n                      <div style={chatStyles.profileField}>\r\n                        <span style={chatStyles.profileLabel}>–ü–∞—Ä–æ–ª—å:</span>\r\n                        <input\r\n                          style={chatStyles.profileInput}\r\n                          type=\"password\"\r\n                          value={editData.password}\r\n                          placeholder=\"–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å\"\r\n                          onChange={e => setEditData(d => ({ ...d, password: e.target.value }))}\r\n                        />\r\n                      </div>\r\n                      <div style={chatStyles.profileField}>\r\n                        <span style={chatStyles.profileLabel}>–í–æ–∑—Ä–∞—Å—Ç:</span>\r\n                        <input\r\n                          style={chatStyles.profileInput}\r\n                          type=\"number\"\r\n                          min={0}\r\n                          value={editData.age}\r\n                          onChange={e => setEditData(d => ({ ...d, age: e.target.value }))}\r\n                        />\r\n                      </div>\r\n                      <div style={chatStyles.profileField}>\r\n                        <span style={chatStyles.profileLabel}>–ì–æ—Ä–æ–¥:</span>\r\n                        <input\r\n                          style={chatStyles.profileInput}\r\n                          value={editData.city}\r\n                          onChange={e => setEditData(d => ({ ...d, city: e.target.value }))}\r\n                        />\r\n                      </div>\r\n                      <div style={chatStyles.profileField}>\r\n                        <span style={chatStyles.profileLabel}>–°–µ–º–µ–π–Ω—ã–π —Å—Ç–∞—Ç—É—Å:</span>\r\n                        <input\r\n                          style={chatStyles.profileInput}\r\n                          value={editData.status}\r\n                          onChange={e => setEditData(d => ({ ...d, status: e.target.value }))}\r\n                        />\r\n                      </div>\r\n                      {/* –ö–Ω–æ–ø–∫–∏ —Ç–µ–ø–µ—Ä—å –≤–Ω—É—Ç—Ä–∏ —Å–∫—Ä–æ–ª–ª–∏—Ä—É–µ–º–æ–π –æ–±–ª–∞—Å—Ç–∏, —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–æ–ª–µ–π */}\r\n                      <div style={{ display: \"flex\", gap: 8, marginTop: 10, justifyContent: \"flex-end\", flexWrap: \"wrap\" }}>\r\n                        <button\r\n                          style={chatStyles.profileEditBtn}\r\n                          onClick={handleProfileSave}\r\n                        >\r\n                          –°–æ—Ö—Ä–∞–Ω–∏—Ç—å\r\n                        </button>\r\n                        <button\r\n                          style={{\r\n                            ...chatStyles.profileCloseBtn,\r\n                            position: \"static\",\r\n                            width: \"auto\",\r\n                            height: \"auto\",\r\n                            fontSize: 15,\r\n                            marginLeft: 0,\r\n                            marginTop: 0,\r\n                            marginBottom: 0,\r\n                            background: \"#35363a\",\r\n                            color: \"#b2bec3\",\r\n                            boxShadow: \"0 2px 8px #0002\",\r\n                          }}\r\n                          onClick={() => setEditMode(false)}\r\n                        >\r\n                          –û—Ç–º–µ–Ω–∞\r\n                        </button>\r\n                      </div>\r\n                    </>\r\n                  )}\r\n                  {!userProfile && (\r\n                    <div style={{ color: \"#b2bec3\", marginBottom: 8 }}>–ó–∞–≥—Ä—É–∑–∫–∞...</div>\r\n                  )}\r\n                </div>\r\n                {/* –ö–Ω–æ–ø–∫–∏ —É–±—Ä–∞–Ω—ã –∏–∑ –Ω–∏–∂–Ω–µ–π —á–∞—Å—Ç–∏ popup */}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n      <div style={chatStyles.chatContainer}>\r\n        <div style={{\r\n          display: \"flex\",\r\n          alignItems: \"center\",\r\n          justifyContent: \"center\",\r\n          width: \"100%\",\r\n          marginBottom: 10,\r\n          minHeight: 32\r\n        }}>\r\n          <div style={chatStyles.chatTitle}>–ß–∞—Ç</div>\r\n        </div>\r\n        <div\r\n          className=\"chat-box\"\r\n          style={chatStyles.chatBox}\r\n        >\r\n          {messages.map((msg) => {\r\n            const isMine = msg.sender === username;\r\n            const time = msg.createdAt ? new Date(msg.createdAt).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) : '';\r\n            return (\r\n              <div key={msg._id} style={chatStyles.messageRow(isMine)}>\r\n                <div style={chatStyles.message(isMine)}>\r\n                  {/* –¢–æ–ª—å–∫–æ –¥–ª—è —á—É–∂–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–º—è */}\r\n                  {!isMine && (\r\n                    <span style={chatStyles.messageSender}>\r\n                      {msg.sender}:\r\n                    </span>\r\n                  )}\r\n                  {msg.text}\r\n                  {/* –ü—Ä–µ–≤—å—é –¥–ª—è –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ */}\r\n                  {msg.fileUrl && (\r\n                    <div style={chatStyles.messageFileBox}>\r\n                      <div\r\n                        style={{\r\n                          position: \"relative\",\r\n                          display: \"inline-block\",\r\n                          cursor: \"pointer\",\r\n                          maxWidth: 180,\r\n                        }}\r\n                        onClick={() =>\r\n                          setFileModal({\r\n                            open: true,\r\n                            url: msg.fileUrl,\r\n                            name: msg.fileName || \"file\",\r\n                            type: msg.fileType || \"\",\r\n                          })\r\n                        }\r\n                        title=\"–û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª\"\r\n                      >\r\n                        {msg.fileType?.startsWith(\"image/\") ? (\r\n                          <img\r\n                            src={msg.fileUrl}\r\n                            alt={msg.fileName || \"—Ñ–∞–π–ª\"}\r\n                            style={chatStyles.messageFileImg}\r\n                          />\r\n                        ) : msg.fileType?.startsWith(\"video/\") ? (\r\n                          <video\r\n                            src={msg.fileUrl}\r\n                            style={chatStyles.messageFileImg}\r\n                            muted\r\n                            preload=\"metadata\"\r\n                          />\r\n                        ) : (\r\n                          <div style={chatStyles.filePreviewDoc}>\r\n                            <span role=\"img\" aria-label=\"file\" style={{ fontSize: 38 }}>üìÑ</span>\r\n                          </div>\r\n                        )}\r\n                        <a\r\n                          href={msg.fileUrl}\r\n                          download={msg.fileName || \"file\"}\r\n                          style={{\r\n                            ...chatStyles.downloadBtn,\r\n                            position: \"absolute\",\r\n                            right: 4,\r\n                            bottom: 4,\r\n                            background: \"rgba(0,0,0,0.45)\",\r\n                            borderRadius: \"50%\",\r\n                            padding: 4,\r\n                            zIndex: 2,\r\n                          }}\r\n                          title=\"–°–∫–∞—á–∞—Ç—å\"\r\n                          onClick={e => e.stopPropagation()}\r\n                        >\r\n                          <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\r\n                            <path d=\"M10 3v10m0 0l-4-4m4 4l4-4M4 17h12\" stroke=\"#00c3ff\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\r\n                        </svg>\r\n                        </a>\r\n                      </div>\r\n                      {/* –ò–º—è —Ñ–∞–π–ª–∞ –ø–æ–¥ –ø—Ä–µ–≤—å—é */}\r\n                      <div style={{ color: \"#b2bec3\", fontSize: 13, marginTop: 2, wordBreak: \"break-all\" }}>\r\n                        {msg.fileName}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                  {/* –í—Ä–µ–º—è —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–¥ —Ç–µ–∫—Å—Ç–æ–º, –º–µ–Ω—å—à–∏–º —à—Ä–∏—Ñ—Ç–æ–º */}\r\n                  <div style={{ color: \"#b2bec3\", fontSize: 11, marginTop: 4, textAlign: isMine ? \"right\" : \"left\" }}>\r\n                    {time}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n          <div ref={messagesEndRef} />\r\n        </div>\r\n        {/* typing –≤—ã–Ω–µ—Å–µ–Ω –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π flex-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞–¥ inputRow */}\r\n        <div style={{ minHeight: 22, display: \"flex\", alignItems: \"flex-end\", marginBottom: 2 }}>\r\n          {typing && (\r\n            <div style={{\r\n              ...chatStyles.typing,\r\n              margin: 0,\r\n              paddingLeft: 8,\r\n              paddingRight: 8,\r\n              background: \"none\",\r\n              borderRadius: 0,\r\n              position: \"relative\",\r\n              zIndex: 2,\r\n              width: \"fit-content\",\r\n              maxWidth: \"80%\",\r\n              alignSelf: \"flex-start\",\r\n              boxShadow: \"none\"\r\n            }}>\r\n              {typing}\r\n            </div>\r\n          )}\r\n        </div>\r\n        <div style={chatStyles.inputRow}>\r\n          {/* –ö–Ω–æ–ø–∫–∞ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞ */}\r\n          <button\r\n            style={{\r\n              ...chatStyles.sendBtn,\r\n              padding: \"10px 12px\",\r\n              minWidth: 0,\r\n              width: 44,\r\n              display: \"flex\",\r\n              alignItems: \"center\",\r\n              justifyContent: \"center\",\r\n              marginRight: 2,\r\n            }}\r\n            type=\"button\"\r\n            onClick={() => fileSendInputRef.current && fileSendInputRef.current.click()}\r\n            title=\"–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª\"\r\n            disabled={!selectedChannel}\r\n          >\r\n            <svg width=\"22\" height=\"22\" viewBox=\"0 0 24 24\" fill=\"none\">\r\n              <path d=\"M17.657 6.343a8 8 0 1 0-11.314 11.314 8 8 0 0 0 11.314-11.314zm-9.9 9.9a6 6 0 1 1 8.486-8.486 6 6 0 0 1-8.486 8.486z\" fill=\"#fff\"/>\r\n              <path d=\"M12 8v5a1 1 0 0 0 2 0V8a3 3 0 1 0-6 0v8a5 5 0 0 0 10 0v-3a1 1 0 1 0-2 0v3a3 3 0 0 1-6 0V8a1 1 0 1 1 2 0z\" fill=\"#fff\"/>\r\n            </svg>\r\n            <input\r\n              ref={fileSendInputRef}\r\n              type=\"file\"\r\n              style={{ display: \"none\" }}\r\n              onChange={e => {\r\n                const file = e.target.files?.[0];\r\n                if (!file) return;\r\n                setFileToSend(file);\r\n                // –î–ª—è –ø—Ä–µ–≤—å—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π/–≤–∏–¥–µ–æ\r\n                if (file.type.startsWith(\"image/\") || file.type.startsWith(\"video/\")) {\r\n                  setFilePreview(URL.createObjectURL(file));\r\n                } else {\r\n                  setFilePreview(null);\r\n                }\r\n              }}\r\n            />\r\n          </button>\r\n          <input\r\n            style={chatStyles.input}\r\n            value={input}\r\n            onChange={e => setInput(e.target.value)}\r\n            onKeyDown={e => {\r\n              if (selectedChannel) {\r\n                socketRef.current.emit(\"typing\", { channel: selectedChannel });\r\n                if (e.key === \"Enter\") handleSend();\r\n              }\r\n            }}\r\n            disabled={!selectedChannel}\r\n            placeholder={\r\n              selectedChannel\r\n                ? \"–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...\"\r\n                : \"–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞–Ω–∞–ª\"\r\n            }\r\n          />\r\n          <button\r\n            style={chatStyles.sendBtn}\r\n            onClick={handleSend}\r\n            disabled={!selectedChannel || (!input.trim() && !fileToSend)}\r\n          >\r\n            –û—Ç–ø—Ä–∞–≤–∏—Ç—å\r\n          </button>\r\n        </div>\r\n        {/* –ü—Ä–µ–≤—å—é –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ */}\r\n        {fileToSend && (\r\n          <div style={chatStyles.filePreviewBox}>\r\n            {filePreview && fileToSend.type.startsWith(\"image/\") && (\r\n              <img src={filePreview} alt=\"preview\" style={chatStyles.filePreviewImg} />\r\n            )}\r\n            {filePreview && fileToSend.type.startsWith(\"video/\") && (\r\n              <video src={filePreview} controls style={chatStyles.filePreviewVideo} />\r\n            )}\r\n            {!filePreview && (\r\n              <div style={chatStyles.filePreviewDoc}>\r\n                üìé {fileToSend.name}\r\n              </div>\r\n            )}\r\n            <button\r\n              style={chatStyles.filePreviewRemoveBtn}\r\n              onClick={() => {\r\n                setFileToSend(null);\r\n                setFilePreview(null);\r\n              }}\r\n              title=\"–£–±—Ä–∞—Ç—å —Ñ–∞–π–ª\"\r\n            >\r\n              √ó\r\n            </button>\r\n          </div>\r\n        )}\r\n      </div>\r\n      {/* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è */}\r\n      {imageModal.open && (\r\n        <div style={chatStyles.modalOverlay} onClick={() => setImageModal({ open: false, url: \"\", name: \"\" })}>\r\n          <div style={chatStyles.modalContent} onClick={e => e.stopPropagation()}>\r\n            <img src={imageModal.url} alt={imageModal.name} style={chatStyles.modalImg} />\r\n            <div style={chatStyles.modalActions}>\r\n              <a\r\n                href={imageModal.url}\r\n                download={imageModal.name}\r\n                style={chatStyles.downloadBtn}\r\n                title=\"–°–∫–∞—á–∞—Ç—å\"\r\n              >\r\n                <svg width=\"28\" height=\"28\" viewBox=\"0 0 20 20\" fill=\"none\">\r\n                  <path d=\"M10 3v10m0 0l-4-4m4 4l4-4M4 17h12\" stroke=\"#00c3ff\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\r\n                </svg>\r\n                <span style={{marginLeft: 6}}>–°–∫–∞—á–∞—Ç—å</span>\r\n              </a>\r\n              <button\r\n                style={chatStyles.modalCloseBtn}\r\n                onClick={() => setImageModal({ open: false, url: \"\", name: \"\" })}\r\n                title=\"–ó–∞–∫—Ä—ã—Ç—å\"\r\n              >\r\n                √ó\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {/* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª—é–±–æ–≥–æ —Ñ–∞–π–ª–∞ */}\r\n      {fileModal.open && (\r\n        <div style={chatStyles.modalOverlay} onClick={() => setFileModal({ open: false, url: \"\", name: \"\", type: \"\" })}>\r\n          <div style={chatStyles.modalContent} onClick={e => e.stopPropagation()}>\r\n            {fileModal.type.startsWith(\"image/\") ? (\r\n              <img src={fileModal.url} alt={fileModal.name} style={chatStyles.modalImg} />\r\n            ) : fileModal.type.startsWith(\"video/\") ? (\r\n              <video src={fileModal.url} controls autoPlay style={chatStyles.modalImg} />\r\n            ) : (\r\n              <div style={{ textAlign: \"center\", width: 320, padding: 24 }}>\r\n                <div style={{ fontSize: 80, marginBottom: 16 }}>üìÑ</div>\r\n                <div style={{ color: \"#fff\", fontSize: 18, marginBottom: 16, wordBreak: \"break-all\" }}>{fileModal.name}</div>\r\n              </div>\r\n            )}\r\n            <div style={chatStyles.modalActions}>\r\n              <a\r\n                href={fileModal.url}\r\n                download={fileModal.name}\r\n                style={chatStyles.downloadBtn}\r\n                title=\"–°–∫–∞—á–∞—Ç—å\"\r\n              >\r\n                <svg width=\"28\" height=\"28\" viewBox=\"0 0 20 20\" fill=\"none\">\r\n                  <path d=\"M10 3v10m0 0l-4-4m4 4l4-4M4 17h12\" stroke=\"#00c3ff\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\r\n                </svg>\r\n                <span style={{marginLeft: 6}}>–°–∫–∞—á–∞—Ç—å</span>\r\n              </a>\r\n              <button\r\n                style={chatStyles.modalCloseBtn}\r\n                onClick={() => setFileModal({ open: false, url: \"\", name: \"\", type: \"\" })}\r\n                title=\"–ó–∞–∫—Ä—ã—Ç—å\"\r\n              >\r\n                √ó\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}